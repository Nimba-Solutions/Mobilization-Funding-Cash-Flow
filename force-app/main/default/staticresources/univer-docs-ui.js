(function(T,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("@univerjs/core"),require("@univerjs/docs"),require("@univerjs/engine-render"),require("@univerjs/ui"),require("react"),require("react/jsx-runtime"),require("@univerjs/design"),require("rxjs"),require("rxjs/operators"),require("@univerjs/drawing")):typeof define=="function"&&define.amd?define(["exports","@univerjs/core","@univerjs/docs","@univerjs/engine-render","@univerjs/ui","react","react/jsx-runtime","@univerjs/design","rxjs","rxjs/operators","@univerjs/drawing"],s):(T=typeof globalThis<"u"?globalThis:T||self,s(T.UniverDocsUi={},T.UniverCore,T.UniverDocs,T.UniverEngineRender,T.UniverUi,T.React,T.React,T.UniverDesign,T.rxjs,T.rxjs.operators,T.UniverDrawing))})(this,function(T,s,D,_,v,U,P,J,L,At,Dn){"use strict";var UA=Object.defineProperty;var wA=(T,s,D)=>s in T?UA(T,s,{enumerable:!0,configurable:!0,writable:!0,value:D}):T[s]=D;var B=(T,s,D)=>wA(T,typeof s!="symbol"?s+"":s,D);var va=Object.getOwnPropertyDescriptor,Ia=(i,t,e,n)=>{for(var o=n>1?void 0:n?va(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},oo=(i,t)=>(e,n)=>t(e,n,i);T.DocAutoFormatService=class extends s.Disposable{constructor(e,n){super();B(this,"_matches",new Map);this._univerInstanceService=e,this._textSelectionManagerService=n}registerAutoFormat(e){const n=this._matches.get(e.id);return n?(n.push(e),n.sort((o,a)=>{var r,c;return((r=a.priority)!=null?r:0)-((c=o.priority)!=null?c:0)})):this._matches.set(e.id,[e]),s.toDisposable(()=>{const o=this._matches.get(e.id);if(o){const a=o.findIndex(r=>r===e);a>=0&&o.splice(a,1)}})}onAutoFormat(e,n){var l,A,d,u,m,g,h,p,f;const o=(l=this._matches.get(e))!=null?l:[],a=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=this._textSelectionManagerService.getDocRanges(),c=(A=r.find(S=>S.isActive))!=null?A:r[0];if(a&&c){const S=a.getSelfOrHeaderFooterModel(c.segmentId),E={unit:S,selection:c,isBody:!c.segmentId,paragraphs:s.BuildTextUtils.range.getParagraphsInRange(c,(u=(d=S.getBody())==null?void 0:d.paragraphs)!=null?u:[],(g=(m=S.getBody())==null?void 0:m.dataStream)!=null?g:""),customRanges:s.BuildTextUtils.customRange.getCustomRangesInterestsWithSelection(c,(p=(h=S.getBody())==null?void 0:h.customRanges)!=null?p:[]),commandId:e,commandParams:n},C=o.find(b=>b.match(E));return(f=C==null?void 0:C.getMutations(E))!=null?f:[]}return[]}},T.DocAutoFormatService=Ia([oo(0,s.IUniverInstanceService),oo(1,s.Inject(D.DocSelectionManagerService))],T.DocAutoFormatService);const so={undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},ao={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},ro="DOC_UI_PLUGIN";var Ae=(i=>(i.MAIN="__Document_Render_Main__",i.BACKGROUND="__Document_Render_Background__",i))(Ae||{}),ae=(i=>(i.VIEW_MAIN="viewMain",i.VIEW_TOP="viewTop",i.VIEW_LEFT="viewLeft",i.VIEW_LEFT_TOP="viewLeftTop",i))(ae||{});const co=0,Lt=2,lo=4,Bn=10,Ea="normalTextSelectionPluginName";function ve(i){const{mainComponent:t,scene:e,engine:n,components:o}=i,a=t,r=o.get(Ae.BACKGROUND);return{document:a,docBackground:r,scene:e,engine:n}}function Ao(i,t){const e=i.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(!e)return null;const n=e.getUnitId(),o=t.getRenderById(n);if(o==null)return;const{mainComponent:a,scene:r,engine:c,components:l}=o,A=a,d=l.get(Ae.BACKGROUND);return{document:A,docBackground:d,scene:r,engine:c}}function Ca(i,t){const e=t.getRenderById(i);if(e==null)return;const{mainComponent:n,scene:o,engine:a,components:r}=e,c=n,l=r.get(Ae.BACKGROUND);return{document:c,docBackground:l,scene:o,engine:a}}function uo(i){const{unitId:t,ranges:e,id:n,type:o,segmentId:a}=i,r={id:D.RichTextEditingMutation.id,params:{unitId:t,actions:[],textRanges:void 0,segmentId:a}},c=s.JSONX.getInstance(),l=s.BuildTextUtils.customDecoration.add({ranges:e,id:n,type:o});return r.params.actions=c.editOp(l.serialize()),r}function Ta(i,t){const{segmentId:e,id:n,type:o,unitId:a}=t,r=i.get(D.DocSelectionManagerService),c=i.get(s.IUniverInstanceService),l=a?c.getUnit(a,s.UniverInstanceType.UNIVER_DOC):c.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(!l)return!1;const A=l.getUnitId(),d=r.getTextRanges({unitId:A,subUnitId:A});return!d||!l.getBody()?!1:uo({unitId:A,ranges:d,id:n,type:o,segmentId:e})}function ya(i,t){const{unitId:e,id:n,segmentId:o}=t,r=i.get(s.IUniverInstanceService).getUnit(e);if(!r)return!1;const c={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:void 0,segmentId:o}},l=s.BuildTextUtils.customDecoration.delete({id:n,segmentId:o,documentDataModel:r});if(!l)return!1;const A=s.JSONX.getInstance();return c.params.actions=A.editOp(l.serialize()),c}function ba(i,t){return t.some(e=>i.startIndex>e.startIndex&&i.startIndex<e.endIndex)}function Qt(i,t,e,n,o){const{textRuns:a=[],dataStream:r}=i,c=o&&r.startsWith("="),l={st:0,ed:0,ts:{}};if(c)return l;for(let A=a.length-1;A>=0;A--){const d=a[A],{st:u,ed:m}=d;t>u&&t<=m&&(l.st=u,l.ed=m,l.ts={...l.ts,...d.ts})}if(t===0){const A=a==null?void 0:a[0];A&&A.st===0&&(l.ts={...l.ts,...A.ts})}return n&&(l.ts={...l.ts,...n}),l}function _n(i,t,e){if(e){const o=i.find(a=>t>=a.startIndex&&t<=a.endIndex+1);return o!=null&&o.wholeEntity?null:o}const n=i.find(o=>t>o.startIndex&&t<=o.endIndex);return n!=null&&n.wholeEntity?null:n}function Nn(i,t){return i.filter(e=>t>e.startIndex&&t<=e.endIndex)}function Oa(i){return{left:i.positionH.posOffset,top:i.positionV.posOffset,width:i.size.width,height:i.size.height}}function Ra(i,t=0,e=0){return{size:{width:i.width,height:i.height},positionH:{relativeFrom:s.ObjectRelativeFromH.MARGIN,posOffset:(i.left||0)-t},positionV:{relativeFrom:s.ObjectRelativeFromV.PAGE,posOffset:(i.top||0)-e},angle:i.angle||0}}function go(i,t,e){const n=v.useDependency(s.ICommandService),o=v.useDependency(v.IShortcutService),a=U.useMemo(()=>s.generateRandomId(4),[]);U.useEffect(()=>{if(!e||!i||!t)return;const c=`sheet.operation.editor-${e.getEditorId()}-keyboard-${a}`,l=new s.DisposableCollection;return l.add(n.registerCommand({id:c,type:s.CommandType.OPERATION,handler(A,d){const{keyCode:u,metaKey:m}=d;t.handler(u,m)}})),t.keyCodes.map(A=>({id:c,binding:A.metaKey?A.keyCode|A.metaKey:A.keyCode,preconditions:()=>!0,priority:901,staticParameters:{eventType:_.DeviceInputEventType.Keyboard,keyCode:A.keyCode,metaKey:A.metaKey}})).forEach(A=>{l.add(o.registerShortcut(A))}),()=>{l.dispose()}},[n,t,e,i,a,o])}const ho=(i,t=!0,e,n)=>{const o=U.useCallback(()=>{if(i){const{scene:r,mainComponent:c}=i.render,l=i.render.with(D.DocSkeletonManagerService),{width:A,height:d}=i.getBoundingClientRect();l.getViewModel().getDataModel().updateDocumentDataPageSize(t?1/0:A,1/0),r.transformByState({width:A,height:d}),c==null||c.resize(A,d)}},[i,t]),a=U.useMemo(()=>s.debounce(()=>{var E,C;if(!e||!i||!e)return;const c=i.render.with(D.DocSkeletonManagerService).getSkeleton(),{scene:l,mainComponent:A}=i.render,d=l.getViewport(ae.VIEW_MAIN),{actualWidth:u,actualHeight:m}=c.getActualSize(),{width:g,height:h}=i.getBoundingClientRect();let p=d==null?void 0:d.getScrollBar();const f=Math.max(u,g),S=Math.max(m,h);l.transformByState({width:f,height:S}),A==null||A.resize(f,S),t?u>g?(p==null?d&&new _.ScrollBar(d,{barSize:8,enableVertical:!1,enableHorizontal:!0,minThumbSizeV:8}):d==null||d.resetCanvasSizeAndUpdateScroll(),n&&(d==null||d.scrollToBarPos({x:1/0,y:0}))):(p=null,d==null||d.scrollToBarPos({x:0,y:0}),(C=d==null?void 0:d.getScrollBar())==null||C.dispose()):m>h?(p==null?d&&(p=new _.ScrollBar(d,{enableHorizontal:!1,enableVertical:!0,barSize:8,minThumbSizeV:8})):d==null||d.resetCanvasSizeAndUpdateScroll(),n&&(d==null||d.scrollToBarPos({x:0,y:1/0}))):(p=null,d==null||d.scrollToBarPos({x:0,y:0}),(E=d==null?void 0:d.getScrollBar())==null||E.dispose())},30),[i,e,t,n]);return U.useEffect(()=>{if(e&&i){const r=setTimeout(()=>{o(),a()},500);return()=>{clearTimeout(r)}}},[i,e,o,a]),U.useEffect(()=>{if(e&&i){const r=i.input$.subscribe(()=>{a()});return()=>{r.unsubscribe()}}},[i,e,a]),{resize:o,checkScrollBar:a}};function re(i,t){var n;return(n=i.get(_.IRenderManagerService).getRenderById(t))==null?void 0:n.with(D.DocSkeletonManagerService)}function Z(i,t=""){if(!t)return["body"];const{headers:e,footers:n}=i.getSnapshot();if(e==null&&n==null)throw new Error("Document data model must have headers or footers when update by segment id");if((e==null?void 0:e[t])!=null)return["headers",t,"body"];if((n==null?void 0:n[t])!=null)return["footers",t,"body"];throw new Error("Segment id not found in headers or footers")}const Pn={id:"doc.command-replace-snapshot",type:s.CommandType.COMMAND,handler:(i,t)=>{const{unitId:e,snapshot:n,textRanges:o,segmentId:a="",options:r}=t,c=i.get(s.IUniverInstanceService),l=i.get(s.ICommandService),A=i.get(D.DocSelectionManagerService),d=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot();if(d==null||u==null)return!1;const{body:m,tableSource:g,footers:h,headers:p,lists:f,drawings:S,drawingsOrder:E,documentStyle:C}=s.Tools.deepClone(n),{body:b,tableSource:R,footers:I,headers:O,lists:M,drawings:y,drawingsOrder:N,documentStyle:x}=u;if(m==null||b==null)return!1;if(s.Tools.diffValue(m,b)&&o)return A.replaceDocRanges(o,{unitId:e,subUnitId:e},!1),!0;const w={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:o}};r&&(w.params.options=r);const H=[],V=s.JSONX.getInstance();if(!s.Tools.diffValue(x,C)){const Q=V.replaceOp(["documentStyle"],x,C);Q!=null&&H.push(Q)}if(!s.Tools.diffValue(m,b)){const Q=V.replaceOp(["body"],b,m);Q!=null&&H.push(Q)}if(!s.Tools.diffValue(g,R)){const Q=V.replaceOp(["tableSource"],R,g);Q!=null&&H.push(Q)}if(!s.Tools.diffValue(h,I)){const Q=V.replaceOp(["footers"],I,h);Q!=null&&H.push(Q)}if(!s.Tools.diffValue(p,O)){const Q=V.replaceOp(["headers"],O,p);Q!=null&&H.push(Q)}if(!s.Tools.diffValue(f,M)){const Q=V.replaceOp(["lists"],M,f);Q!=null&&H.push(Q)}if(!s.Tools.diffValue(S,y)){const Q=V.replaceOp(["drawings"],y,S);Q!=null&&H.push(Q)}if(!s.Tools.diffValue(E,N)){const Q=V.replaceOp(["drawingsOrder"],N,E);Q!=null&&H.push(Q)}return w.params.actions=H.reduce((Q,j)=>s.JSONX.compose(Q,j),null),!!l.syncExecuteCommand(w.id,w.params)}},mo={id:"doc.command-replace-content",type:s.CommandType.COMMAND,handler:async(i,t)=>{const{unitId:e,body:n,textRanges:o,segmentId:a="",options:r}=t,c=i.get(s.IUniverInstanceService),l=i.get(s.ICommandService),A=i.get(D.DocSelectionManagerService),d=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(d==null||u==null)return!1;const m=fo(e,a,d,u,n);return m.params.textRanges=o,r&&(m.params.options=r),m.params.actions==null&&o?(A.replaceDocRanges(o,{unitId:e,subUnitId:e},!1),!0):!!l.syncExecuteCommand(m.id,m.params)}},po={id:"doc.command-cover-content",type:s.CommandType.COMMAND,handler:async(i,t)=>{const{unitId:e,body:n,segmentId:o=""}=t,a=i.get(s.IUniverInstanceService),r=i.get(s.ICommandService),c=i.get(s.IUndoRedoService),l=a.getUniverDocInstance(e),A=l==null?void 0:l.getSnapshot().body;if(l==null||A==null)return!1;const d=fo(e,o,l,A,n);return d.params.noNeedSetTextRange=!0,d.params.noHistory=!0,r.syncExecuteCommand(d.id,d.params),c.clearUndoRedo(e),!0}};function Ma(i,t,e,n){const o=new s.TextX,a=s.JSONX.getInstance(),r=(e==null?void 0:e.dataStream.length)-2;r>0&&o.push({t:s.TextXActionType.DELETE,len:r}),n.dataStream.length>0&&o.push({t:s.TextXActionType.INSERT,body:n,len:n.dataStream.length});const c=Z(t,i);return a.editOp(o.serialize(),c)}function fo(i,t,e,n,o){const a={id:D.RichTextEditingMutation.id,params:{unitId:i,actions:[],textRanges:[]}},r=Ma(t,e,n,o);return a.params.actions=r,a}const Un={id:"doc.command.replace-selection",type:s.CommandType.COMMAND,handler(i,t){var h;if(!t)return!1;const e=i.get(s.ICommandService),{unitId:n,body:o,textRanges:a}=t,c=i.get(s.IUniverInstanceService).getUnit(n),l=i.get(D.DocSelectionManagerService);if(!c)return!1;const A=c.getBody(),d=(h=t.selection)!=null?h:l.getActiveTextRange();if(!d||!A)return!1;const u={id:D.RichTextEditingMutation.id,params:{unitId:n,actions:[],textRanges:a,debounce:!0}},m=new s.TextX,g=s.JSONX.getInstance();return m.push(...s.BuildTextUtils.selection.delete([d],A,0,o)),u.params.actions=g.editOp(m.serialize()),e.syncExecuteCommand(u.id,u.params)}},So={id:"doc.command.replace-text-runs",type:s.CommandType.COMMAND,handler:(i,t)=>{const{unitId:e,body:n,textRanges:o,segmentId:a="",options:r}=t,c=i.get(s.IUniverInstanceService),l=i.get(s.ICommandService),A=c.getUnit(e,s.UniverInstanceType.UNIVER_DOC),d=A==null?void 0:A.getSelfOrHeaderFooterModel(a).getSnapshot().body;if(A==null||d==null)return!1;const u=s.BuildTextUtils.selection.replaceTextRuns({doc:A,body:n,selection:{startOffset:0,endOffset:d.dataStream.length-2,collapsed:!1}});if(!u)return!1;const m={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:o,noHistory:!0}},g=s.JSONX.getInstance(),h=Z(A,a);return m.params.actions=g.editOp(u.serialize(),h),m.params.textRanges=o,r&&(m.params.options=r),!!l.syncExecuteCommand(m.id,m.params)}};var Ft=(i=>(i[i.page=0]="page",i[i.section=1]="section",i[i.column=2]="column",i[i.line=3]="line",i[i.divide=4]="divide",i[i.glyph=5]="glyph",i))(Ft||{});const Ye={page:0,section:1,column:2,line:3,divide:4,glyph:5};function wn(i,t){return i.page>t.page?!1:i.page<t.page?!0:i.section>t.section?!1:i.section<t.section?!0:i.column>t.column?!1:i.column<t.column?!0:i.line>t.line?!1:i.line<t.line?!0:i.divide>t.divide?!1:i.divide<t.divide?!0:i.glyph>t.glyph?!1:(i.glyph<t.glyph,!0)}function Ln(i,t){return wn(i,t)?{start:i,end:t}:{start:t,end:i}}function Qn(i){const t=i.length;if(t===0)return;const e=i[0],n=i[t-1],o=i.length===1&&e.collapsed;return{startOffset:e.startOffset,endOffset:n.endOffset,collapsed:o}}function xa(i,t,e,n){let o=n,a=n;for(let r=0;r<i.length;r++){const l=i[r].count;r<t&&(o+=l),r<e&&(a+=l)}return{startOffset:o,endOffset:a}}function Fn(i){const{startX:t,startY:e,endX:n,endY:o}=i,a=[];return a.push({x:t,y:e}),a.push({x:n,y:e}),a.push({x:n,y:o}),a.push({x:t,y:o}),a.push({x:t,y:e}),a}class Ie{constructor(t,e){B(this,"_liquid",new _.Liquid);B(this,"_currentStartState",{page:0,section:0,column:0,line:0,divide:0,glyph:0});B(this,"_currentEndState",{page:0,section:0,column:0,line:0,divide:0,glyph:0});this._documentOffsetConfig=t,this._docSkeleton=e}getRangePointData(t,e){const n=[],o=[],a=[];if(t==null||e==null)return{borderBoxPointGroup:n,contentBoxPointGroup:o,cursorList:a};if(!this._isValidPosition(t,e))throw new Error(`
                Invalid positions in NodePositionConvertToCursor,
                they are not in the same segment page when in header or footer.`);const{start:c,end:l}=Ln(t,e);return this._selectionIterator(c,l,(A,d,u,m,g,h)=>{const{lineHeight:p,asc:f,paddingTop:S,marginTop:E,marginBottom:C}=h,{glyphGroup:b,st:R}=g;if(b.length===0)return;const{x:I,y:O}=this._liquid;let M,y;const N=b[A],x=b[d],w=b[A-1],H=(N==null?void 0:N.left)||0,V=(N==null?void 0:N.width)||0,F=(x==null?void 0:x.left)||0,Q=(x==null?void 0:x.width)||0,j=(N==null?void 0:N.glyphType)===_.GlyphType.LIST,{startOffset:G,endOffset:k}=xa(b,A,d,R),W=c.glyph===A&&u?c.isBack:!0,z=l.glyph===d&&m?l.isBack:!1,X=c===l,Y=W&&w!=null?w:N;if(A===0&&d===b.length-1)M={startX:I+H+(j?V:0),startY:O,endX:I+F+(z?0:Q),endY:O+p-E-C},y={startX:I+H+(j?V:0),startY:O+S+f-Y.bBox.ba,endX:I+F+(z?0:Q),endY:O+S+f+Y.bBox.bd};else{const q=W&&!j;M={startX:I+H+(q?0:V),startY:O,endX:I+F+(z?0:Q),endY:O+p-E-C},y={startX:I+H+(q?0:V),startY:O+S+f-Y.bBox.ba,endX:I+F+(z?0:Q),endY:O+S+f+Y.bBox.bd}}n.push(Fn(M)),o.push(Fn(y)),a.push({startOffset:W?G:G+N.count,endOffset:z?k:k+x.count,collapsed:X})}),{borderBoxPointGroup:n,contentBoxPointGroup:o,cursorList:a}}_isValidPosition(t,e){const{segmentPage:n,pageType:o}=t,{segmentPage:a,pageType:r}=e;return o!==r?!1:o===_.DocumentSkeletonPageType.HEADER||o===_.DocumentSkeletonPageType.FOOTER?n===a:!0}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,glyph:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,glyph:0}}_setNodePositionState(t=0,e,n,o){o===e?this._currentStartState[t]=1:this._currentStartState[t]=0,o===n?this._currentEndState[t]=2:this._currentEndState[t]=0}_checkPreviousNodePositionState(t,e=!0){let n=t,o;for(;n>=0;){const a=Ft[n];let r;if(e?r=this._currentStartState[a]:r=this._currentEndState[a],r===void 0)return;if(o===void 0&&(o=r),r!==o)return 0;n--}return o}_getSelectionRuler(t,e,n,o,a){let r=0,c=o;const l=Ft[t],A=Ft[t+1];if(A===null||l===null)return{start_next:r,end_next:c};const d=e[l],u=n[l];this._setNodePositionState(l,d,u,a);const m=this._checkPreviousNodePositionState(t),g=this._checkPreviousNodePositionState(t,!1);return m===1&&(r=e[A]),g===2&&(c=n[A]),{start_next:r,end_next:c}}_selectionIterator(t,e,n){var b,R;const o=this._docSkeleton;if(!o)return[];const{pageType:a,path:r}=t;this._liquid.reset();const c=o.getSkeletonData();if(c==null)return[];const{pages:l,skeHeaders:A,skeFooters:d}=c,{page:u,segmentPage:m}=t,{page:g,segmentPage:h}=e;if(this._resetCurrentNodePositionState(),this._documentOffsetConfig==null)return[];const{pageLayoutType:p,pageMarginLeft:f,pageMarginTop:S}=this._documentOffsetConfig,E=a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?u:m;for(let I=0;I<E;I++){const O=l[I];this._liquid.translatePage(O,p,f,S)}const C=a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?g:h;for(let I=E;I<=C;I++){const O=l[I],{headerId:M,footerId:y,pageWidth:N}=O;let x=O;if(a===_.DocumentSkeletonPageType.HEADER?x=(b=A.get(M))==null?void 0:b.get(N):a===_.DocumentSkeletonPageType.FOOTER?x=(R=d.get(y))==null?void 0:R.get(N):a===_.DocumentSkeletonPageType.CELL&&(x=_.getPageFromPath(c,r)),x==null){this._liquid.translatePage(O,p,f,S);continue}const w=x.sections,{start_next:H,end_next:V}=this._getSelectionRuler(Ye.page,t,e,w.length-1,a===_.DocumentSkeletonPageType.BODY||a===_.DocumentSkeletonPageType.CELL?I:0);switch(this._liquid.translateSave(),a){case _.DocumentSkeletonPageType.HEADER:this._liquid.translatePagePadding({...x,marginLeft:O.marginLeft});break;case _.DocumentSkeletonPageType.FOOTER:{const F=O.pageHeight-x.height-x.marginBottom;this._liquid.translate(O.marginLeft,F);break}case _.DocumentSkeletonPageType.CELL:{this._liquid.translatePagePadding(O);const F=x.parent,Q=F.parent,{left:j}=x,{top:G,left:k}=Q,{top:W}=F;this._liquid.translate(k+j,G+W),this._liquid.translatePagePadding(x);break}default:this._liquid.translatePagePadding(O);break}for(let F=H;F<=V;F++){const Q=w[F],j=Q.columns,{start_next:G,end_next:k}=this._getSelectionRuler(Ye.section,t,e,j.length-1,F);this._liquid.translateSection(Q);for(let W=G;W<=k;W++){const z=j[W],X=z.lines,{start_next:Y,end_next:q}=this._getSelectionRuler(Ye.column,t,e,X.length-1,W);this._liquid.translateColumn(z);for(let K=Y;K<=q;K++){const $=X[K],{divides:ie}=$,{start_next:fe,end_next:Fe}=this._getSelectionRuler(Ye.line,t,e,ie.length-1,K);this._liquid.translateSave(),this._liquid.translateLine($,!0,!1);for(let Se=fe;Se<=Fe;Se++){const io=ie[Se];this._liquid.translateSave(),this._liquid.translateDivide(io);const{glyphGroup:_A}=io,{start_next:NA,end_next:PA}=this._getSelectionRuler(Ye.divide,t,e,_A.length-1,Se);let fa=!1,Sa=!1;I===E&&F===H&&W===G&&K===Y&&Se===fe&&(fa=!0),I===C&&F===V&&W===k&&K===q&&Se===Fe&&(Sa=!0),n&&n(NA,PA,fa,Sa,io,$,z,Q,x),this._liquid.translateRestore()}this._liquid.translateRestore()}}}this._liquid.translateRestore(),this._liquid.translatePage(O,p,f,S)}}}function vo(i,t){const{path:e}=i,{path:n}=t;if(e.length!==n.length||e.indexOf("cells")===-1)return!1;const o=e.indexOf("skeTables")+1,a=e.indexOf("rows")+1,r=e.indexOf("cells")+1,{tableId:c,sliceIndex:l}=_.getTableIdAndSliceIndex(e[o]),{tableId:A,sliceIndex:d}=_.getTableIdAndSliceIndex(n[o]);if(c!==A)return!1;const u=e[a],m=n[a],g=e[r],h=n[r];return!(u===m&&g===h&&l===d)}function Hn(i,t){const{path:e}=i,{path:n}=t;return e.indexOf("cells")===-1||n.indexOf("cells")===-1||e.length!==n.length?!1:s.Tools.diffValue(e,n)}function Io(i,t,e){var g,h,p,f,S,E,C,b;const{path:n}=t,{path:o}=e;if(n.indexOf("cells")===-1||o.indexOf("cells")===-1)return!1;const a=i.findGlyphByPosition(t),r=i.findGlyphByPosition(e),c=(f=(p=(h=(g=a==null?void 0:a.parent)==null?void 0:g.parent)==null?void 0:h.parent)==null?void 0:p.parent)==null?void 0:f.parent,l=(b=(C=(E=(S=r==null?void 0:r.parent)==null?void 0:S.parent)==null?void 0:E.parent)==null?void 0:C.parent)==null?void 0:b.parent;if(c==null||l==null)return!1;const A=c.parent,d=l.parent,u=A.cells.indexOf(c),m=d.cells.indexOf(l);return u===m&&A.index===d.index}function kn(i,t){if(Hn(i,t))return wn(i,t);const{path:e}=i,{path:n}=t,o=e[e.length-5],a=n[n.length-5];if(o!==a&&typeof o=="string"&&typeof a=="string"){const d=o.split("#-#")[1],u=a.split("#-#")[1];return+d<+u}const r=e[e.length-3],c=n[n.length-3],l=e[e.length-1],A=n[n.length-1];return r<c?!0:r>c?!1:l<=A}function qe(i){return i.sections[0].columns[0].lines.length===0}function Da(i,t,e){let n=t,o=e,a=i[n],r=i[o];for(;n<o&&(qe(a)||qe(r));)qe(a)?(n++,a=i[n]):qe(r)&&(o--,r=i[o]);if(!qe(a)&&!qe(r))return[a,r]}class Vn{constructor(t,e){B(this,"_liquid",new _.Liquid);this._documentOffsetConfig=t,this._docSkeleton=e}getRangePointData(t,e){const n=[],a=this._docSkeleton.getSkeletonData();if(a==null)return;const{pages:r}=a,{segmentPage:c,page:l,pageType:A}=t,d=this._getTableRectRangeInfo(t,e);if(d==null)return;const{tableId:u,startRowIndex:m,startColumnIndex:g,endRowIndex:h,endColumnIndex:p}=d;this._liquid.reset();const{pageLayoutType:f,pageMarginLeft:S,pageMarginTop:E}=this._documentOffsetConfig,C=A===_.DocumentSkeletonPageType.BODY||A===_.DocumentSkeletonPageType.CELL?l:c;for(let b=0;b<C;b++){const R=r[b];this._liquid.translatePage(R,f,S,E)}for(let b=C;b<r.length;b++){const R=r[b];this._liquid.translatePagePadding(R);const{skeTables:I}=R;let O=null;for(const[x,w]of I.entries())x.startsWith(u)&&(O=w);if(O==null){this._liquid.restorePagePadding(R),this._liquid.translatePage(R,f,S,E);continue}this._liquid.translateSave(),this._liquid.translate(0,O.top);const{x:M,y}=this._liquid,{left:N}=O;for(const x of O.rows)if(x.index>=m&&x.index<=h){const w=Da(x.cells,g,p);if(w==null)continue;const[H,V]=w,F={startX:M+H.left+N,startY:y+x.top,endX:M+V.left+V.pageWidth+N,endY:y+x.top+x.height};n.push(Fn(F))}this._liquid.translateRestore(),this._liquid.restorePagePadding(R),this._liquid.translatePage(R,f,S,E)}return{pointGroup:n,startRow:m,startColumn:g,endRow:h,endColumn:p,tableId:u}}getNodePositionGroup(t,e){const n=[],o=this._docSkeleton.findCharIndexByPosition(t),a=this._docSkeleton.findCharIndexByPosition(e);if(o==null||a==null)return;const r=o<a,c=this._getTableRectRangeInfo(t,e);if(c==null)return;const{tableId:l,startRowIndex:A,startColumnIndex:d,endRowIndex:u,endColumnIndex:m}=c,g=this._docSkeleton.getViewModel().findTableNodeById(l);if(g==null)return;const h=g.children[0].children.length;if(d===0&&m===h-1){const f=g.children[A].children[d],S=this._docSkeleton.findNodePositionByCharIndex(f.startIndex+1),E=g.children[u].children[m],C=this._docSkeleton.findNodePositionByCharIndex(E.endIndex-2);if(S==null||C==null)return;n.push({anchor:r?S:C,focus:r?C:S})}else for(let f=A;f<=u;f++){const S=g.children[f],E=S.children[d],C=S.children[m],b=this._docSkeleton.findNodePositionByCharIndex(E.startIndex+1),R=this._docSkeleton.findNodePositionByCharIndex(C.endIndex-2);if(b==null||R==null)return;n.push({anchor:r?b:R,focus:r?R:b})}return n}_getTableRectRangeInfo(t,e){const o=this._docSkeleton.getSkeletonData();if(o==null)return;const{pages:a}=o,{path:r}=t,{path:c}=e,l=_.getPageFromPath(o,r),A=_.getPageFromPath(o,c);if(l==null||A==null)return;const d=l.segmentId,u=l.parent.index,m=l.parent.cells.indexOf(l),g=(A==null?void 0:A.parent).index,h=(A==null?void 0:A.parent).cells.indexOf(A),p=Math.min(u,g),f=Math.max(u,g),S=Math.min(m,h),E=Math.max(m,h);return{pages:a,tableId:d,startRowIndex:p,startColumnIndex:S,endRowIndex:f,endColumnIndex:E}}}const Ba="__TestSelectionRange__",_a="__TestSelectionAnchor__",Eo=6,Wn=500,Na=500,Ht=3;function ut(i){const t=i[0],e=t[0],n=t[2],{x:o,y:a}=e,{x:r,y:c}=n;return{left:o,top:a,width:r-o,height:c-a}}function kt(i){return i.map(t=>{let e=1/0,n=-1/0,o=1/0,a=-1/0;return t.forEach(r=>{e=Math.min(r.x,e),n=Math.max(r.x,n),a=Math.max(r.y,a),o=Math.min(r.y,o)}),{left:e,right:n,top:o,bottom:a}})}class He{constructor(t,e,n,o,a,r=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,c="",l=-1){B(this,"rangeType",s.DOC_RANGE_TYPE.TEXT);B(this,"_current",!1);B(this,"_rangeShape");B(this,"_anchorShape");B(this,"_cursorList",[]);B(this,"_anchorBlinkTimer",null);this._scene=t,this._document=e,this._docSkeleton=n,this.anchorNodePosition=o,this.focusNodePosition=a,this.style=r,this._segmentId=c,this._segmentPage=l,this._anchorBlink(),this.refresh()}_anchorBlink(){setTimeout(()=>{this._anchorShape&&this._anchorShape.visible&&this.deactivateStatic()},Wn),this._anchorBlinkTimer=setInterval(()=>{this._anchorShape&&this._anchorShape.visible&&(this.activeStatic(),setTimeout(()=>{this.deactivateStatic()},Wn))},Na+Wn)}get startOffset(){var o;const{startOffset:t}=(o=Qn(this._cursorList))!=null?o:{},e=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(t==null||e==null)return t;const n=e.dataStream.length-2;return Math.min(n,t)}get endOffset(){var o;const{endOffset:t}=(o=Qn(this._cursorList))!=null?o:{},e=this._docSkeleton.getViewModel().getDataModel().getSelfOrHeaderFooterModel(this._segmentId).getBody();if(t==null||e==null)return t;const n=e.dataStream.length-2;return Math.min(t,n)}get collapsed(){const{startOffset:t,endOffset:e}=this;return t!=null&&t===e}get startNodePosition(){if(this.anchorNodePosition==null)return null;if(this.focusNodePosition==null)return this.anchorNodePosition;const{start:t}=Ln(this.anchorNodePosition,this.focusNodePosition);return t}get endNodePosition(){if(this.anchorNodePosition==null)return this.focusNodePosition;if(this.focusNodePosition==null)return null;const{end:t}=Ln(this.anchorNodePosition,this.focusNodePosition);return t}get direction(){const{collapsed:t,anchorNodePosition:e,focusNodePosition:n}=this;return t||e==null||n==null?s.RANGE_DIRECTION.NONE:wn(e,n)?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}getAbsolutePosition(){const t=this.anchorNodePosition,e=this.focusNodePosition;if(this._isEmpty())return;const n=this._document.getOffsetConfig(),{docsLeft:o,docsTop:a}=n,r=new Ie(n,this._docSkeleton);if(this._isCollapsed()){const{contentBoxPointGroup:d,cursorList:u}=r.getRangePointData(t,t);if(this._setCursorList(u),d.length===0)return;const m=ut(d);return{...m,left:m.left+o,top:m.top+a}}const{borderBoxPointGroup:c,cursorList:l}=r.getRangePointData(t,e);if(this._setCursorList(l),c.length===0)return;const A=ut(c);return{...A,left:A.left+o,top:A.top+a}}getAnchor(){return this._anchorShape}activeStatic(){var t,e;(e=this._anchorShape)==null||e.setProps({stroke:((t=this.style)==null?void 0:t.strokeActive)||_.getColor(s.COLORS.black,1)})}deactivateStatic(){var t,e;(e=this._anchorShape)==null||e.setProps({stroke:((t=this.style)==null?void 0:t.stroke)||_.getColor(s.COLORS.black,0)})}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t,e;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null,(e=this._anchorShape)==null||e.dispose(),this._anchorShape=null,this._anchorBlinkTimer&&(clearInterval(this._anchorBlinkTimer),this._anchorBlinkTimer=null)}isIntersection(t){const{startOffset:e,endOffset:n}=this,{startOffset:o,endOffset:a}=t;return e==null||n==null||o==null||a==null?!1:e<=a&&n>=o}refresh(){var u,m;const{_document:t,_docSkeleton:e}=this,n=this.anchorNodePosition,o=this.focusNodePosition;if((u=this._anchorShape)==null||u.hide(),(m=this._rangeShape)==null||m.hide(),this._isEmpty())return;const a=t.getOffsetConfig(),{docsLeft:r,docsTop:c}=a,l=new Ie(a,e);if(this._isCollapsed()){const{contentBoxPointGroup:g,cursorList:h}=l.getRangePointData(n,n);if(this._setCursorList(h),g.length>0){const p=e.findGlyphByPosition(n);this._createOrUpdateAnchor(g,r,c,p)}return}const{borderBoxPointGroup:A,cursorList:d}=l.getRangePointData(n,o);this._setCursorList(d),A.length>0&&this._createOrUpdateRange(A,r,c)}_isEmpty(){return this.anchorNodePosition==null&&this.focusNodePosition==null}_isCollapsed(){const t=this.anchorNodePosition,e=this.focusNodePosition;if(t!=null&&e==null)return!0;if(t==null||e==null)return!1;const n=Object.keys(Ye);for(const o of n){const a=t[o],r=e[o];if(a!==r)return!1}return t.isBack===e.isBack}_createOrUpdateRange(t,e,n){var r;if(this._rangeShape){this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const o=.3,a=new _.RegularPolygon(Ba+s.Tools.generateRandomId(Eo),{pointsGroup:t,fill:((r=this.style)==null?void 0:r.fill)||_.getColor(s.COLORS.black,o),left:e,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=a,this._scene.addObject(a,Ht)}_createOrUpdateAnchor(t,e,n,o){var p,f,S;const a=ut(t),{left:r}=a;let{top:c,height:l}=a;const A=14;l<A&&(c-=A-l,l=A);const d=12;let u=r+e;const m=c+n,g=((p=o==null?void 0:o.ts)==null?void 0:p.it)===s.BooleanNumber.TRUE;if(g&&(u+=l*Math.tan(d*Math.PI/180)/2),this._anchorShape){this._anchorShape.transformByState({left:u,top:m,height:l}),this._anchorShape.show(),g?this._anchorShape.skew(-12,0):this._anchorShape.skew(0,0);return}const h=new _.Rect(_a+s.generateRandomId(Eo),{left:u,top:m,height:l,strokeWidth:((f=this.style)==null?void 0:f.strokeWidth)||1,stroke:((S=this.style)==null?void 0:S.strokeActive)||_.getColor(s.COLORS.black,1),evented:!1});g&&h.skew(-12,0),this._anchorShape=h,this._scene.addObject(h,Ht),this.activeStatic()}_setCursorList(t){t.length!==0&&(this._cursorList=t)}}const Pa="__DocTableRectRange__",Ua=6;function Vt(i,t,e,n,o,a=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,r="",c=-1){const l=t.getOffsetConfig(),d=new Vn(l,e).getNodePositionGroup(n,o);return(d!=null?d:[]).map(u=>new zn(i,t,e,u.anchor,u.focus,a,r,c))}class zn{constructor(t,e,n,o,a,r=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE,c="",l=-1){B(this,"rangeType",s.DOC_RANGE_TYPE.RECT);B(this,"_rangeShape");B(this,"_current",!1);B(this,"_startRow");B(this,"_startCol");B(this,"_endRow");B(this,"_endCol");B(this,"_tableId");this._scene=t,this._document=e,this._docSkeleton=n,this.anchorNodePosition=o,this.focusNodePosition=a,this.style=r,this._segmentId=c,this._segmentPage=l,this.refresh()}get startOffset(){const{startNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get endOffset(){const{endNodePosition:t}=this;return this._docSkeleton.findCharIndexByPosition(t)}get collapsed(){return!1}get startRow(){return this._startRow}get startColumn(){return this._startCol}get endRow(){return this._endRow}get endColumn(){return this._endCol}get tableId(){return this._tableId}get segmentId(){return this._segmentId}get segmentPage(){return this._segmentPage}get spanEntireRow(){var r;const e=(r=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:r[this._tableId],{_startCol:n,_endCol:o}=this;if(e==null)throw new Error("Table is not found.");const{tableColumns:a}=e;return n===0&&o===a.length-1}get spanEntireColumn(){var r;const e=(r=this._docSkeleton.getViewModel().getSnapshot().tableSource)==null?void 0:r[this._tableId],{_startRow:n,_endRow:o}=this;if(e==null)throw new Error("Table is not found.");const{tableRows:a}=e;return n===0&&o===a.length-1}get spanEntireTable(){return this.spanEntireRow&&this.spanEntireColumn}get startNodePosition(){const{anchorNodePosition:t,focusNodePosition:e}=this;return kn(t,e)?t:e}get endNodePosition(){const{anchorNodePosition:t,focusNodePosition:e}=this;return kn(t,e)?e:t}get direction(){const{anchorNodePosition:t,focusNodePosition:e}=this;return kn(t,e)?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}dispose(){var t;(t=this._rangeShape)==null||t.dispose(),this._rangeShape=null}isIntersection(t){const{startRow:e,startColumn:n,endRow:o,endColumn:a}=this,{startRow:r,startColumn:c,endRow:l,endColumn:A}=t,d={left:n,top:e,right:a,bottom:o},u={left:c,top:r,right:A,bottom:l};return s.Rectangle.hasIntersectionBetweenTwoRect(d,u)}refresh(){var f;(f=this._rangeShape)==null||f.hide();const{startNodePosition:t,endNodePosition:e,_document:n,_docSkeleton:o}=this,a=n.getOffsetConfig(),{docsLeft:r,docsTop:c}=a,A=new Vn(a,o).getRangePointData(t,e);if(A==null)return;const{pointGroup:d=[],startRow:u,endRow:m,startColumn:g,endColumn:h,tableId:p}=A;(d==null?void 0:d.length)>0&&this._createOrUpdateRange(d,r,c),this._updateTableInfo(u,m,g,h,p)}_updateTableInfo(t,e,n,o,a){this._startRow=t,this._endRow=e,this._startCol=n,this._endCol=o,this._tableId=a}_createOrUpdateRange(t,e,n){var r;if(this._rangeShape){this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),this._rangeShape.show();return}const o=.3,a=new _.RegularPolygon(Pa+s.Tools.generateRandomId(Ua),{pointsGroup:t,fill:((r=this.style)==null?void 0:r.fill)||_.getColor(s.COLORS.black,o),left:e,top:n,evented:!1,debounceParentDirty:!1});this._rangeShape=a,this._scene.addObject(a,Ht)}}function Co(i,t,e,n,o,a,r,c,l=!0,A=!0){const d=o.findNodePositionByCharIndex(i,l,r,c),u=o.findNodePositionByCharIndex(t,A,r,c);if(!(d==null||u==null))return new He(e,n,o,d,u,a,r,c)}function wa(i,t,e,n,o,a,r,c){const l=o.findNodePositionByCharIndex(i,!0,r,c),A=o.findNodePositionByCharIndex(t,!0,r,c);if(!(l==null||A==null))return new zn(e,n,o,l,A,a,r,c)}function La(i,t,e,n,o,a,r,c){const l=o.findNodePositionByCharIndex(i,!0,r,c),A=o.findNodePositionByCharIndex(t,!0,r,c);if(!(l==null||A==null))return Gn(l,A,e,n,o,a,r,c)}function Gn(i,t,e,n,o,a,r,c){const l=[],A=[],d=[e,n,o,i,t,a,r,c];if(Io(o,i,t)){if(Hn(i,t))return l.push(new He(...d)),{textRanges:l,rectRanges:A};{const C=Vt(...d);return A.push(...C),{textRanges:l,rectRanges:A}}}if(vo(i,t)){const C=Vt(...d);return A.push(...C),{textRanges:l,rectRanges:A}}const u=o.getViewModel().getSelfOrHeaderFooterViewModel(r),m=o.findCharIndexByPosition(i),g=o.findCharIndexByPosition(t);if(m==null||g==null)return;const h=m<=g?s.RANGE_DIRECTION.FORWARD:s.RANGE_DIRECTION.BACKWARD,p=Math.min(m,g),f=Math.max(m,g);let S=p,E=f;for(const C of u.getChildren())for(const b of C.children){const{startIndex:R,endIndex:I,children:O}=b,M=C.children.indexOf(b),y=C.children[M+1],N=O[0];let x=!1;if(N){const{startIndex:w,endIndex:H,children:V}=N;let F=null,Q=null;const j=V.find(k=>k.startIndex<=p&&k.endIndex>=p),G=V.find(k=>k.startIndex<=f&&k.endIndex>=f);if(p>w&&p<H)F=o.findNodePositionByCharIndex(j.startIndex+2,!0,r,c),Q=o.findNodePositionByCharIndex(H-4,!0,r,c),S=H+1;else if(f>w&&f<H)F=o.findNodePositionByCharIndex(w+3,!0,r,c),Q=o.findNodePositionByCharIndex(G.endIndex-3,!0,r,c),E=w-1,x=!0;else if(w>p&&H<f){if(F=o.findNodePositionByCharIndex(w+3,!0,r,c),Q=o.findNodePositionByCharIndex(H-4,!0,r,c),S<=w-1){const k=o.findNodePositionByCharIndex(S,!0,r,c),W=o.findNodePositionByCharIndex(w-1,!1,r,c),z=h===s.RANGE_DIRECTION.FORWARD?k:W,X=h===s.RANGE_DIRECTION.FORWARD?W:k;l.push(new He(e,n,o,z,X,a,r,c))}S=H+1}if(F&&Q){const k=h===s.RANGE_DIRECTION.FORWARD?F:Q,W=h===s.RANGE_DIRECTION.FORWARD?Q:F;A.push(...Vt(e,n,o,k,W,a,r,c))}}if(E===I+1&&!x&&y&&y.children.length&&(E=I,x=!0),E>=R&&E<=I||x){const w=o.findNodePositionByCharIndex(S,!0,r,c),H=o.findNodePositionByCharIndex(E,!x,r,c),V=h===s.RANGE_DIRECTION.FORWARD?w:H,F=h===s.RANGE_DIRECTION.FORWARD?H:w;if(A.length&&s.Tools.diffValue(V,F))continue;l.push(new He(e,n,o,V,F,a,r,c))}}return{textRanges:l,rectRanges:A}}function To(i){const t=i==null?void 0:i.getCanvasElement();if(!t)return{left:0,top:0};const{top:e,left:n}=_.getOffsetRectForDom(t);return{left:n,top:e}}function yo(i){var l;const t=(l=i.parent)==null?void 0:l.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;const{paragraphIndex:n}=t,o=e.lines.filter(A=>A.paragraphIndex===n);let a=-1,r="",c=!1;for(const A of o)for(const d of A.divides)for(const u of d.glyphGroup)c||(a+=u.count),u===i&&(c=!0),r+=u.count>0?u.content:"";return{st:o[0].st,ed:n,content:r,nodeIndex:a}}function jn(i){const{startOffset:t,endOffset:e,collapsed:n,rangeType:o,startNodePosition:a,endNodePosition:r,direction:c,segmentId:l,segmentPage:A}=i;return{startOffset:t,endOffset:e,collapsed:n,rangeType:o,startNodePosition:a,endNodePosition:r,direction:c,segmentId:l,segmentPage:A,isActive:i.isActive()}}function Qa(i){const t=jn(i),{startRow:e,startColumn:n,endRow:o,endColumn:a,tableId:r,spanEntireRow:c,spanEntireColumn:l,spanEntireTable:A}=i;return{...t,startRow:e,startColumn:n,endRow:o,endColumn:a,tableId:r,spanEntireRow:c,spanEntireColumn:l,spanEntireTable:A}}var Fa=Object.getOwnPropertyDescriptor,Ha=(i,t,e,n)=>{for(var o=n>1?void 0:n?Fa(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Wt=(i,t)=>(e,n)=>t(e,n,i);T.DocSelectionRenderService=class extends s.RxDisposable{constructor(e,n,o,a,r){super();B(this,"_onInputBefore$",new L.Subject);B(this,"onInputBefore$",this._onInputBefore$.asObservable());B(this,"_onKeydown$",new L.Subject);B(this,"onKeydown$",this._onKeydown$.asObservable());B(this,"_onInput$",new L.Subject);B(this,"onInput$",this._onInput$.asObservable());B(this,"_onCompositionstart$",new L.BehaviorSubject(null));B(this,"onCompositionstart$",this._onCompositionstart$.asObservable());B(this,"_onCompositionupdate$",new L.BehaviorSubject(null));B(this,"onCompositionupdate$",this._onCompositionupdate$.asObservable());B(this,"_onCompositionend$",new L.BehaviorSubject(null));B(this,"onCompositionend$",this._onCompositionend$.asObservable());B(this,"_onSelectionStart$",new L.BehaviorSubject(null));B(this,"onSelectionStart$",this._onSelectionStart$.asObservable());B(this,"onChangeByEvent$",L.merge(this._onInput$,this._onKeydown$.pipe(L.filter(e=>e.event.keyCode===v.KeyCode.BACKSPACE)),this._onCompositionend$));B(this,"_onPaste$",new L.Subject);B(this,"onPaste$",this._onPaste$.asObservable());B(this,"_textSelectionInner$",new L.BehaviorSubject(null));B(this,"textSelectionInner$",this._textSelectionInner$.asObservable());B(this,"_onFocus$",new L.Subject);B(this,"onFocus$",this._onFocus$.asObservable());B(this,"_onBlur$",new L.Subject);B(this,"onBlur$",this._onBlur$.asObservable());B(this,"_onPointerDown$",new L.Subject);B(this,"onPointerDown$",this._onPointerDown$.asObservable());B(this,"_container");B(this,"_inputParent");B(this,"_input");B(this,"_scrollTimers",[]);B(this,"_rangeList",[]);B(this,"_rangeListCache",[]);B(this,"_rectRangeList",[]);B(this,"_rectRangeListCache",[]);B(this,"_anchorNodePosition",null);B(this,"_focusNodePosition",null);B(this,"_currentSegmentId","");B(this,"_currentSegmentPage",-1);B(this,"_selectionStyle",_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE);B(this,"_onPointerEvent",!1);B(this,"_viewPortObserverMap",new Map);B(this,"_isIMEInputApply",!1);B(this,"_scenePointerMoveSubs",[]);B(this,"_scenePointerUpSubs",[]);B(this,"_reserveRanges",!1);this._context=e,this._layoutService=n,this._logService=o,this._univerInstanceService=a,this._docSkeletonManagerService=r,this._initDOM(),this._registerContainer(),this._setSystemHighlightColorToStyle(),this._listenCurrentUnitChange()}get isOnPointerEvent(){return this._onPointerEvent}get isFocusing(){return this._input===document.activeElement}get canFocusing(){return this.isFocusing||document.activeElement===document.body||document.activeElement===null}_listenCurrentUnitChange(){this._univerInstanceService.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(e=>{if(e==null)return;e.getUnitId()!==this._context.unitId&&!this._reserveRanges&&this.removeAllRanges()})}get activeViewPort(){return this._context.scene.getViewports()[0]}setSegment(e){this._currentSegmentId=e}getSegment(){return this._currentSegmentId}setSegmentPage(e){this._currentSegmentPage=e}getSegmentPage(){return this._currentSegmentPage}setReserveRangesStatus(e){this._reserveRanges=e}_setRangeStyle(e=_.NORMAL_TEXT_SELECTION_PLUGIN_STYLE){this._selectionStyle=e}addDocRanges(e,n=!0,o){const{_currentSegmentId:a,_currentSegmentPage:r,_selectionStyle:c}=this,{scene:l,mainComponent:A}=this._context,d=A,u=this._docSkeletonManagerService.getSkeleton(),m=(g,h)=>{const p=La(g,h,l,d,u,c,a,r);if(p==null)return;const{textRanges:f,rectRanges:S}=p;for(const E of f)this._addTextRange(E);this._addRectRanges(S)};for(const g of e){const{startOffset:h,endOffset:p,rangeType:f,startNodePosition:S,endNodePosition:E}=g;if(f===s.DOC_RANGE_TYPE.RECT){const C=wa(h,p,l,d,u,c,a,r);C&&this._addRectRanges([C])}else if(f===s.DOC_RANGE_TYPE.TEXT)try{let C=null;S&&E?C=Co(S.isBack?h:h-1,E.isBack?p:p-1,l,d,u,c,a,r,S.isBack,E.isBack):C=Co(h,p,l,d,u,c,a,r),C&&this._addTextRange(C)}catch{m(h,p)}else m(h,p)}this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:a,segmentPage:r,style:c,isEditing:n,options:o}),!(!e.length||(o==null?void 0:o.shouldFocus)===!1)&&this._updateInputPosition(o==null?void 0:o.forceFocus)}setCursorManually(e,n){const o=this._findNodeByCoord(e,n,{strict:!0,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),a=this._getNodePosition(o);if(a==null){this._removeAllRanges();return}(o==null?void 0:o.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(a.isBack=!0),this._createTextRangeByAnchorPosition(a),this._textSelectionInner$.next({textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1})}sync(){this._updateInputPosition()}activate(e,n,o=!1){this._container.style.left=`${e}px`,this._container.style.top=`${n}px`,this._container.style.zIndex="1000",(this.canFocusing||o)&&this.focus()}hasFocus(){return document.activeElement===this._input}focus(){this._input.focus()}blur(){this._input.blur()}deactivate(){this._container.style.left="0px",this._container.style.top="0px"}__handleDblClick(e){const{offsetX:n,offsetY:o}=e,a=this._findNodeByCoord(n,o,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(a==null||a.node==null)return;const r=yo(a.node);if(r==null)return;const{content:c,st:l,nodeIndex:A}=r;if(A===-1||Intl.Segmenter==null)return;const u=new Intl.Segmenter(void 0,{granularity:"word"}).segment(c);let m=Number.NEGATIVE_INFINITY,g=Number.NEGATIVE_INFINITY;for(const{segment:h,index:p,isWordLike:f}of u)if(p<=A&&A<p+h.length&&f){m=p+l,g=p+l+h.length;break}if(Number.isFinite(m)&&Number.isFinite(g)){this.removeAllRanges();const h=[{startOffset:m,endOffset:g}];this.addDocRanges(h,!1,{forceFocus:!0})}}__handleTripleClick(e){const{offsetX:n,offsetY:o}=e,a=this._findNodeByCoord(n,o,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage});if(a==null||a.node==null)return;const r=yo(a.node);if(r==null)return;this.removeAllRanges();const{st:c,ed:l}=r,A=[{startOffset:c,endOffset:l}];this.addDocRanges(A,!1,{forceFocus:!0})}__onPointDown(e){var f,S;const{scene:n,mainComponent:o}=this._context,a=this._docSkeletonManagerService.getSkeleton(),{offsetX:r,offsetY:c}=e,l=this._findNodeByCoord(r,c,{strict:!1,segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage}),A=this._getNodePosition(l);if(A==null||l==null){this._removeAllRanges();return}(l==null?void 0:l.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(A.isBack=!0);const d=this._textSelectionInner$.value;if(l&&e.button===2&&d){const E=a.findCharIndexByPosition(A);if(typeof E=="number"&&d.textRanges.some(C=>C.startOffset<=E&&C.endOffset>E)||typeof E=="number"&&d.rectRanges.some(C=>C.startOffset<=E&&C.endOffset>=E))return}const{segmentId:u,segmentPage:m}=l;u&&this._currentSegmentId&&u!==this._currentSegmentId&&this.setSegment(u),u&&m!==this._currentSegmentPage&&this.setSegmentPage(m),this._anchorNodePosition=A,e.shiftKey&&this._getActiveRangeInstance()?this._updateActiveRangePosition(A):e.ctrlKey?this._removeAllCollapsedTextRanges():this._isEmpty()||this._removeAllRanges(),n.disableObjectsEvent();const g=_.ScrollTimer.create(n);this._scrollTimers.push(g),g.startScroll(r,c),this._onSelectionStart$.next((f=this._getActiveRangeInstance())==null?void 0:f.startNodePosition),(S=n.getTransformer())==null||S.clearSelectedObjects();let h=r,p=c;this._onPointerEvent=!0,this._scenePointerMoveSubs.push(n.onPointerMove$.subscribeEvent(E=>{const{offsetX:C,offsetY:b}=E;n.setCursor(_.CURSOR_TYPE.TEXT),!(Math.sqrt((C-h)**2+(b-p)**2)<3)&&(this._moving(C,b),g.scrolling(C,b,()=>{this._moving(C,b)}),h=C,p=b)})),this._scenePointerUpSubs.push(n.onPointerUp$.subscribeEvent(()=>{if([...this._scenePointerMoveSubs,...this._scenePointerUpSubs].forEach(C=>{C.unsubscribe()}),this._onPointerEvent=!1,n.enableObjectsEvent(),this._anchorNodePosition&&!this._focusNodePosition){if(e.ctrlKey){this._disposeScrollTimers();return}const C=new He(n,o,a,this._anchorNodePosition,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(C)}else if(this._anchorNodePosition&&this._focusNodePosition){for(const C of this._rangeListCache)e.ctrlKey?C.collapsed?C.dispose():this._addTextRange(C):this._addTextRange(C);this._addRectRanges(this._rectRangeListCache),this._rangeListCache=[],this._rectRangeListCache=[]}this._anchorNodePosition=null,this._focusNodePosition=null;const E={textRanges:this._getAllTextRanges(),rectRanges:this._getAllRectRanges(),segmentId:this._currentSegmentId,segmentPage:this._currentSegmentPage,style:this._selectionStyle,isEditing:!1};this._textSelectionInner$.next(E),this._disposeScrollTimers(),this._updateInputPosition(!0)}))}removeAllRanges(){this._removeAllRanges(),this.deactivate()}getActiveTextRange(){return this._getActiveRangeInstance()}_disposeScrollTimers(){this._scrollTimers.forEach(e=>{e==null||e.dispose()}),this._scrollTimers=[]}_setSystemHighlightColorToStyle(){const{r:e,g:n,b:o,a}=_.getSystemHighlightColor(),r={strokeWidth:1,stroke:"rgba(0, 0, 0, 0)",strokeActive:"rgba(0, 0, 0, 1)",fill:`rgba(${e}, ${n}, ${o}, ${a!=null?a:.3})`};this._setRangeStyle(r)}_getAllTextRanges(){return this._rangeList.map(jn)}_getAllRectRanges(){return this._rectRangeList.map(Qa)}getAllTextRanges(){return this._getAllTextRanges()}getAllRectRanges(){return this._getAllRectRanges()}_getActiveRange(){const e=this._rangeList.find(a=>a.isActive());if(e==null)return null;const{startOffset:n,endOffset:o}=e;return n==null||o==null?null:jn(e)}_getActiveRangeInstance(){return this._rangeList.find(e=>e.isActive())}dispose(){super.dispose(),this._detachEvent(),this._removeAllRanges(),this._container.remove()}_initDOM(){const{unitId:e}=this._context,n=document.createElement("div");n.style.position="fixed",n.style.left="0px",n.style.top="0px",n.id=`univer-doc-selection-container-${e}`;const o=document.createElement("div"),a=document.createElement("div");o.appendChild(a),n.appendChild(o),this._container=n,this._inputParent=o,this._input=a,this._initInput(),this._initInputEvents(),document.body.appendChild(n)}_registerContainer(){this.disposeWithMe(this._layoutService.registerContainerElement(this._container))}_initInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.dataset.uComp="editor",this._input.id=`__editor_${this._context.unitId}`,this._input.style.cssText=`
            position: absolute;
            overflow: hidden;
            opacity: 1;
            background: #000;
            color: transparent;
            outline: none;
            z-index: -2;
            caret-color: transparent;
            white-space: pre-wrap;
            user-select: text;
        `}_getNodePosition(e){if(e==null)return;const{node:n,ratioX:o,segmentPage:a}=e,c=this._docSkeletonManagerService.getSkeleton().findPositionByGlyph(n,a);if(c==null)return;let A=o<.5;return n.glyphType===_.GlyphType.LIST&&(A=!0),{...c,isBack:A}}_interactTextRanges(e){const n=[];for(const o of this._rangeList){if(e.some(a=>a.isIntersection(o))){o.dispose();continue}n.push(o)}this._rangeList=n}_interactRectRanges(e){const n=[];for(const o of this._rectRangeList){if(e.some(a=>a.isIntersection(o))){o.dispose();continue}n.push(o)}this._rectRangeList=n}_removeAllRanges(){this._removeAllTextRanges(),this._removeAllRectRanges()}_removeAllCacheRanges(){this._rangeListCache.forEach(e=>{e.dispose()}),this._rectRangeListCache.forEach(e=>{e.dispose()}),this._rangeListCache=[],this._rectRangeListCache=[]}_removeAllTextRanges(){this._rangeList.forEach(e=>{e.dispose()}),this._rangeList=[]}_removeAllRectRanges(){this._rectRangeList.forEach(e=>{e.dispose()}),this._rectRangeList=[]}_removeAllCollapsedTextRanges(){for(const e of this._rangeList)e.collapsed&&e.dispose()}_deactivateAllTextRanges(){this._rangeList.forEach(e=>{e.deactivate()})}_deactivateAllRectRanges(){this._rectRangeList.forEach(e=>{e.deactivate()})}_addTextRangesToCache(e){this._rangeListCache.push(...e)}_addTextRange(e){this._deactivateAllTextRanges(),e.activate(),this._rangeList.push(e)}_addRectRangesToCache(e){this._rectRangeListCache.push(...e)}_addRectRanges(e){e.length!==0&&(this._deactivateAllRectRanges(),e[e.length-1].activate(),this._rectRangeList.push(...e))}_createTextRangeByAnchorPosition(e){this._removeAllRanges();const{scene:n,mainComponent:o}=this._context,a=this._docSkeletonManagerService.getSkeleton(),r=new He(n,o,a,e,void 0,this._selectionStyle,this._currentSegmentId,this._currentSegmentPage);this._addTextRange(r)}_updateActiveRangePosition(e){const n=this._getActiveRangeInstance();if(n==null||n.anchorNodePosition==null){this._logService.error("[DocSelectionRenderService] _updateActiveRangeFocusPosition: active range has no anchor");return}this._removeAllRanges(),this._anchorNodePosition=n.anchorNodePosition,this._focusNodePosition=e;const{scene:o,mainComponent:a}=this._context,r=this._docSkeletonManagerService.getSkeleton(),{_anchorNodePosition:c,_focusNodePosition:l,_selectionStyle:A,_currentSegmentId:d,_currentSegmentPage:u}=this;if(c==null||l==null||a==null)return;const m=Gn(c,l,o,a,r,A,d,u);if(m==null)return;const{textRanges:g,rectRanges:h}=m;this._addTextRangesToCache(g),this._addRectRangesToCache(h),this.deactivate()}_isEmpty(){return this._rangeList.length===0&&this._rectRangeList.length===0}_getCanvasOffset(){var n;const e=(n=this._context.scene)==null?void 0:n.getEngine();return To(e)}_updateInputPosition(e=!1){const n=this._getActiveRangeInstance(),o=n==null?void 0:n.getAnchor();if(!o||o&&!o.visible||this.activeViewPort==null){this.focus();return}const{left:a,top:r}=o,c=this.activeViewPort.getAbsoluteVector(_.Vector2.FromArray([a,r])),{x:l,y:A}=c;let{left:d,top:u}=this._getCanvasOffset();d+=l,u+=A,this.activate(d,u,e)}_moving(e,n){var E,C;const{_currentSegmentId:o,_currentSegmentPage:a}=this,r=this._findNodeByCoord(e,n,{strict:!0,segmentId:o,segmentPage:a}),c=this._getNodePosition(r);if(c==null||r==null)return;const l=r==null?void 0:r.node.parent,A=l==null?void 0:l.glyphGroup[l.glyphGroup.indexOf(r.node)+1];(r==null?void 0:r.node.streamType)===s.DataStreamTreeTokenType.PARAGRAPH&&(A==null?void 0:A.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK&&(c.isBack=!0),this._focusNodePosition=c,this._removeAllCacheRanges();const{_anchorNodePosition:d,_selectionStyle:u}=this,{scene:m,mainComponent:g}=this._context,h=this._docSkeletonManagerService.getSkeleton();if(d==null||g==null)return;const p=Gn(d,c,m,g,h,u,o,a);if(p==null)return;const{textRanges:f,rectRanges:S}=p;this._rangeList.length>0&&f.length>0&&this._interactTextRanges(f),this._rectRangeList.length>0&&S.length>0&&this._interactRectRanges(S),this._addTextRangesToCache(f),this._addRectRangesToCache(S),this.deactivate(),(C=(E=this._context.scene)==null?void 0:E.getEngine())==null||C.setCapture()}__attachScrollEvent(){const e=this.activeViewPort;if(!e)return;const{unitId:n}=this._context;if(this._viewPortObserverMap.has(n))return;const o=e.onScrollAfter$.subscribeEvent(r=>{if(!r.viewport)return;const l=this._getActiveRangeInstance();l==null||l.activeStatic()}),a=e.onScrollEnd$.subscribeEvent(r=>{const c=r.viewport;if(!c)return;const l=c.getBounding(),A=this._getActiveRangeInstance(),d=A==null?void 0:A.getAnchor();if(!(!d||d&&!d.visible)){if(l){const{left:u,top:m,right:g,bottom:h}=l.viewBound;if(d.left<u||d.left>g||d.top<m||d.top>h){A==null||A.deactivateStatic();return}}this._updateInputPosition()}});this._viewPortObserverMap.set(n,{scrollBefore:o,scrollStop:a})}_initInputEvents(){this.disposeWithMe(L.fromEvent(this._input,"keydown").subscribe(e=>{this._isIMEInputApply||this._eventHandle(e,n=>{this._onKeydown$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"input").subscribe(e=>{if(!(e.inputType==="historyUndo"||e.inputType==="historyRedo")){if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply||this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onInput$.next(n)})}})),this.disposeWithMe(L.fromEvent(this._input,"compositionstart").subscribe(e=>{if(this._rectRangeList.length>0)return e.stopPropagation(),e.preventDefault();this._isIMEInputApply=!0,this._eventHandle(e,n=>{this._onCompositionstart$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"compositionend").subscribe(e=>{this._isIMEInputApply=!1,this._eventHandle(e,n=>{this._onCompositionend$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"compositionupdate").subscribe(e=>{this._eventHandle(e,n=>{this._onInputBefore$.next(n),this._onCompositionupdate$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"paste").subscribe(e=>{this._eventHandle(e,n=>{this._onPaste$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"focus").subscribe(e=>{this._eventHandle(e,n=>{this._onFocus$.next(n)})})),this.disposeWithMe(L.fromEvent(this._input,"blur").subscribe(e=>{this._eventHandle(e,n=>{this._onBlur$.next(n)})}))}_eventHandle(e,n){const o=this._input.textContent||"";this._input.innerHTML="";const a=this._getActiveRange(),r=this._getAllTextRanges();n({event:e,content:o,activeRange:a,rangeList:r})}_getTransformCoordForDocumentOffset(e,n){const o=this._context.mainComponent,{documentTransform:a}=o.getOffsetConfig();if(this.activeViewPort==null||a==null)return;const r=this.activeViewPort.transformVector2SceneCoord(_.Vector2.FromArray([e,n]));if(r)return a.clone().invert().applyPoint(r)}_findNodeByCoord(e,n,o){const a=this._getTransformCoordForDocumentOffset(e,n);if(a==null)return;const r=this._context.mainComponent,c=this._docSkeletonManagerService.getSkeleton(),{pageLayoutType:l=_.PageLayoutType.VERTICAL,pageMarginLeft:A,pageMarginTop:d}=r.getOffsetConfig();return c.findNodeByCoord(a,l,A,d,o)}_detachEvent(){this._onInputBefore$.complete(),this._onKeydown$.complete(),this._onInput$.complete(),this._onCompositionstart$.complete(),this._onCompositionupdate$.complete(),this._onCompositionend$.complete(),this._onSelectionStart$.complete(),this._textSelectionInner$.complete(),this._onPaste$.complete(),this._onFocus$.complete(),this._onBlur$.complete(),this._onPointerDown$.complete()}},T.DocSelectionRenderService=Ha([Wt(1,v.ILayoutService),Wt(2,s.ILogService),Wt(3,s.IUniverInstanceService),Wt(4,s.Inject(D.DocSkeletonManagerService))],T.DocSelectionRenderService);class bo extends s.Disposable{constructor(e,n,o,a,r,c){super();B(this,"_change$",new L.Subject);B(this,"change$",this._change$.asObservable());B(this,"_input$",new L.Subject);B(this,"input$",this._input$.asObservable());B(this,"_paste$",new L.Subject);B(this,"paste$",this._paste$.asObservable());B(this,"_focus$",new L.Subject);B(this,"focus$",this._focus$.asObservable());B(this,"_blur$",new L.Subject);B(this,"blur$",this._blur$.asObservable());B(this,"_selectionChange$",new L.Subject);B(this,"selectionChange$",this._selectionChange$.asObservable());this._param=e,this._univerInstanceService=n,this._docSelectionManagerService=o,this._commandService=a,this._undoRedoService=r,this._injector=c,this._listenSelection()}get docSelectionRenderService(){return this._param.render.with(T.DocSelectionRenderService)}_listenSelection(){const e=this._param.render.with(T.DocSelectionRenderService);this.disposeWithMe(e.onBlur$.subscribe(n=>{this._blur$.next(n);const o=this.getDocumentData();this._change$.next({target:this,data:o})})),this.disposeWithMe(e.onFocus$.subscribe(n=>{this._focus$.next(n)})),this.disposeWithMe(e.onPaste$.subscribe(n=>{this._paste$.next(n)})),this.disposeWithMe(L.merge(e.onInput$,e.onKeydown$.pipe(At.filter(n=>{const o=n.event;return o.ctrlKey||o.metaKey?[v.KeyCode.X,v.KeyCode.V].includes(o.keyCode):[v.KeyCode.BACKSPACE].includes(o.keyCode)})),e.onCompositionupdate$,e.onCompositionend$,e.onPaste$).subscribe(n=>{if(n==null)return;const{content:o=""}=n,a=this.getDocumentData();this._input$.next({target:this,content:o,data:a,isComposing:n.event.type==="compositionupdate"})})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(n=>{if(n==null)return;const{unitId:o,subUnitId:a,...r}=n,c=this.getEditorId();o===c&&this._selectionChange$.next(r)}))}isFocus(){const e=this._param.render.with(T.DocSelectionRenderService);return e.isFocusing&&!!e.getActiveTextRange()}focus(){const e=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),n=this.getEditorId();(e==null||e.getUnitId()!==n)&&this._univerInstanceService.setCurrentUnitForType(n),this._param.render.with(T.DocSelectionRenderService).focus()}blur(){this._param.render.with(T.DocSelectionRenderService).blur()}select(){const e=this.getDocumentData();return this.setSelectionRanges([{startOffset:0,endOffset:e.body?e.body.dataStream.length-2:0}])}setSelectionRanges(e,n=!0){const o=this.getEditorId(),a={unitId:o,subUnitId:o};return this._docSelectionManagerService.replaceDocRanges(e,a,!1,{shouldFocus:n})}getSelectionRanges(){const e=this.getEditorId(),n={unitId:e,subUnitId:e};return this._docSelectionManagerService.getDocRanges(n)}getCursorPosition(){var n,o;return(o=(n=this.getSelectionRanges().find(a=>a.collapsed))==null?void 0:n.startOffset)!=null?o:-1}getEditorId(){return this._getEditorId()}getDocumentData(){return this._getDocDataModel().getSnapshot()}getDocumentDataModel(){return this._getDocDataModel()}setDocumentData(e,n){this._commandService.syncExecuteCommand(Pn.id,{unitId:this.getEditorId(),snapshot:e,textRanges:n})}replaceText(e,n=!0){const o=this.getDocumentData();this.setDocumentData({...o,body:{dataStream:`${e}\r
`,paragraphs:[{startIndex:0}],customRanges:[],sectionBreaks:[],tables:[],textRuns:[]}},typeof n=="object"?n:n?[{startOffset:e.length,endOffset:e.length,collapsed:!0}]:null)}clearUndoRedoHistory(){const e=this.getEditorId();return this._undoRedoService.clearUndoRedo(e)}dispose(){this._getDocDataModel().dispose()}get editorUnitId(){return this._param.editorUnitId}get params(){return this._param}get cancelDefaultResizeListener(){return this._param.cancelDefaultResizeListener}get render(){return this._param.render}isReadOnly(){return this._param.readonly===!0}getBoundingClientRect(){return this._param.editorDom.getBoundingClientRect()}get editorDOM(){return this._param.editorDom}isVisible(){return this._param.visible}getSkeleton(){var n;return(n=this._injector.get(_.IRenderManagerService).getRenderById(this._getEditorId()))==null?void 0:n.with(D.DocSkeletonManagerService).getSkeleton()}isSheetEditor(){return s.isInternalEditorID(this._getEditorId())}getValue(){var o;return(((o=this._getDocDataModel().getBody())==null?void 0:o.dataStream)||"").replace(/\r\n/g,"").replace(/\n/g,"").replace(/\n/g,"")}getBody(){return this._getDocDataModel().getBody()}update(e){this._param={...this._param,...e}}updateCanvasStyle(){var o;const e=this._getDocDataModel();if(e==null)return;const n={};(o=this._param.canvasStyle)!=null&&o.fontSize&&(n.textStyle==null&&(n.textStyle={}),n.textStyle.fs=this._param.canvasStyle.fontSize),e.updateDocumentStyle(n)}_getDocDataModel(){const e=this._getEditorId();return this._univerInstanceService.getUnit(e,s.UniverInstanceType.UNIVER_DOC)}_getEditorId(){var e;return((e=this._param.initialSnapshot)==null?void 0:e.id)||this._param.editorUnitId||""}}var ka=Object.getOwnPropertyDescriptor,Va=(i,t,e,n)=>{for(var o=n>1?void 0:n?ka(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},ke=(i,t)=>(e,n)=>t(e,n,i);const Wa=["editor","render-canvas"];T.EditorService=class extends s.Disposable{constructor(e,n,o,a,r,c,l){super();B(this,"_editors",new Map);B(this,"_focusEditorUnitId");B(this,"_blur$",new L.Subject);B(this,"blur$",this._blur$.asObservable());B(this,"_focus$",new L.Subject);B(this,"focus$",this._focus$.asObservable());this._univerInstanceService=e,this._renderManagerService=n,this._docSelectionManagerService=o,this._contextService=a,this._commandService=r,this._undoRedoService=c,this._injector=l,this._initUniverFocusListener()}_initUniverFocusListener(){this.disposeWithMe(L.fromEvent(window,"focusin").subscribe(e=>{const n=e.target;this._blurSheetEditor(n)}))}_blurSheetEditor(e){if(Wa.some(o=>e.dataset.uComp===o))return;const n=this.getFocusEditor();n&&n.isSheetEditor()!==!0&&this.blur()}_setFocusId(e){this._focusEditorUnitId=e}getFocusId(){return this._focusEditorUnitId}getFocusEditor(){if(this._focusEditorUnitId)return this.getEditor(this._focusEditorUnitId)}isEditor(e){return this._editors.has(e)}isSheetEditor(e){const n=this._editors.get(e);return!!(n&&n.isSheetEditor())}blur(e){const n=this.getFocusEditor();e&&(n==null||n.setSelectionRanges([])),n==null||n.blur(),this._contextService.setContextValue(s.EDITOR_ACTIVATED,!1),this._contextService.setContextValue(s.FOCUSING_EDITOR_STANDALONE,!1),this._setFocusId(null),this._blur$.next(null)}focus(e){if(e===this._focusEditorUnitId||(this._focusEditorUnitId&&this.blur(),e==null))return;const n=this.getEditor(e);if(n==null)return;this._univerInstanceService.setCurrentUnitForType(e);const o=n.getValue().length;this._contextService.setContextValue(s.EDITOR_ACTIVATED,!0),s.isInternalEditorID(e)||this._contextService.setContextValue(s.FOCUSING_EDITOR_STANDALONE,!0),n.focus(),this._setFocusId(e),this._focus$.next({startOffset:o,endOffset:o})}dispose(){this._editors.clear(),super.dispose()}getEditor(e=this._getCurrentEditorUnitId()){return this._editors.get(e)}getAllEditor(){return this._editors}register(e,n){var A,d,u,m;const{initialSnapshot:o,canvasStyle:a={}}=e,r=o.id;this._univerInstanceService.getUnit(r,s.UniverInstanceType.UNIVER_DOC)==null&&this._univerInstanceService.createUnit(s.UniverInstanceType.UNIVER_DOC,o||this._getBlank(r),{makeCurrent:!1});let l=this._renderManagerService.getRenderById(r);if(l==null&&(this._renderManagerService.create(r),l=this._renderManagerService.getRenderById(r)),l){l.engine.setContainer(n);const g=new bo({...e,render:l,editorDom:n,canvasStyle:a},this._univerInstanceService,this._docSelectionManagerService,this._commandService,this._undoRedoService,this._injector);this._editors.set(r,g),e.scrollBar||(m=(u=(d=(A=l.mainComponent)==null?void 0:A.getScene())==null?void 0:d.getViewports())==null?void 0:u[0].getScrollBar())==null||m.dispose()}return s.toDisposable(()=>{this._unRegister(r)})}_unRegister(e){const n=this._editors.get(e);n!=null&&(this._renderManagerService.removeRender(e),n.dispose(),this._editors.delete(e),this._univerInstanceService.disposeUnit(e))}_getCurrentEditorUnitId(){return this._univerInstanceService.getCurrentUniverDocInstance().getUnitId()}_getBlank(e){return{id:e,body:{dataStream:`${s.DEFAULT_EMPTY_DOCUMENT_VALUE}`,textRuns:[],paragraphs:[{startIndex:0}]},documentStyle:{renderConfig:{verticalAlign:s.VerticalAlign.TOP,horizontalAlign:s.HorizontalAlign.LEFT},marginLeft:3,marginTop:0,marginRight:3}}}},T.EditorService=Va([ke(0,s.IUniverInstanceService),ke(1,_.IRenderManagerService),ke(2,s.Inject(D.DocSelectionManagerService)),ke(3,s.IContextService),ke(4,s.ICommandService),ke(5,s.IUndoRedoService),ke(6,s.Inject(s.Injector))],T.EditorService);const ce=s.createIdentifier("univer.editor.service");function za(i){const{editorId:t,initialValue:e,container:n,autoFocus:o,isSingle:a}=i,r=U.useMemo(()=>o!=null?o:!1,[]),[c,l]=U.useState(),A=v.useDependency(ce);return U.useLayoutEffect(()=>{var d,u;if(n.current){const m=typeof e=="string"?void 0:s.Tools.deepClone(e),g={body:{dataStream:typeof e=="string"?`${e}\r
`:`\r
`,textRuns:[],customBlocks:[],customDecorations:[],customRanges:[],paragraphs:[{startIndex:0}]},...m,documentStyle:{...m==null?void 0:m.documentStyle,pageSize:{width:a?1/0:n.current.clientWidth,height:1/0}},id:t},h=A.register({autofocus:!0,editorUnitId:t,initialSnapshot:g},n.current),p=A.getEditor(t);if(l(p),r){p.focus();const f=((u=(d=g.body)==null?void 0:d.dataStream.length)!=null?u:2)-2;p.setSelectionRanges([{startOffset:f,endOffset:f}])}return()=>{h==null||h.dispose()}}},[]),c}const Ee={id:"doc.operation.move-cursor",type:s.CommandType.OPERATION,handler:(i,t)=>!!t},Ce={id:"doc.operation.move-selection",type:s.CommandType.OPERATION,handler:(i,t)=>!!t},Ga=(i,t,e,n)=>{const o=v.useDependency(s.ICommandService),a=v.useDependency(v.IShortcutService),r=U.useRef(t);r.current=t;const c=U.useRef(n);c.current=n,U.useEffect(()=>{if(!e||!i)return;const A=`sheet.formula-embedding-editor.${e.getEditorId()}`,d=new s.DisposableCollection,u=(g,h)=>{if(c.current){c.current(g,h);return}let p=s.Direction.LEFT;g===v.KeyCode.ARROW_DOWN?p=s.Direction.DOWN:g===v.KeyCode.ARROW_UP?p=s.Direction.UP:g===v.KeyCode.ARROW_RIGHT&&(p=s.Direction.RIGHT),h===v.MetaKeys.SHIFT?o.executeCommand(Ce.id,{direction:p}):o.executeCommand(Ee.id,{direction:p})};return d.add(o.registerCommand({id:A,type:s.CommandType.OPERATION,handler(g,h){const{keyCode:p}=h;u(p)}})),[{keyCode:v.KeyCode.ARROW_DOWN},{keyCode:v.KeyCode.ARROW_LEFT},{keyCode:v.KeyCode.ARROW_RIGHT},{keyCode:v.KeyCode.ARROW_UP},{keyCode:v.KeyCode.ARROW_DOWN,metaKey:v.MetaKeys.SHIFT},{keyCode:v.KeyCode.ARROW_LEFT,metaKey:v.MetaKeys.SHIFT},{keyCode:v.KeyCode.ARROW_RIGHT,metaKey:v.MetaKeys.SHIFT},{keyCode:v.KeyCode.ARROW_UP,metaKey:v.MetaKeys.SHIFT},{keyCode:v.KeyCode.ARROW_DOWN,metaKey:v.MetaKeys.CTRL_COMMAND},{keyCode:v.KeyCode.ARROW_LEFT,metaKey:v.MetaKeys.CTRL_COMMAND},{keyCode:v.KeyCode.ARROW_RIGHT,metaKey:v.MetaKeys.CTRL_COMMAND},{keyCode:v.KeyCode.ARROW_UP,metaKey:v.MetaKeys.CTRL_COMMAND},{keyCode:v.KeyCode.ARROW_DOWN,metaKey:v.MetaKeys.CTRL_COMMAND|v.MetaKeys.SHIFT},{keyCode:v.KeyCode.ARROW_LEFT,metaKey:v.MetaKeys.CTRL_COMMAND|v.MetaKeys.SHIFT},{keyCode:v.KeyCode.ARROW_RIGHT,metaKey:v.MetaKeys.CTRL_COMMAND|v.MetaKeys.SHIFT},{keyCode:v.KeyCode.ARROW_UP,metaKey:v.MetaKeys.CTRL_COMMAND|v.MetaKeys.SHIFT}].map(({keyCode:g,metaKey:h})=>({id:A,binding:h?g|h:g,preconditions:()=>!0,priority:900,staticParameters:{eventType:_.DeviceInputEventType.Keyboard,keyCode:g}})).forEach(g=>{d.add(a.registerShortcut(g))}),()=>{d.dispose()}},[o,e,i,a])};function ja(i,t){const e=v.useDependency(s.ICommandService);U.useEffect(()=>{if(!i)return;const n=e.onCommandExecuted(o=>{var a,r;if(o.id===D.RichTextEditingMutation.id){if(o.params.unitId!==i.getEditorId())return;const l=i.getDocumentData();t(l,s.getPlainText((r=(a=l.body)==null?void 0:a.dataStream)!=null?r:""))}});return()=>{n.dispose()}},[i,t,e])}const Xa=i=>{var W;const{className:t,autoFocus:e,onFocusChange:n,initialValue:o,onClickOutside:a,keyboardEventConfig:r,moveCursor:c=!0,style:l,isSingle:A,editorId:d,onHeightChange:u,onChange:m,defaultHeight:g=32,maxHeight:h=32,icon:p,editorRef:f,placeholder:S}=i,E=v.useDependency(ce),C=v.useEvent(n),b=v.useEvent(a),[R,I]=U.useState(g),O=U.useRef(null),M=U.useMemo(()=>d!=null?d:s.createInternalEditorID(`RICH_TEXT_EDITOR-${s.generateRandomId(4)}`),[d]),y=za({editorId:M,initialValue:o,container:O,autoFocus:e,isSingle:A}),x=v.useDependency(_.IRenderManagerService).getRenderById(M),w=x==null?void 0:x.with(T.DocSelectionRenderService),H=v.useObservable(w==null?void 0:w.textSelectionInner$),V=!!((W=w==null?void 0:w.isFocusing)!=null&&W&&(H!=null&&H.textRanges.some(z=>z.collapsed))),F=U.useRef(null),[Q,j]=U.useState(()=>{var z,X;return!s.BuildTextUtils.transform.getPlainText((X=(z=y==null?void 0:y.getDocumentData().body)==null?void 0:z.dataStream)!=null?X:"")}),{checkScrollBar:G}=ho(y,A,!0,!0);U.useLayoutEffect(()=>{if(!(!f||!y)){if(typeof f=="function"){f(y);return}f.current=y}},[y]);const k=v.useEvent(z=>{var q,K;const X=x==null?void 0:x.with(D.DocSkeletonManagerService),Y=X==null?void 0:X.getSkeleton().getActualSize();Y&&(u==null||u(Y.actualHeight),I(Math.max(g,Math.min(Y.actualHeight+10,h)))),m==null||m(z,s.getPlainText((K=(q=z.body)==null?void 0:q.dataStream)!=null?K:"")),G()});return U.useEffect(()=>{var X,Y;j(!s.BuildTextUtils.transform.getPlainText((Y=(X=y==null?void 0:y.getDocumentData().body)==null?void 0:X.dataStream)!=null?Y:""));const z=y==null?void 0:y.selectionChange$.subscribe(()=>{var q,K;j(!s.BuildTextUtils.transform.getPlainText((K=(q=y==null?void 0:y.getDocumentData().body)==null?void 0:q.dataStream)!=null?K:""))});return()=>z==null?void 0:z.unsubscribe()},[y]),v.useObservable(y==null?void 0:y.blur$),v.useObservable(y==null?void 0:y.focus$),U.useEffect(()=>{var X,Y;const z=y==null?void 0:y.getDocumentData();C==null||C(V,s.getPlainText((Y=(X=z==null?void 0:z.body)==null?void 0:X.dataStream)!=null?Y:""))},[V,C]),U.useEffect(()=>{const z=Y=>{var K,$;E.getFocusId()!==M||(($=(K=Y.target)==null?void 0:K.dataset)==null?void 0:$.editorid)===M||F.current&&!F.current.contains(Y.target)&&(b==null||b())},X=setTimeout(()=>{document.addEventListener("click",z)},100);return()=>{document.removeEventListener("click",z),clearTimeout(X)}},[y,M,E,b]),Ga(V&&c,!1,y),go(V,r,y),ja(y,k),P.jsx("div",{className:t,style:l,children:P.jsxs("div",{className:J.clsx("univer-relative univer-box-border univer-flex univer-h-8 univer-w-full univer-items-center univer-justify-around univer-gap-2 univer-rounded-md univer-pb-0.5 univer-pl-1.5 univer-pr-2 univer-pt-1.5",J.borderClassName,{"univer-border-primary-500":V}),style:{height:R},ref:F,children:[P.jsx("div",{ref:O,className:"univer-relative univer-size-full",onMouseUp:()=>y==null?void 0:y.focus()}),p,Q?P.jsx("div",{className:"univer-absolute univer-left-[5px] univer-top-[5px] univer-text-sm univer-text-gray-500",children:S}):null]})})};var le=function(){return le=Object.assign||function(i){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=t[o])}return i},le.apply(this,arguments)},Ka=function(i,t){var e={};for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&t.indexOf(n)<0&&(e[n]=i[n]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(i);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(i,n[o])&&(e[n[o]]=i[n[o]]);return e},ne=U.forwardRef(function(i,t){var e=i.icon,n=i.id,o=i.className,a=i.extend,r=Ka(i,["icon","id","className","extend"]),c="univerjs-icon univerjs-icon-".concat(n," ").concat(o||"").trim(),l=U.useRef("_".concat(Ja()));return Oo(e,"".concat(n),{defIds:e.defIds,idSuffix:l.current},le({ref:t,className:c},r),a)});function Oo(i,t,e,n,o){return U.createElement(i.tag,le(le({key:t},Ya(i,e,o)),n),(qa(i,e).children||[]).map(function(a,r){return Oo(a,"".concat(t,"-").concat(i.tag,"-").concat(r),e,void 0,o)}))}function Ya(i,t,e){var n=le({},i.attrs);e!=null&&e.colorChannel1&&n.fill==="colorChannel1"&&(n.fill=e.colorChannel1),i.tag==="mask"&&n.id&&(n.id=n.id+t.idSuffix),Object.entries(n).forEach(function(a){var r=a[0],c=a[1];r==="mask"&&typeof c=="string"&&(n[r]=c.replace(/url\(#(.*)\)/,"url(#$1".concat(t.idSuffix,")")))});var o=t.defIds;return!o||o.length===0||(i.tag==="use"&&n["xlink:href"]&&(n["xlink:href"]=n["xlink:href"]+t.idSuffix),Object.entries(n).forEach(function(a){var r=a[0],c=a[1];typeof c=="string"&&(n[r]=c.replace(/url\(#(.*)\)/,"url(#$1".concat(t.idSuffix,")")))})),n}function qa(i,t){var e,n=t.defIds;return!n||n.length===0?i:i.tag==="defs"&&(!((e=i.children)===null||e===void 0)&&e.length)?le(le({},i),{children:i.children.map(function(o){return typeof o.attrs.id=="string"&&n&&n.indexOf(o.attrs.id)>-1?le(le({},o),{attrs:le(le({},o.attrs),{id:o.attrs.id+t.idSuffix})}):o})}):i}function Ja(){return Math.random().toString(36).substring(2,8)}ne.displayName="UniverIcon";var Za={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641 1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H13.9999C14.3313 6.76641 14.5999 6.49778 14.5999 6.16641 14.5999 5.83504 14.3313 5.56641 13.9999 5.56641H1.9999zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004 1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H13.9999C14.3313 14.1004 14.5999 13.8318 14.5999 13.5004 14.5999 13.169 14.3313 12.9004 13.9999 12.9004H1.9999z"}}]},Ro=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"align-text-both-single",ref:t,icon:Za}))});Ro.displayName="AlignTextBothSingle";var $a={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9834 3.98332C1.9834 3.61513 2.28188 3.31665 2.65007 3.31665H13.3167C13.6849 3.31665 13.9834 3.61513 13.9834 3.98332 13.9834 4.35151 13.6849 4.64998 13.3167 4.64998H2.65007C2.28188 4.64998 1.9834 4.35151 1.9834 3.98332zM1.9834 7.98267C1.9834 7.61448 2.28188 7.316 2.65007 7.316H10.6501C11.0183 7.316 11.3167 7.61448 11.3167 7.98267 11.3167 8.35086 11.0183 8.64933 10.6501 8.64933H2.65007C2.28188 8.64933 1.9834 8.35086 1.9834 7.98267zM2.65007 11.316C2.28188 11.316 1.9834 11.6145 1.9834 11.9827 1.9834 12.3509 2.28188 12.6493 2.65007 12.6493H7.9834C8.35159 12.6493 8.65006 12.3509 8.65006 11.9827 8.65006 11.6145 8.35159 11.316 7.9834 11.316H2.65007z"}}]},Mo=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"catalogue-single",ref:t,icon:$a}))});Mo.displayName="CatalogueSingle";var er={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.50095 1.84399C2.73322 1.60765 3.11311 1.60435 3.34945 1.83662L8.00012 6.40726L12.6508 1.83662C12.8871 1.60435 13.267 1.60765 13.4993 1.84399C13.7316 2.08032 13.7283 2.46021 13.4919 2.69248L8.85611 7.24852L10.8941 9.25146C11.1382 9.17563 11.3976 9.13477 11.6667 9.13477C13.1026 9.13477 14.2667 10.2988 14.2667 11.7348C14.2667 13.1707 13.1026 14.3348 11.6667 14.3348C10.2307 14.3348 9.06665 13.1707 9.06665 11.7348C9.06665 11.0143 9.35973 10.3622 9.83319 9.89129L8.00012 8.08978L6.16708 9.89127C6.64055 10.3622 6.93364 11.0142 6.93364 11.7348C6.93364 13.1707 5.76958 14.3348 4.33364 14.3348C2.8977 14.3348 1.73364 13.1707 1.73364 11.7348C1.73364 10.2988 2.8977 9.13477 4.33364 9.13477C4.60263 9.13477 4.86208 9.17562 5.10612 9.25145L7.14413 7.24852L2.50831 2.69248C2.27197 2.46021 2.26868 2.08032 2.50095 1.84399ZM2.93364 11.7348C2.93364 10.9616 3.56044 10.3348 4.33364 10.3348C5.10684 10.3348 5.73364 10.9616 5.73364 11.7348C5.73364 12.508 5.10684 13.1348 4.33364 13.1348C3.56044 13.1348 2.93364 12.508 2.93364 11.7348ZM10.2667 11.7348C10.2667 10.9616 10.8935 10.3348 11.6667 10.3348C12.4398 10.3348 13.0667 10.9616 13.0667 11.7348C13.0667 12.508 12.4398 13.1348 11.6667 13.1348C10.8935 13.1348 10.2667 12.508 10.2667 11.7348Z",fillRule:"evenodd",clipRule:"evenodd"}}]},xo=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"cut-single",ref:t,icon:er}))});xo.displayName="CutSingle";var tr={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M5.3313 1.4667C5.3313 1.13533 5.59993.866699 5.9313.866699H10.069C10.4004.866699 10.669 1.13533 10.669 1.4667 10.669 1.79807 10.4004 2.0667 10.069 2.0667H5.9313C5.59993 2.0667 5.3313 1.79807 5.3313 1.4667zM1.09985 3.64443C1.09985 3.31306 1.36848 3.04443 1.69985 3.04443H14.2999C14.6312 3.04443 14.8999 3.31306 14.8999 3.64443 14.8999 3.9758 14.6312 4.24443 14.2999 4.24443H1.69985C1.36848 4.24443 1.09985 3.9758 1.09985 3.64443zM6.12398 8.30171C6.35829 8.0674 6.73819 8.0674 6.97251 8.30171L8.00007 9.32928 9.02764 8.30171C9.26195 8.0674 9.64185 8.0674 9.87617 8.30171 10.1105 8.53603 10.1105 8.91593 9.87617 9.15024L8.8486 10.1778 9.87617 11.2054C10.1105 11.4397 10.1105 11.8196 9.87617 12.0539 9.64185 12.2882 9.26195 12.2882 9.02764 12.0539L8.00007 11.0263 6.97251 12.0539C6.73819 12.2882 6.35829 12.2882 6.12398 12.0539 5.88966 11.8196 5.88966 11.4397 6.12398 11.2054L7.15154 10.1778 6.12398 9.15024C5.88966 8.91593 5.88966 8.53603 6.12398 8.30171z"}},{tag:"path",attrs:{fill:"currentColor",d:"M4.75332 5.22217C3.86966 5.22217 3.15332 5.93851 3.15332 6.82217V12.5331C3.15332 13.9691 4.31738 15.1332 5.75332 15.1332H10.2465C11.6825 15.1332 12.8465 13.9691 12.8465 12.5331V6.82217C12.8465 5.93851 12.1302 5.22217 11.2465 5.22217H4.75332ZM4.35332 6.82217C4.35332 6.60125 4.53241 6.42217 4.75332 6.42217H11.2465C11.4674 6.42217 11.6465 6.60125 11.6465 6.82217V12.5331C11.6465 13.3063 11.0197 13.9332 10.2465 13.9332H5.75332C4.98012 13.9332 4.35332 13.3063 4.35332 12.5331V6.82217Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Do=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"delete-single",ref:t,icon:tr}))});Do.displayName="DeleteSingle";var nr={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.9913 10.8779C11.4971 10.8779 11.9073 11.2882 11.9073 11.7939C11.9073 12.2997 11.4971 12.71 10.9913 12.71C10.4857 12.7099 10.0754 12.2996 10.0753 11.7939C10.0753 11.2882 10.4857 10.878 10.9913 10.8779Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M11.9572 8.51465C12.5471 8.51471 13.0936 8.82742 13.3927 9.33594L14.3419 10.9502C14.6291 11.4386 14.6479 12.037 14.3966 12.5391L14.3419 12.6377L13.3927 14.252C13.0936 14.7605 12.5471 15.0732 11.9572 15.0732H10.0255C9.50941 15.0731 9.02688 14.8339 8.71399 14.4336L8.59094 14.252L7.64075 12.6377C7.33466 12.1169 7.33466 11.471 7.64075 10.9502L8.59094 9.33594L8.71399 9.1543C9.02688 8.75387 9.50935 8.51477 10.0255 8.51465H11.9572ZM10.0255 9.84473C9.93678 9.84483 9.85287 9.87988 9.79114 9.94043L9.73743 10.0098L8.78723 11.624C8.72565 11.7288 8.72564 11.8591 8.78723 11.9639L9.73743 13.5781L9.79114 13.6475C9.85286 13.7079 9.93684 13.7431 10.0255 13.7432H11.9572C12.0757 13.7431 12.186 13.6803 12.2462 13.5781L13.1954 11.9639L13.2306 11.8809C13.2536 11.7953 13.2415 11.7025 13.1954 11.624L12.2462 10.0098C12.186 9.90756 12.0758 9.84479 11.9572 9.84473H10.0255Z",fillRule:"evenodd",clipRule:"evenodd"}},{tag:"path",attrs:{fill:"currentColor",d:"M10.5031 0.926758C11.9748 0.926758 13.1679 2.12013 13.1681 3.5918V6.41602C13.1679 6.78314 12.8702 7.08105 12.5031 7.08105C12.1361 7.08084 11.8382 6.783 11.838 6.41602V3.5918C11.8378 2.85467 11.2402 2.25684 10.5031 2.25684H4.0929C3.35572 2.25684 2.75813 2.85467 2.75793 3.5918V12.085C2.75818 12.8221 3.35574 13.4199 4.0929 13.4199H6.18958L6.32434 13.4326C6.62712 13.4947 6.85444 13.7639 6.85461 14.085C6.8544 14.406 6.62705 14.6742 6.32434 14.7363L6.18958 14.75H4.0929C2.62121 14.75 1.4281 13.5566 1.42786 12.085V3.5918C1.42806 2.12013 2.62118 0.926758 4.0929 0.926758H10.5031Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M8.04993 6.42969C8.35293 6.49172 8.58118 6.75971 8.58118 7.08105 8.581 7.40229 8.35289 7.67047 8.04993 7.73242L7.91614 7.74609H4.73547C4.36833 7.74609 4.07063 7.44816 4.07043 7.08105 4.07043 6.71379 4.3682 6.41602 4.73547 6.41602H7.91614L8.04993 6.42969zM10.1007 3.92188C10.4034 3.98418 10.631 4.25215 10.631 4.57324 10.6309 4.8943 10.4033 5.16233 10.1007 5.22461L9.96594 5.23828H4.73547C4.36824 5.23828 4.0705 4.94046 4.07043 4.57324 4.07043 4.20597 4.3682 3.9082 4.73547 3.9082H9.96594L10.1007 3.92188z"}}]},Bo=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"doc-setting-single",ref:t,icon:nr}))});Bo.displayName="DocSettingSingle";var ir={tag:"svg",attrs:{fill:"none",viewBox:"0 0 20 20",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.5547 14.1884C10.2599 14.5214 9.74019 14.5214 9.4454 14.1884L3.71321 7.71335C3.29002 7.23532 3.6294 6.48161 4.26784 6.48161L15.7322 6.48161C16.3707 6.48161 16.7101 7.23532 16.2869 7.71335L10.5547 14.1884Z"}}]},_o=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"down-single",ref:t,icon:ir}))});_o.displayName="DownSingle";var or={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M3.0999 2.66689C3.0999 2.33552 2.83127 2.06689 2.4999 2.06689 2.16853 2.06689 1.8999 2.33552 1.8999 2.66689V13.3336C1.8999 13.6649 2.16853 13.9336 2.4999 13.9336 2.83127 13.9336 3.0999 13.6649 3.0999 13.3336V8.5999H8.2334V13.3336C8.2334 13.6649 8.50203 13.9336 8.8334 13.9336 9.16477 13.9336 9.4334 13.6649 9.4334 13.3336V2.66689C9.4334 2.33552 9.16477 2.06689 8.8334 2.06689 8.50203 2.06689 8.2334 2.33552 8.2334 2.66689V7.3999H3.0999V2.66689zM14.0999 6.33879C14.0999 6.09377 13.9509 5.87336 13.7236 5.78203 13.4962 5.6907 13.2362 5.74679 13.0667 5.92373L11.4753 7.58486C11.2461 7.82415 11.2542 8.20396 11.4935 8.43319 11.7328 8.66243 12.1126 8.65427 12.3419 8.41499L12.8999 7.83245V13.3333C12.8999 13.6646 13.1686 13.9333 13.4999 13.9333 13.8313 13.9333 14.0999 13.6646 14.0999 13.3333V6.33879z"}}]},No=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"h1-single",ref:t,icon:or}))});No.displayName="H1Single";var sr={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689 1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336 2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336 8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689 7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689zM11.2667 8.33356C11.2667 7.67245 11.8201 7.26689 12.3333 7.26689 12.8465 7.26689 13.4 7.67244 13.4 8.33356 13.4 8.62807 13.2712 8.94814 12.9954 9.32391 12.7183 9.70153 12.3394 10.0744 11.9174 10.4803L11.8355 10.559C11.4524 10.9268 11.0365 11.3263 10.7149 11.7373 10.3718 12.1759 10.0667 12.7122 10.0667 13.3336 10.0667 13.6649 10.3353 13.9336 10.6667 13.9336H14C14.3314 13.9336 14.6 13.6649 14.6 13.3336 14.6 13.0022 14.3314 12.7336 14 12.7336H11.4782C11.5286 12.6531 11.5889 12.5676 11.6601 12.4767 11.9269 12.1355 12.2843 11.792 12.6877 11.4043L12.7492 11.3452C13.1606 10.9496 13.615 10.5079 13.9629 10.0338 14.3122 9.55787 14.6 8.98906 14.6 8.33356 14.6 6.88362 13.3757 6.06689 12.3333 6.06689 11.291 6.06689 10.0667 6.88361 10.0667 8.33356 10.0667 8.66493 10.3353 8.93356 10.6667 8.93356 10.998 8.93356 11.2667 8.66493 11.2667 8.33356z"}}]},Po=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"h2-single",ref:t,icon:sr}))});Po.displayName="H2Single";var ar={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689 1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336 2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336 8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689 7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689zM10.6667 6.06689C10.3353 6.06689 10.0667 6.33552 10.0667 6.66689 10.0667 6.99827 10.3353 7.26689 10.6667 7.26689H12.7732L11.193 9.29853C11.0524 9.47942 11.027 9.72465 11.1277 9.93051 11.2283 10.1364 11.4375 10.2669 11.6667 10.2669 12.2418 10.2669 12.6786 10.4115 12.9585 10.6354 13.2204 10.845 13.4 11.166 13.4 11.6669 13.4 12.1622 13.2254 12.3937 13.0567 12.5202 12.8588 12.6686 12.5829 12.7336 12.3333 12.7336 11.7271 12.7336 11.3432 12.4858 11.1106 12.23 10.8877 11.9848 10.5082 11.9667 10.2631 12.1896 10.0179 12.4125 9.99979 12.792 10.2227 13.0372 10.6568 13.5147 11.3522 13.9336 12.3333 13.9336 12.7504 13.9336 13.3078 13.8319 13.7767 13.4802 14.2746 13.1068 14.6 12.5049 14.6 11.6669 14.6 10.8345 14.2796 10.1555 13.7081 9.69837 13.4342 9.47923 13.117 9.32231 12.7746 9.21971L14.4736 7.03526C14.6143 6.85437 14.6397 6.60914 14.539 6.40328 14.4383 6.19743 14.2291 6.06689 14 6.06689H10.6667z"}}]},Uo=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"h3-single",ref:t,icon:ar}))});Uo.displayName="H3Single";var rr={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.4334 2.66689C2.4334 2.33552 2.16477 2.06689 1.8334 2.06689C1.50203 2.06689 1.2334 2.33552 1.2334 2.66689V13.3336C1.2334 13.6649 1.50203 13.9336 1.8334 13.9336C2.16477 13.9336 2.4334 13.6649 2.4334 13.3336V8.5999H7.2334V13.3336C7.2334 13.6649 7.50203 13.9336 7.8334 13.9336C8.16477 13.9336 8.4334 13.6649 8.4334 13.3336V2.66689C8.4334 2.33552 8.16477 2.06689 7.8334 2.06689C7.50203 2.06689 7.2334 2.33552 7.2334 2.66689V7.3999H2.4334V2.66689Z"}},{tag:"path",attrs:{fill:"currentColor",d:"M13.7591 6.66645C13.7591 6.40387 13.5884 6.1718 13.3377 6.09364C13.087 6.01549 12.8147 6.10941 12.6654 6.32546L9.67321 10.6577C9.60398 10.7579 9.56689 10.8769 9.56689 10.9987V11.6731C9.56689 12.0045 9.83552 12.2731 10.1669 12.2731H12.5591V13.3331C12.5591 13.6645 12.8278 13.9331 13.1591 13.9331C13.4905 13.9331 13.7591 13.6645 13.7591 13.3331V12.2731H14.1669C14.4983 12.2731 14.7669 12.0045 14.7669 11.6731C14.7669 11.3417 14.4983 11.0731 14.1669 11.0731H13.7591V6.66645ZM12.5591 8.59091V11.0731H10.8447L12.5591 8.59091Z",fillRule:"evenodd",clipRule:"evenodd"}}]},wo=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"h4-single",ref:t,icon:rr}))});wo.displayName="H4Single";var cr={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.5999 2.66689C2.5999 2.33552 2.33127 2.06689 1.9999 2.06689 1.66853 2.06689 1.3999 2.33552 1.3999 2.66689V13.3336C1.3999 13.6649 1.66853 13.9336 1.9999 13.9336 2.33127 13.9336 2.5999 13.6649 2.5999 13.3336V8.5999H7.3999V13.3336C7.3999 13.6649 7.66853 13.9336 7.9999 13.9336 8.33127 13.9336 8.5999 13.6649 8.5999 13.3336V2.66689C8.5999 2.33552 8.33127 2.06689 7.9999 2.06689 7.66853 2.06689 7.3999 2.33552 7.3999 2.66689V7.3999H2.5999V2.66689zM10.6669 6.40332C10.3355 6.40332 10.0669 6.67195 10.0669 7.00332V9.34492C10.0669 9.67629 10.3355 9.94492 10.6669 9.94492 10.7822 9.94492 10.8899 9.91238 10.9814 9.85599 10.9901 9.85195 11.0027 9.84632 11.0192 9.83936 11.0764 9.81533 11.1692 9.78033 11.2927 9.74447 11.5397 9.67268 11.8996 9.60022 12.3336 9.60022 12.4975 9.60022 12.5978 9.63412 12.6624 9.67167 12.7263 9.70877 12.79 9.76953 12.8503 9.87834 12.983 10.1181 13.0669 10.5337 13.0669 11.1669 13.0669 11.8061 12.9802 12.1936 12.8338 12.414 12.7252 12.5775 12.5275 12.7336 12.0002 12.7336 11.6445 12.7336 11.4936 12.622 11.4192 12.5328 11.3289 12.4245 11.2669 12.2453 11.2669 12.0028 11.2669 11.6714 10.9983 11.4028 10.6669 11.4028 10.3355 11.4028 10.0669 11.6714 10.0669 12.0028 10.0669 12.4244 10.1716 12.9106 10.4979 13.3016 10.8401 13.7118 11.356 13.9336 12.0002 13.9336 12.8063 13.9336 13.4419 13.6673 13.8334 13.0779 14.1869 12.5456 14.2669 11.8497 14.2669 11.1669 14.2669 10.4781 14.1841 9.81027 13.9002 9.29724 13.7521 9.02964 13.545 8.79662 13.2651 8.63403 12.986 8.4719 12.6697 8.40022 12.3336 8.40022 11.9239 8.40022 11.5627 8.44957 11.2669 8.51389V7.60332H13.3336C13.6649 7.60332 13.9336 7.33469 13.9336 7.00332 13.9336 6.67195 13.6649 6.40332 13.3336 6.40332H10.6669z"}}]},Lo=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"h5-single",ref:t,icon:cr}))});Lo.displayName="H5Single";var lr={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM3.33315 5.56641C3.00178 5.56641 2.73315 5.83504 2.73315 6.16641 2.73315 6.49778 3.00178 6.76641 3.33315 6.76641H12.6665C12.9979 6.76641 13.2665 6.49778 13.2665 6.16641 13.2665 5.83504 12.9979 5.56641 12.6665 5.56641H3.33315zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM3.33315 12.9004C3.00178 12.9004 2.73315 13.169 2.73315 13.5004 2.73315 13.8318 3.00178 14.1004 3.33315 14.1004H12.6665C12.9979 14.1004 13.2665 13.8318 13.2665 13.5004 13.2665 13.169 12.9979 12.9004 12.6665 12.9004H3.33315z"}}]},Qo=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"horizontally-single",ref:t,icon:lr}))});Qo.displayName="HorizontallySingle";var dr={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM1.9999 5.56641C1.66853 5.56641 1.3999 5.83504 1.3999 6.16641 1.3999 6.49778 1.66853 6.76641 1.9999 6.76641H11.3332C11.6646 6.76641 11.9332 6.49778 11.9332 6.16641 11.9332 5.83504 11.6646 5.56641 11.3332 5.56641H1.9999zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM1.9999 12.9004C1.66853 12.9004 1.3999 13.169 1.3999 13.5004 1.3999 13.8318 1.66853 14.1004 1.9999 14.1004H11.3332C11.6646 14.1004 11.9332 13.8318 11.9332 13.5004 11.9332 13.169 11.6646 12.9004 11.3332 12.9004H1.9999z"}}]},Fo=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"left-justifying-single",ref:t,icon:dr}))});Fo.displayName="LeftJustifyingSingle";var Ar={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M10.4713 3.52876C10.7317 3.78911 10.7317 4.21122 10.4713 4.47157L6.94273 8.00016L10.4713 11.5288C10.7317 11.7891 10.7317 12.2112 10.4713 12.4716C10.211 12.7319 9.78886 12.7319 9.52851 12.4716L5.52851 8.47157C5.26816 8.21122 5.26816 7.78911 5.52851 7.52876L9.52851 3.52876C9.78886 3.26841 10.211 3.26841 10.4713 3.52876Z",fillRule:"evenodd",clipRule:"evenodd"}}]},Ho=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"left-single",ref:t,icon:Ar}))});Ho.displayName="LeftSingle";var ur={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M1.9999 1.89941C1.66853 1.89941 1.3999 2.16804 1.3999 2.49941 1.3999 2.83078 1.66853 3.09941 1.9999 3.09941H13.9999C14.3313 3.09941 14.5999 2.83078 14.5999 2.49941 14.5999 2.16804 14.3313 1.89941 13.9999 1.89941H1.9999zM4.66665 5.56641C4.33528 5.56641 4.06665 5.83504 4.06665 6.16641 4.06665 6.49778 4.33528 6.76641 4.66665 6.76641H14C14.3314 6.76641 14.6 6.49778 14.6 6.16641 14.6 5.83504 14.3314 5.56641 14 5.56641H4.66665zM1.3999 9.8334C1.3999 9.50203 1.66853 9.2334 1.9999 9.2334H13.9999C14.3313 9.2334 14.5999 9.50203 14.5999 9.8334 14.5999 10.1648 14.3313 10.4334 13.9999 10.4334H1.9999C1.66853 10.4334 1.3999 10.1648 1.3999 9.8334zM4.66665 12.9004C4.33528 12.9004 4.06665 13.169 4.06665 13.5004 4.06665 13.8318 4.33528 14.1004 4.66665 14.1004H14C14.3314 14.1004 14.6 13.8318 14.6 13.5004 14.6 13.169 14.3314 12.9004 14 12.9004H4.66665z"}}]},ko=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"right-justifying-single",ref:t,icon:ur}))});ko.displayName="RightJustifyingSingle";var gr={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M2.06641 1.9999C2.06641 1.66853 2.33504 1.3999 2.66641 1.3999H13.3331C13.6644 1.3999 13.9331 1.66853 13.9331 1.9999V3.64434C13.9331 3.97571 13.6644 4.24434 13.3331 4.24434C13.0017 4.24434 12.7331 3.97571 12.7331 3.64434V2.5999H8.59966V13.3999H10.6665C10.9979 13.3999 11.2665 13.6685 11.2665 13.9999C11.2665 14.3313 10.9979 14.5999 10.6665 14.5999L7.99966 14.5999L5.33315 14.5999C5.00178 14.5999 4.73315 14.3313 4.73315 13.9999C4.73315 13.6685 5.00178 13.3999 5.33315 13.3999H7.39966V2.5999H3.26641V3.64434C3.26641 3.97571 2.99778 4.24434 2.66641 4.24434C2.33504 4.24434 2.06641 3.97571 2.06641 3.64434V1.9999Z"}}]},gt=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"text-type-single",ref:t,icon:gr}))});gt.displayName="TextTypeSingle";var hr={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M4.96372 2.59116C5.19803 2.35684 5.19803 1.97695 4.96372 1.74263 4.7294 1.50832 4.3495 1.50832 4.11519 1.74263L2.53945 3.31837 1.96372 2.74263C1.7294 2.50832 1.3495 2.50832 1.11519 2.74263.880874 2.97695.880874 3.35684 1.11519 3.59116L2.11519 4.59116C2.3495 4.82547 2.7294 4.82547 2.96372 4.59116L4.96372 2.59116zM14.4605 2.56689H6.8981C6.56672 2.56689 6.2981 2.83552 6.2981 3.16689 6.2981 3.49827 6.56672 3.76689 6.8981 3.76689H14.4605C14.7918 3.76689 15.0605 3.49827 15.0605 3.16689 15.0605 2.83552 14.7918 2.56689 14.4605 2.56689zM6.8981 7.2334C6.56672 7.2334 6.2981 7.50203 6.2981 7.8334 6.2981 8.16477 6.56672 8.4334 6.8981 8.4334H14.4605C14.7918 8.4334 15.0605 8.16477 15.0605 7.8334 15.0605 7.50203 14.7918 7.2334 14.4605 7.2334H6.8981zM6.2981 12.4999C6.2981 12.1685 6.56672 11.8999 6.8981 11.8999H14.4605C14.7918 11.8999 15.0605 12.1685 15.0605 12.4999 15.0605 12.8313 14.7918 13.0999 14.4605 13.0999H6.8981C6.56672 13.0999 6.2981 12.8313 6.2981 12.4999z"}},{tag:"path",attrs:{fill:"currentColor",d:"M2.87279 5.8999C1.80504 5.8999.939453 6.76549.939453 7.83324.939453 8.90099 1.80504 9.76657 2.87279 9.76657 3.94054 9.76657 4.80612 8.90099 4.80612 7.83324 4.80612 6.76549 3.94054 5.8999 2.87279 5.8999zM2.13945 7.83324C2.13945 7.42823 2.46778 7.0999 2.87279 7.0999 3.2778 7.0999 3.60612 7.42823 3.60612 7.83324 3.60612 8.23824 3.2778 8.56657 2.87279 8.56657 2.46778 8.56657 2.13945 8.23824 2.13945 7.83324zM.939453 12.5002C.939453 11.4325 1.80504 10.5669 2.87279 10.5669 3.94054 10.5669 4.80612 11.4325 4.80612 12.5002 4.80612 13.568 3.94054 14.4336 2.87279 14.4336 1.80504 14.4336.939453 13.568.939453 12.5002zM2.87279 11.7669C2.46778 11.7669 2.13945 12.0952 2.13945 12.5002 2.13945 12.9052 2.46778 13.2336 2.87279 13.2336 3.2778 13.2336 3.60612 12.9052 3.60612 12.5002 3.60612 12.0952 3.2778 11.7669 2.87279 11.7669z",fillRule:"evenodd",clipRule:"evenodd"}}]},Vo=U.forwardRef(function(i,t){return U.createElement(ne,Object.assign({},i,{id:"todo-list",ref:t,icon:hr}))});Vo.displayName="TodoList";function Wo(i){var n;const{dataStream:t}=(n=i.body)!=null?n:{},e=[s.DataStreamTreeTokenType.TABLE_START,s.DataStreamTreeTokenType.TABLE_CELL_END,s.DataStreamTreeTokenType.TABLE_CELL_START,s.DataStreamTreeTokenType.TABLE_END,s.DataStreamTreeTokenType.TABLE_ROW_END,s.DataStreamTreeTokenType.TABLE_ROW_START,s.DataStreamTreeTokenType.COLUMN_BREAK,s.DataStreamTreeTokenType.PAGE_BREAK,s.DataStreamTreeTokenType.TAB,s.DataStreamTreeTokenType.DOCS_END,s.DataStreamTreeTokenType.CUSTOM_BLOCK];if(typeof t=="string")for(let o=0;o<t.length;o++){const a=t[o];if(!e.includes(a))return o}return 0}const Xn="COMPONENT_DOC_HEADER_FOOTER_PANEL";function mr(i,t,e){const{useFirstPageHeaderFooter:n,evenAndOddHeaders:o,defaultHeaderId:a,defaultFooterId:r,firstPageHeaderId:c,firstPageFooterId:l,evenPageHeaderId:A,evenPageFooterId:d}=i;return t===_.DocumentEditArea.HEADER?n===s.BooleanNumber.TRUE&&e===0?c:o===s.BooleanNumber.TRUE&&e%2===1?A:a:n===s.BooleanNumber.TRUE&&e===0?l:o===s.BooleanNumber.TRUE&&e%2===1?d:r}const pr=i=>{const t=v.useDependency(s.LocaleService),e=v.useDependency(s.IUniverInstanceService),n=v.useDependency(_.IRenderManagerService),o=v.useDependency(s.ICommandService),a=v.useDependency(v.ILayoutService),{unitId:r}=i,c=n.getRenderById(r).with(T.DocSelectionRenderService),[l,A]=U.useState({}),d=(g,h)=>{var O;A(M=>({...M,[h]:g?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}));const p=e.getUniverDocInstance(r),f=p==null?void 0:p.getSnapshot().documentStyle,S=(O=n.getRenderById(r))==null?void 0:O.with(D.DocSkeletonManagerService),E=S==null?void 0:S.getViewModel();if(f==null||E==null)return;const C=E.getEditArea();let b=!1;const R=c.getSegmentPage();let I=!1;if(h==="useFirstPageHeaderFooter"&&g===!0&&((C===_.DocumentEditArea.HEADER&&!f.firstPageHeaderId||C===_.DocumentEditArea.FOOTER&&!f.firstPageFooterId)&&(b=!0),b&&R===0&&(I=!0)),h==="evenAndOddHeaders"&&g===!0&&((C===_.DocumentEditArea.HEADER&&!f.evenPageHeaderId||C===_.DocumentEditArea.FOOTER&&!f.evenPageFooterId)&&(b=!0),b&&R%2===1&&(I=!0)),b){const y=s.Tools.generateRandomId(6);I&&c.setSegment(y),o.executeCommand(Gt,{unitId:r,segmentId:y,headerFooterProps:{[h]:g?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}})}else{const M=c.getSegmentPage(),y=c.getSegment(),N=mr({...f,[h]:g?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE},C,M);N&&N!==y&&c.setSegment(N),o.executeCommand(Gt,{unitId:r,headerFooterProps:{[h]:g?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE}})}a.focus()},u=async(g,h)=>{A(p=>({...p,[h]:g})),await o.executeCommand(Gt,{unitId:r,headerFooterProps:{[h]:g}}),c.removeAllRanges(),c.blur()},m=()=>{o.executeCommand($n.id,{unitId:r})};return U.useEffect(()=>{const g=e.getUniverDocInstance(r),h=g==null?void 0:g.getSnapshot().documentStyle;if(h){const{marginHeader:p=0,marginFooter:f=0,useFirstPageHeaderFooter:S=s.BooleanNumber.FALSE,evenAndOddHeaders:E=s.BooleanNumber.FALSE}=h;A({marginHeader:p,marginFooter:f,useFirstPageHeaderFooter:S,evenAndOddHeaders:E})}},[r]),P.jsxs("div",{className:"univer-grid univer-gap-4",children:[P.jsxs("div",{className:"univer-grid univer-gap-2",children:[P.jsx("div",{children:P.jsx(J.Checkbox,{checked:l.useFirstPageHeaderFooter===s.BooleanNumber.TRUE,onChange:g=>{d(g,"useFirstPageHeaderFooter")},children:t.t("headerFooter.firstPageCheckBox")})}),P.jsx("div",{children:P.jsx(J.Checkbox,{checked:l.evenAndOddHeaders===s.BooleanNumber.TRUE,onChange:g=>{d(g,"evenAndOddHeaders")},children:t.t("headerFooter.oddEvenCheckBox")})})]}),P.jsxs("div",{className:"univer-mb-1 univer-flex",children:[P.jsxs("div",{children:[P.jsx("span",{children:t.t("headerFooter.headerTopMargin")}),P.jsx(J.InputNumber,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginHeader,onChange:g=>{u(g,"marginHeader")}})]}),P.jsxs("div",{children:[P.jsx("span",{children:t.t("headerFooter.footerBottomMargin")}),P.jsx(J.InputNumber,{className:"univer-mt-1.5 univer-w-4/5",min:0,max:200,precision:1,value:l.marginFooter,onChange:g=>{u(g,"marginFooter")}})]})]}),P.jsx("div",{className:"univer-flex univer-justify-end",children:P.jsx(J.Button,{onClick:m,children:t.t("headerFooter.closeHeaderFooter")})})]})},fr=()=>{var A;const i=v.useDependency(s.LocaleService),t=v.useDependency(_.IRenderManagerService),o=v.useDependency(s.IUniverInstanceService).getCurrentUniverDocInstance().getUnitId(),r=((A=t.getRenderById(o))==null?void 0:A.with(D.DocSkeletonManagerService)).getViewModel(),[c,l]=U.useState(!0);return U.useEffect(()=>{const d=r.getEditArea();l(d!==_.DocumentEditArea.BODY);const u=r.editAreaChange$.subscribe(m=>{m!=null&&l(m!==_.DocumentEditArea.BODY)});return()=>{u.unsubscribe()}},[]),P.jsx("div",{className:"univer-text-sm",children:c?P.jsx(pr,{unitId:o}):P.jsx("div",{className:"univer-text-gray-400",children:i.t("headerFooter.disableText")})})},zo=18,Go=200,Kn=6,Sr=4;function vr(i,t){let{radius:e,width:n,height:o}=t;e=e!=null?e:0,n=n!=null?n:30,o=o!=null?o:30;let a=0;a=Math.min(e,n/2,o/2),i.beginPath(),i.moveTo(0,0),i.lineTo(n,0),i.lineTo(n,o-a),i.arc(n-a,o-a,a,0,Math.PI/2,!1),i.lineTo(0,o),i.lineTo(0,0),i.closePath(),t.fill&&(i.save(),i.fillStyle=t.fill,t.fillRule==="evenodd"?i.fill("evenodd"):i.fill(),i.restore())}class zt extends _.Shape{constructor(e,n){super(e,n);B(this,"color");B(this,"text");this.color=n==null?void 0:n.color,this.text=n==null?void 0:n.text}static drawWith(e,n){const{text:o,color:a}=n;e.save(),e.font="13px Source Han Sans CN";const r=e.measureText(o).width,c=Math.min(r+2*Kn,Go);vr(e,{height:zo,width:c,radius:4,fill:a}),e.fillStyle="rgba(58, 96, 247, 1)";const l=Kn,A=zo-Sr,d=Go-2*Kn;if(r>d){let u="",m=0;for(const g of o){const h=e.measureText(g).width;if(m+h<=d-e.measureText("...").width)u+=g,m+=h;else{u+="...";break}}e.fillText(u,l,A)}else e.fillText(o,l,A);e.restore()}_draw(e){zt.drawWith(e,this)}}var Ir=Object.getOwnPropertyDescriptor,Er=(i,t,e,n)=>{for(var o=n>1?void 0:n?Ir(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Me=(i,t)=>(e,n)=>t(e,n,i);const jo="rgba(58, 96, 247, 1)",Xo="rgba(58, 96, 247, 0.08)";var se=(i=>(i[i.FIRST_PAGE_HEADER=0]="FIRST_PAGE_HEADER",i[i.FIRST_PAGE_FOOTER=1]="FIRST_PAGE_FOOTER",i[i.DEFAULT_HEADER=2]="DEFAULT_HEADER",i[i.DEFAULT_FOOTER=3]="DEFAULT_FOOTER",i[i.EVEN_PAGE_HEADER=4]="EVEN_PAGE_HEADER",i[i.EVEN_PAGE_FOOTER=5]="EVEN_PAGE_FOOTER",i))(se||{});function Cr(i,t,e){const{documentStyle:n}=i.getDataModel().getSnapshot(),{defaultHeaderId:o,defaultFooterId:a,evenPageHeaderId:r,evenPageFooterId:c,firstPageHeaderId:l,firstPageFooterId:A,evenAndOddHeaders:d,useFirstPageHeaderFooter:u}=n;switch(t){case _.DocumentEditArea.BODY:return{createType:null,headerFooterId:null};case _.DocumentEditArea.HEADER:return u===s.BooleanNumber.TRUE&&!l?{createType:0,headerFooterId:null}:d===s.BooleanNumber.TRUE&&e%2===0&&!r?{createType:4,headerFooterId:null}:o?{createType:null,headerFooterId:o}:{createType:2,headerFooterId:null};case _.DocumentEditArea.FOOTER:return u===s.BooleanNumber.TRUE&&!A?{createType:1,headerFooterId:null}:d===s.BooleanNumber.TRUE&&e%2===0&&!c?{createType:5,headerFooterId:null}:a?{createType:null,headerFooterId:a}:{createType:3,headerFooterId:null};default:throw new Error(`Invalid editArea: ${t}`)}}let Yn=class extends s.Disposable{constructor(t,e,n,o,a,r,c,l,A){super();B(this,"_loadedMap",new WeakSet);this._context=t,this._commandService=e,this._editorService=n,this._instanceSrv=o,this._renderManagerService=a,this._docSkeletonManagerService=r,this._docSelectionRenderService=c,this._localeService=l,this._componentManager=A,this._initialize()}_initialize(){this._init(),this._drawHeaderFooterLabel(),this._initCustomComponents(),this._listenSwitchMode()}_listenSwitchMode(){this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(D.RichTextEditingMutation.id===t.id){const e=this._context.unit,o=this._docSkeletonManagerService.getViewModel().getEditArea(),a=e.getSnapshot().documentStyle.documentFlavor;o!==_.DocumentEditArea.BODY&&a===s.DocumentFlavor.MODERN&&this._commandService.executeCommand($n.id,{unitId:this._context.unitId})}}))}_initCustomComponents(){this._componentManager.get(Xn)||this.disposeWithMe(this._componentManager.register(Xn,fr))}_init(){const{unitId:t}=this._context,e=ve(this._context);e==null||e.document==null||this._loadedMap.has(e.document)||(this._initialMain(t),this._loadedMap.add(e.document))}_initialMain(t){const e=ve(this._context),{document:n}=e;this.disposeWithMe(n.onDblclick$.subscribeEvent(async o=>{if(this._isEditorReadOnly(t)||!this._isTraditionalMode())return;const{offsetX:a,offsetY:r}=o,{pageLayoutType:c=_.PageLayoutType.VERTICAL,pageMarginLeft:l,pageMarginTop:A}=n.getOffsetConfig(),d=this._getTransformCoordForDocumentOffset(a,r);if(d==null)return;const u=this._docSkeletonManagerService.getViewModel(),m=this._docSkeletonManagerService.getSkeleton(),g=u.getEditArea(),{editArea:h,pageNumber:p}=m.findEditAreaByCoord(d,c,l,A);if(g===h)return;u.setEditArea(h);const{createType:f,headerFooterId:S}=Cr(u,h,p);if(h===_.DocumentEditArea.BODY)this._docSelectionRenderService.setSegment(""),this._docSelectionRenderService.setSegmentPage(-1),this._docSelectionRenderService.setCursorManually(a,r);else if(f!=null){const C=s.Tools.generateRandomId(6);this._docSelectionRenderService.setSegment(C),this._docSelectionRenderService.setSegmentPage(p),await this._commandService.executeCommand(Yo.id,{unitId:t,createType:f,segmentId:C})}else S!=null&&(this._docSelectionRenderService.setSegment(S),this._docSelectionRenderService.setSegmentPage(p),this._docSelectionRenderService.setCursorManually(a,r))}))}_getTransformCoordForDocumentOffset(t,e){const n=ve(this._context),{document:o,scene:a}=n,{documentTransform:r}=o.getOffsetConfig(),c=a.getViewports()[0];if(c==null)return;const l=c.transformVector2SceneCoord(_.Vector2.FromArray([t,e]));return r.clone().invert().applyPoint(l)}_drawHeaderFooterLabel(){const t=this._localeService;this._instanceSrv.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC).subscribe(e=>{if(e==null)return;const n=e.getUnitId(),o=this._renderManagerService.getRenderById(n);if(this._editorService.isEditor(n)||this._instanceSrv.getUniverDocInstance(n)==null||o==null)return;const{mainComponent:a}=o,r=a;this.disposeWithMe(s.toDisposable(r.pageRender$.subscribe(c=>{if(this._editorService.isEditor(n)||!this._isTraditionalMode())return;const d=this._docSkeletonManagerService.getViewModel().getEditArea()===_.DocumentEditArea.BODY,{page:u,pageLeft:m,pageTop:g,ctx:h}=c,{pageWidth:p,pageHeight:f,marginTop:S,marginBottom:E}=u;if(h.save(),h.translate(m-.5,g-.5),d?(_.Rect.drawWith(h,{left:0,top:0,width:p,height:S,fill:"rgba(255, 255, 255, 0.5)"}),h.save(),h.translate(0,f-E),_.Rect.drawWith(h,{left:0,top:0,width:p,height:E,fill:"rgba(255, 255, 255, 0.5)"}),h.restore()):(h.save(),h.translate(0,S),_.Rect.drawWith(h,{left:0,top:S,width:p,height:f-S-E,fill:"rgba(255, 255, 255, 0.5)"}),h.restore()),!d){const C={dataArray:[{command:"M",points:[0,S]},{command:"L",points:[p,S]}],strokeWidth:1,stroke:jo},b={dataArray:[{command:"M",points:[0,f-E]},{command:"L",points:[p,f-E]}],strokeWidth:1,stroke:jo};_.Path.drawWith(h,C),_.Path.drawWith(h,b),h.translate(0,S+1),zt.drawWith(h,{text:t.t("headerFooter.header"),color:Xo}),h.translate(0,f-S-E),zt.drawWith(h,{text:t.t("headerFooter.footer"),color:Xo})}h.restore()})))})}_isEditorReadOnly(t){const e=this._editorService.getEditor(t);return e?e.isReadOnly():!1}_isTraditionalMode(){return this._context.unit.getSnapshot().documentStyle.documentFlavor===s.DocumentFlavor.TRADITIONAL}};Yn=Er([Me(1,s.ICommandService),Me(2,ce),Me(3,s.IUniverInstanceService),Me(4,_.IRenderManagerService),Me(5,s.Inject(D.DocSkeletonManagerService)),Me(6,s.Inject(T.DocSelectionRenderService)),Me(7,s.Inject(s.LocaleService)),Me(8,s.Inject(v.ComponentManager))],Yn);const qn={id:"sidebar.operation.doc-header-footer-panel",type:s.CommandType.OPERATION,handler:async(i,t)=>{const e=i.get(v.ISidebarService),n=i.get(s.LocaleService);switch(t.value){case"open":e.open({header:{title:n.t("headerFooter.panel")},children:{label:Xn},onClose:()=>{},width:400});break;case"close":default:e.close();break}return!0}};function Ko(){return{dataStream:`\r
`,textRuns:[{st:0,ed:0,ts:{fs:9}}],customBlocks:[],paragraphs:[{startIndex:0,paragraphStyle:{spaceAbove:{v:0},lineSpacing:1.5,spaceBelow:{v:0}}}],sectionBreaks:[{startIndex:1}]}}function Jn(i,t,e,n){const o=s.JSONX.getInstance(),a=6,r=i!=null?i:s.Tools.generateRandomId(a),c=t===se.DEFAULT_HEADER||t===se.FIRST_PAGE_HEADER||t===se.EVEN_PAGE_HEADER,l=o.insertOp([c?"headers":"footers",r],{[c?"headerId":"footerId"]:r,body:Ko()});n.push(l);const A=s.Tools.generateRandomId(a),d=o.insertOp([c?"footers":"headers",A],{[c?"footerId":"headerId"]:A,body:Ko()});n.push(d);let u="defaultHeaderId",m="defaultFooterId";switch(t){case se.DEFAULT_HEADER:u="defaultHeaderId",m="defaultFooterId";break;case se.DEFAULT_FOOTER:u="defaultFooterId",m="defaultHeaderId";break;case se.FIRST_PAGE_HEADER:u="firstPageHeaderId",m="firstPageFooterId";break;case se.FIRST_PAGE_FOOTER:u="firstPageFooterId",m="firstPageHeaderId";break;case se.EVEN_PAGE_HEADER:u="evenPageHeaderId",m="evenPageFooterId";break;case se.EVEN_PAGE_FOOTER:u="evenPageFooterId",m="evenPageHeaderId";break;default:throw new Error(`Unknown header footer type: ${t}`)}for(const[g,h]of[[u,r],[m,A]])if(e[g]!=null){const p=o.replaceOp(["documentStyle",g],e[g],h);n.push(p)}else{const p=o.insertOp(["documentStyle",g],h);n.push(p)}return n}const Gt="doc.command.core-header-footer",Yo={id:Gt,type:s.CommandType.COMMAND,handler:async(i,t)=>{var b;const e=i.get(s.ICommandService),n=i.get(s.IUniverInstanceService),o=i.get(_.IRenderManagerService),{unitId:a,segmentId:r,createType:c,headerFooterProps:l}=t,A=(b=o.getRenderById(a))==null?void 0:b.with(D.DocSkeletonManagerService),d=n.getUniverDocInstance(a),u=A==null?void 0:A.getViewModel();if(d==null||u==null)return!1;const m=u.getEditArea(),{documentStyle:g}=d.getSnapshot(),h=(l==null?void 0:l.marginFooter)!=null||(l==null?void 0:l.marginHeader)!=null,p=[{startOffset:0,endOffset:0,collapsed:!0}],f={id:D.RichTextEditingMutation.id,params:{unitId:a,actions:[],textRanges:p,debounce:!0}};h&&(f.params.noNeedSetTextRange=!0);const S=s.JSONX.getInstance(),E=[];return c!=null&&Jn(r,c,g,E),l!=null&&Object.keys(l).forEach(R=>{const I=l[R],O=g[R];if(I===O)return;let M;if(O===void 0?M=S.insertOp(["documentStyle",R],I):M=S.replaceOp(["documentStyle",R],O,I),E.push(M),R==="useFirstPageHeaderFooter"&&I===s.BooleanNumber.TRUE&&!g.firstPageHeaderId){const y=m===_.DocumentEditArea.HEADER?se.FIRST_PAGE_HEADER:se.FIRST_PAGE_FOOTER;Jn(r,y,g,E)}else if(R==="evenAndOddHeaders"&&I===s.BooleanNumber.TRUE&&!g.evenPageHeaderId){const y=m===_.DocumentEditArea.HEADER?se.EVEN_PAGE_HEADER:se.EVEN_PAGE_FOOTER;Jn(r,y,g,E)}}),E.length===0?!1:(f.params.actions=E.reduce((R,I)=>s.JSONX.compose(R,I),null),!!e.syncExecuteCommand(f.id,f.params))}},Zn={id:"doc.command.open-header-footer-panel",type:s.CommandType.COMMAND,handler:async(i,t)=>i.get(s.ICommandService).executeCommand(qn.id,{value:"open"})},$n={id:"doc.command.close-header-footer",type:s.CommandType.COMMAND,handler:async(i,t)=>{var h;const e=i.get(s.ICommandService),n=i.get(_.IRenderManagerService),o=i.get(D.DocSelectionManagerService),a=i.get(s.IUniverInstanceService),{unitId:r}=t,c=n.getRenderById(r);if(c==null)return!1;const{scene:l}=c,A=l.getTransformerByCreate(),d=c.with(D.DocSkeletonManagerService),u=c.with(T.DocSelectionRenderService),m=d==null?void 0:d.getSkeleton(),g=d==null?void 0:d.getViewModel();return g==null||m==null?!1:(o.replaceDocRanges([]),A.clearSelectedObjects(),u.setSegment(""),u.setSegmentPage(-1),g.setEditArea(_.DocumentEditArea.BODY),m.calculate(),(h=c.mainComponent)==null||h.makeDirty(!0),queueMicrotask(()=>{const p=a.getUnit(r),f=p==null?void 0:p.getSnapshot();if(f==null)return;const S=Wo(f);o.replaceDocRanges([{startOffset:S,endOffset:S}])}),e.executeCommand(qn.id,{value:"close"}),!0)}},Je="UI_PLUGIN_DOCS",ei=`${Je}_COLOR_PICKER_COMPONENT`,qo=`${Je}_FONT_FAMILY_COMPONENT`,Jo=`${Je}_FONT_FAMILY_ITEM_COMPONENT`,Zo=`${Je}_FONT_SIZE_COMPONENT`,$o=i=>{const{value:t,onChange:e,options:n}=i;return P.jsx("div",{className:"univer-grid univer-grid-cols-3 univer-gap-2 univer-p-1.5",children:n.map(o=>P.jsx("a",{className:J.clsx("univer-block univer-h-20 univer-w-[72px] univer-cursor-pointer univer-overflow-hidden univer-rounded univer-transition-all hover:univer-border-primary-500",J.borderClassName,{"univer-border-primary-500":t===o.value}),onClick:()=>{e(o.value)},children:P.jsx("img",{className:"univer-size-full",src:o.img,draggable:!1})},o.value))})},Tr=[{value:s.PresetListType.ORDER_LIST,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_1,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_2,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_3,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_4,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.ORDER_LIST_5,img:"data:image/jpeg;base64,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"}],yr=i=>P.jsx($o,{...i,options:Tr}),br=[{value:s.PresetListType.BULLET_LIST,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_1,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_2,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_3,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_4,img:"data:image/jpeg;base64,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"},{value:s.PresetListType.BULLET_LIST_5,img:"data:image/jpeg;base64,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"}],Or=i=>P.jsx($o,{...i,options:br}),es=`${Je}_ORDER_LIST_TYPE_COMPONENT`,ts=`${Je}_BULLET_LIST_TYPE_COMPONENT`;var jt=(i=>(i[i.ABOVE=0]="ABOVE",i[i.BELLOW=1]="BELLOW",i))(jt||{}),ti=(i=>(i[i.LEFT=0]="LEFT",i[i.RIGHT=1]="RIGHT",i))(ti||{});function Rr(i,t){let e=s.DataStreamTreeTokenType.TABLE_START;const n=[],o=[];for(let a=0;a<i;a++){e+=s.DataStreamTreeTokenType.TABLE_ROW_START;for(let r=0;r<t;r++)e+=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,n.push({startIndex:e.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),o.push({startIndex:e.length-2});e+=s.DataStreamTreeTokenType.TABLE_ROW_END}return e+=s.DataStreamTreeTokenType.TABLE_END,{dataStream:e,paragraphs:n,sectionBreaks:o}}function Xt(){return{margin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}}}}function Kt(i){const t=Xt();return{tableCells:[...new Array(i).fill(null).map(()=>s.Tools.deepClone(t))],trHeight:{val:{v:30},hRule:s.TableRowHeightRule.AUTO}}}function Yt(i){return{size:{type:s.TableSizeType.SPECIFIED,width:{v:i}}}}function ni(i,t,e){const n=Yt(e/t),o=Kt(t),a=[...new Array(i).fill(null).map(()=>s.Tools.deepClone(o))],r=[...new Array(t).fill(null).map(()=>s.Tools.deepClone(n))],c=s.generateRandomId(6);return{tableRows:a,tableColumns:r,tableId:c,align:s.TableAlignmentType.START,indent:{v:0},textWrap:s.TableTextWrapType.NONE,position:{positionH:{relativeFrom:s.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.PAGE,posOffset:0}},dist:{distB:0,distL:0,distR:0,distT:0},cellMargin:{start:{v:10},end:{v:10},top:{v:5},bottom:{v:5}},size:{type:s.TableSizeType.UNSPECIFIED,width:{v:e}}}}function ht(i,t){if(!i&&!t)return null;if(t&&t.length>0){let e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;const o="";for(const a of t){const{startOffset:r,endOffset:c,segmentId:l}=a;r==null||c==null||l==null||(e=Math.min(e,r),n=Math.max(n,c))}if(Number.isFinite(e)&&Number.isFinite(n))return{startOffset:e,endOffset:n,segmentId:o}}else if(i){const{startOffset:e,endOffset:n,segmentId:o}=i;return e==null||n==null||o==null?null:{startOffset:e,endOffset:n,segmentId:o}}}function Mr(i){let t=s.DataStreamTreeTokenType.TABLE_ROW_START;const e=[],n=[];for(let o=0;o<i;o++)t+=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,e.push({startIndex:t.length-3,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),n.push({startIndex:t.length-2});return t+=s.DataStreamTreeTokenType.TABLE_ROW_END,{dataStream:t,paragraphs:e,sectionBreaks:n}}function xr(){const i=`${s.DataStreamTreeTokenType.TABLE_CELL_START}\r
${s.DataStreamTreeTokenType.TABLE_CELL_END}`,t=[],e=[];return t.push({startIndex:1,paragraphStyle:{spaceAbove:{v:3},lineSpacing:2,spaceBelow:{v:0}}}),e.push({startIndex:2}),{dataStream:i,paragraphs:t,sectionBreaks:e}}function Dr(i,t,e){var u,m,g;const{startOffset:n,endOffset:o,segmentId:a}=i,r=e.getSelfOrHeaderFooterViewModel(a),c=t===0?n:o;let l=null;const A=(g=(m=(u=e.getBody())==null?void 0:u.tables)==null?void 0:m.find(h=>c>=h.startIndex&&c<=h.endIndex))==null?void 0:g.tableId;let d=0;for(const h of r.getChildren()){for(const p of h.children){const{children:f}=p,S=f[0];if(S){for(const E of S.children)if(E.startIndex<=c&&c<=E.endIndex){d=S.children.indexOf(E),l=E;break}}if(l)break}if(l)break}return l==null||A==null?null:{offset:t===0?l.startIndex:l.endIndex+1,colCount:l.children.length,tableId:A,insertRowIndex:t===0?d:d+1}}function Br(i,t,e){var g,h,p;const{startOffset:n,endOffset:o,segmentId:a}=i,r=e.getSelfOrHeaderFooterViewModel(a),c=t===0?n:o,l=(p=(h=(g=e.getBody())==null?void 0:g.tables)==null?void 0:h.find(f=>c>=f.startIndex&&c<=f.endIndex))==null?void 0:p.tableId,A=[];let d=null,u=-1;for(const f of r.getChildren()){for(const S of f.children){const{children:E}=S,C=E[0];if(C){if(c<C.startIndex||c>C.endIndex)continue;d=C;for(const b of C.children){for(const R of b.children){const I=b.children.indexOf(R);if(c>=R.startIndex&&c<=R.endIndex){u=I;break}}if(u!==-1)break}}if(d)break}if(d)break}if(d==null||l==null||u===-1)return null;let m=0;for(const f of d.children){const S=f.children[u],E=t===0?S.startIndex:S.endIndex+1;A.push(E-m),m=E}return{offsets:A,tableId:l,columnIndex:u,rowCount:d.children.length}}function _r(i,t,e){const n=[];let o=t[e].size.width.v,a=0;for(let r=0;r<t.length;r++)a+=t[r].size.width.v;a+=o;for(let r=0;r<t.length;r++)n.push(t[r].size.width.v/a*i);return o=o/a*i,{widths:n,newColWidth:o}}function ns(i,t){var m,g,h;const{startOffset:e,endOffset:n,segmentId:o}=i,a=t.getSelfOrHeaderFooterViewModel(o),r=(h=(g=(m=t.getBody())==null?void 0:m.tables)==null?void 0:g.find(p=>e>=p.startIndex&&n<=p.endIndex))==null?void 0:h.tableId,c=[];let l=-1,A=0,d=-1,u=!1;for(const p of a.getChildren()){for(const f of p.children){const{children:S}=f,E=S[0];if(E){if(e<E.startIndex||n>E.endIndex)continue;d=E.startIndex+3;for(const C of E.children){const b=E.children.indexOf(C),{startIndex:R,endIndex:I}=C;e>=R&&e<=I?(l=R,c.push(b),A+=I-R+1):(R>e&&I<n||n>=R&&n<=I)&&(c.push(b),A+=I-R+1),c.length===E.children.length&&(u=!0)}}if(c.length)break}if(c.length)break}return r==null||c.length===0?null:{tableId:r,rowIndexes:c,offset:l,len:A,cursor:d,selectWholeTable:u}}function Nr(i,t){var h,p,f;const{startOffset:e,endOffset:n,segmentId:o}=i,a=t.getSelfOrHeaderFooterViewModel(o),r=(f=(p=(h=t.getBody())==null?void 0:h.tables)==null?void 0:p.find(S=>e>=S.startIndex&&n<=S.endIndex))==null?void 0:f.tableId,c=[];let l=null;const A=[];let d=-1,u=-1,m=-1;for(const S of a.getChildren()){for(const E of S.children){const{children:C}=E,b=C[0];if(b){if(e<b.startIndex||n>b.endIndex)continue;l=b;for(const R of b.children)for(const I of R.children){const O=R.children.indexOf(I);e>=I.startIndex&&e<=I.endIndex&&(u=O),n>=I.startIndex&&n<=I.endIndex&&(m=O)}}if(l)break}if(l)break}if(l==null||r==null)return null;for(let S=u;S<=m;S++)A.push(S);let g=0;for(const S of l.children){const E=S.children[u],C=S.children[m];c.push({retain:E.startIndex-g,delete:C.endIndex-E.startIndex+1}),g=C.endIndex+1}return d=l.startIndex+3,{offsets:c,tableId:r,columnIndexes:A,cursor:d,selectWholeTable:A.length===l.children[0].children.length,rowCount:l.children.length}}function is(i,t){var d,u,m;const{startOffset:e,endOffset:n,segmentId:o}=i,a=t.getSelfOrHeaderFooterViewModel(o),r=(m=(u=(d=t.getBody())==null?void 0:d.tables)==null?void 0:u.find(g=>e>=g.startIndex&&n<=g.endIndex))==null?void 0:m.tableId;let c=-1,l=0,A=-1;for(const g of a.getChildren()){for(const h of g.children){const{children:p}=h,f=p[0];if(f){if(e<f.startIndex||n>f.endIndex)continue;c=f.startIndex,l=f.endIndex-f.startIndex+1,A=f.startIndex}if(f)break}if(l>0)break}return r==null?null:{tableId:r,offset:c,len:l,cursor:A}}function Pr(i,t){var h,p,f;const{startOffset:e,endOffset:n,segmentId:o}=i,a=t.getSelfOrHeaderFooterViewModel(o),r=(f=(p=(h=t.getBody())==null?void 0:h.tables)==null?void 0:p.find(S=>e>=S.startIndex&&n<=S.endIndex))==null?void 0:f.tableId,c=[];let l=null,A=-1,d=-1,u=-1,m=-1;for(const S of a.getChildren()){for(const E of S.children){const{children:C}=E,b=C[0];if(b){if(e<b.startIndex||n>b.endIndex)continue;l=b;for(const R of b.children){const I=b.children.indexOf(R);for(const O of R.children){const M=R.children.indexOf(O);e>=O.startIndex&&e<=O.endIndex&&(d=I,u=M),n>=O.startIndex&&n<=O.endIndex&&(m=M)}}}if(l)break}if(l)break}if(l==null||r==null||d===-1)return null;const g=l.children[d];for(let S=u;S<=m;S++){const E=g.children[S];c.push({retain:E.startIndex+1,delete:E.endIndex-E.startIndex-3})}return A=l.startIndex+3,{offsets:c,tableId:r,cursor:A,rowCount:l.children.length}}var ii=(i=>(i[i.NEXT=0]="NEXT",i[i.PREV=1]="PREV",i))(ii||{});function os(i,t,e){const{startOffset:n}=t;let o=null;for(const A of i.getChildren()){for(const d of A.children){const u=d.children[0];if(u&&n>u.startIndex&&n<u.endIndex){o=u;break}}if(o)break}if(o==null)return null;let a=-1,r=-1,c=null;for(const A of o.children){for(const d of A.children)if(n>d.startIndex&&n<d.endIndex){a=A.children.indexOf(d),r=o.children.indexOf(A),c=A;break}if(a>-1)break}if(a===-1||r===-1||c==null)return null;let l=null;if(e===0){if(l=c.children[a+1],!l){const A=o.children[r+1];A&&(l=A.children[0])}}else if(l=c.children[a-1],!l){const A=o.children[r-1];A&&(l=A.children[A.children.length-1])}if(l){const{startIndex:A,endIndex:d}=l;return{startOffset:A+1,endOffset:d-2}}}function ss(i,t){const e=[],{customBlocks:n=[]}=i;for(const o of t){const{startOffset:a,endOffset:r}=o;if(!(a==null||r==null))for(const c of n){const{startIndex:l}=c;l>=a&&l<r&&e.push(c.blockId)}}return e}function Ur(i){return i.some(t=>{const{startNodePosition:e}=t;return e?(e==null?void 0:e.path.indexOf("cells"))>-1:!1})}const wr=s.SHEET_EDITOR_UNITS,oi={id:"doc.command.inner-paste",type:s.CommandType.COMMAND,handler:async(i,t)=>{var y,N,x,w,H,V;const{segmentId:e,textRanges:n,doc:o}=t,a=i.get(s.ICommandService),r=i.get(D.DocSelectionManagerService),c=i.get(s.IUniverInstanceService),l=r.getTextRanges(),A=r.getRectRanges(),{body:d,tableSource:u,drawings:m}=o;if(!Array.isArray(l)||l.length===0||d==null)return!1;const g=c.getCurrentUniverDocInstance(),h=g==null?void 0:g.getSelfOrHeaderFooterModel(e).getBody();if(g==null||h==null)return!1;const p=g.getUnitId(),f={id:D.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:n,segmentId:e}},S=new s.MemoryCursor;S.reset();const E=new s.TextX,C=s.JSONX.getInstance(),b=[],R=!!((y=d.tables)!=null&&y.length),I=!!((N=d.customBlocks)!=null&&N.length);if(R&&e||R&&Ur(l)||l.length&&(A!=null&&A.length))return!1;for(let F=0;F<l.length;F++){const Q=l[F],{startOffset:j,endOffset:G,collapsed:k}=Q,W=j-S.cursor,z=s.Tools.deepClone(d);if(R)for(const q of z.tables){const{tableId:K}=q,$=s.Tools.generateRandomId(6);q.tableId=$;const ie=s.Tools.deepClone(u[K]);ie.tableId=$;const fe=C.insertOp(["tableSource",$],ie);b.push(fe)}if(I&&m){const q=(w=(x=g.getSnapshot().drawingsOrder)==null?void 0:x.length)!=null?w:0;for(const K of z.customBlocks){const{blockId:$}=K,ie=s.Tools.generateRandomId(6);K.blockId=ie;const fe=s.Tools.deepClone(m[$]);fe.drawingId=ie;const Fe=C.insertOp(["drawings",ie],fe),Se=C.insertOp(["drawingsOrder",q],ie);b.push(Fe),b.push(Se)}}const X=_n((H=h.customRanges)!=null?H:[],G,wr.includes(p)),Y=Nn((V=h.customDecorations)!=null?V:[],G);if(X&&(z.customRanges=[{...X,startIndex:0,endIndex:d.dataStream.length-1}]),Y.length&&(z.customDecorations=Y.map(q=>({...q,startIndex:0,endIndex:d.dataStream.length-1}))),k)E.push({t:s.TextXActionType.RETAIN,len:W}),E.push({t:s.TextXActionType.INSERT,body:z,len:d.dataStream.length});else{const q=s.BuildTextUtils.selection.delete([Q],d,S.cursor,z,l.length===1);E.push(...q)}S.reset(),S.moveCursor(G)}const O=Z(g,e);return b.push(C.editOp(E.serialize(),O)),f.params.actions=b.reduce((F,Q)=>s.JSONX.compose(F,Q),null),!!a.syncExecuteCommand(f.id,f.params)}};function Lr(i,t){const{startOffset:e,endOffset:n}=i,o=t.some(r=>r.startIndex===n),a=Math.max(e,o?n-1:n);return{...i,endOffset:a,collapsed:e===a}}function Qr(i,t,e){var h,p;const n=t.getSelfOrHeaderFooterModel(e).getBody(),o=new s.TextX,a=s.JSONX.getInstance(),r=[];if(n==null)return r;const{tables:c=[]}=n,l=new s.MemoryCursor;l.reset();for(let f=0;f<i.length;f++){const S=Lr(i[f],c),{startOffset:E,endOffset:C,collapsed:b}=S,R=E-l.cursor;b?o.push({t:s.TextXActionType.RETAIN,len:R}):o.push(...s.BuildTextUtils.selection.delete([S],n,l.cursor,null,!1)),l.reset(),l.moveCursor(C)}const A=Z(t,e);r.push(a.editOp(o.serialize(),A));const d=ss(n,i),u=(h=t.getDrawings())!=null?h:{},m=(p=t.getDrawingsOrder())!=null?p:[],g=d.sort((f,S)=>m.indexOf(f)>m.indexOf(S)?-1:m.indexOf(f)<m.indexOf(S)?1:0);if(g.length>0)for(const f of g){const S=u[f],E=m.indexOf(f);if(S==null||E<0)continue;const C=a.removeOp(["drawings",f],S),b=a.removeOp(["drawingsOrder",E],f);r.push(C),r.push(b)}return r.reduce((f,S)=>s.JSONX.compose(f,S),null)}function Fr(i,t,e,n){const o=[];if(t.getSelfOrHeaderFooterModel(n).getBody()==null)return o;const r=new s.TextX,c=s.JSONX.getInstance(),l=new s.MemoryCursor;l.reset();for(const d of i){const{startOffset:u,endOffset:m,spanEntireRow:g,spanEntireTable:h}=d;if(!(u==null||m==null))if(h){const p=is({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offset:f,len:S,tableId:E}=p;f-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:f-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:S});const C=c.removeOp(["tableSource",E]);o.push(C),l.moveCursorTo(f+S)}else if(g){const p=ns({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offset:f,rowIndexes:S,len:E,tableId:C}=p;f-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:f-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:E});for(const b of S.reverse()){const R=c.removeOp(["tableSource",C,"tableRows",b]);o.push(R)}l.moveCursorTo(f+E)}else{const p=Pr({startOffset:u,endOffset:m,segmentId:n},e);if(p==null)continue;const{offsets:f}=p;for(const S of f){const{retain:E,delete:C}=S;E-l.cursor>0&&r.push({t:s.TextXActionType.RETAIN,len:E-l.cursor}),r.push({t:s.TextXActionType.DELETE,len:C}),l.moveCursorTo(E+C)}}}const A=Z(t,n);return o.push(c.editOp(r.serialize(),A)),o.reduce((d,u)=>s.JSONX.compose(d,u),null)}function as(i,t,e,n,o){let a=[];if(Array.isArray(i)&&(i==null?void 0:i.length)!==0&&(a=Qr(i,e,o)),Array.isArray(t)&&(t==null?void 0:t.length)!==0){const r=Fr(t,e,n,o);a==null||a.length===0?a=r:a=s.JSONX.compose(a,s.JSONX.transform(r,a,"right"))}return a}const Ve={id:"doc.command.inner-cut",type:s.CommandType.COMMAND,handler:(i,t)=>{var p;const e=i.get(D.DocSelectionManagerService),n=i.get(s.ICommandService),o=i.get(s.IUniverInstanceService),{segmentId:a,textRanges:r,selections:c=e.getTextRanges(),rectRanges:l=e.getRectRanges()}=t;if((!Array.isArray(c)||c.length===0)&&(!Array.isArray(l)||l.length===0))return!1;const A=(p=o.getCurrentUniverDocInstance())==null?void 0:p.getUnitId();if(!A)return!1;const d=o.getUniverDocInstance(A);if(d==null)return!1;const u=re(i,A);if(u==null)return!1;const m=u.getViewModel(),g={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:r}};return g.params.actions=as(c,l,d,m,a),!!n.syncExecuteCommand(g.id,g.params)}};var oe=(i=>(i[i.LEFT=0]="LEFT",i[i.RIGHT=1]="RIGHT",i))(oe||{});const rs="doc.command.insert-text",si={id:rs,type:s.CommandType.COMMAND,handler:async(i,t)=>{var I;const e=i.get(s.ICommandService),{range:n,segmentId:o,body:a,unitId:r,cursorOffset:c}=t,l=i.get(D.DocSelectionManagerService),d=i.get(s.IUniverInstanceService).getUnit(r,s.UniverInstanceType.UNIVER_DOC);if(d==null)return!1;const u=l.getActiveTextRange(),m=d.getSelfOrHeaderFooterModel((I=u==null?void 0:u.segmentId)!=null?I:"").getBody();if(m==null)return!1;const{startOffset:g,collapsed:h}=n,p=c!=null?c:a.dataStream.length,f=[{startOffset:g+p,endOffset:g+p,style:u==null?void 0:u.style,collapsed:h}],S={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:f,debounce:!0}},E=new s.TextX,C=s.JSONX.getInstance();if(h)g>0&&E.push({t:s.TextXActionType.RETAIN,len:g}),E.push({t:s.TextXActionType.INSERT,body:a,len:a.dataStream.length});else{const O=s.BuildTextUtils.selection.delete([n],m,0,a);E.push(...O)}S.params.textRanges=[{startOffset:g+p,endOffset:g+p,collapsed:h}];const b=Z(d,o);return S.params.actions=C.editOp(E.serialize(),b),!!e.syncExecuteCommand(S.id,S.params)}},Ze={id:"doc.command.delete-text",type:s.CommandType.COMMAND,handler:async(i,t)=>{var R;const e=i.get(s.ICommandService),n=i.get(s.IUniverInstanceService),{range:o,segmentId:a,unitId:r,direction:c,len:l=1}=t,A=n.getUnit(r,s.UniverInstanceType.UNIVER_DOC),d=A==null?void 0:A.getSelfOrHeaderFooterModel(a).getBody();if(A==null||d==null)return!1;const{startOffset:u}=o;let m=c===oe.LEFT?u-l:u,g=c===oe.LEFT?u-1:u+l-1;const h=(R=d.customRanges)==null?void 0:R.find(I=>I.startIndex<=m&&I.endIndex>=g);h!=null&&h.wholeEntity&&(m=h.startIndex,g=Math.max(g,h.endIndex));const p={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:[{startOffset:m,endOffset:m,collapsed:!0}],debounce:!0}},f=new s.TextX,S=s.JSONX.getInstance();f.push({t:s.TextXActionType.RETAIN,len:m-0}),f.push({t:s.TextXActionType.DELETE,len:g-m+1});const C=Z(A,a);return p.params.actions=S.editOp(f.serialize(),C),!!e.syncExecuteCommand(p.id,p.params)}},ai={id:"doc.command.update-text",type:s.CommandType.COMMAND,handler:async(i,t)=>{const{range:e,segmentId:n,updateBody:o,coverType:a,unitId:r,textRanges:c}=t,l=i.get(s.ICommandService),d=i.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(d==null)return!1;const u={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:c}},m=new s.TextX,g=s.JSONX.getInstance(),{startOffset:h,endOffset:p}=e;m.push({t:s.TextXActionType.RETAIN,len:h}),m.push({t:s.TextXActionType.RETAIN,body:o,len:p-h,coverType:a});const f=Z(d,n);return u.params.actions=g.editOp(m.serialize(),f),!!l.syncExecuteCommand(u.id,u.params)}};function mt(i){var r,c,l,A;const t=i.get(s.IUniverInstanceService),n=i.get(D.DocSelectionManagerService).getActiveTextRange(),o=t.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);return!n||!n.collapsed||!o||n.segmentId?!1:s.BuildTextUtils.range.getParagraphsInRange(n,(c=(r=o.getBody())==null?void 0:r.paragraphs)!=null?c:[],(A=(l=o.getBody())==null?void 0:l.dataStream)!=null?A:"")[0]}const qt={id:"doc.command.delete-custom-block",type:s.CommandType.COMMAND,handler:async(i,t)=>{var x;const e=i.get(D.DocSelectionManagerService),n=i.get(s.IUniverInstanceService),o=i.get(s.ICommandService),a=e.getActiveTextRange(),r=n.getCurrentUniverDocInstance();if(a==null||r==null)return!1;const{direction:c,range:l,unitId:A,drawingId:d}=t,{startOffset:u,segmentId:m,style:g}=a,h=c===oe.LEFT?u-1:u,p=[{startOffset:h,endOffset:h,style:g}],f={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:p,prevTextRanges:[l]}},S=new s.TextX,E=s.JSONX.getInstance(),C=[];u>0&&S.push({t:s.TextXActionType.RETAIN,len:c===oe.LEFT?u-1:u}),S.push({t:s.TextXActionType.DELETE,len:1});const b=Z(r,m);C.push(E.editOp(S.serialize(),b));const R=((x=r.getDrawings())!=null?x:{})[d],O=r.getDrawingsOrder().indexOf(d),M=E.removeOp(["drawings",d],R),y=E.removeOp(["drawingsOrder",O],d);return C.push(M),C.push(y),f.params.actions=C.reduce((w,H)=>s.JSONX.compose(w,H),null),!!o.syncExecuteCommand(f.id,f.params)}},Jt={id:"doc.command.merge-two-paragraph",type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(D.DocSelectionManagerService),n=i.get(s.IUniverInstanceService),o=i.get(s.ICommandService),{direction:a,range:r}=t,c=e.getActiveTextRange(),l=e.getTextRanges();if(c==null||l==null)return!1;const{segmentId:A,style:d}=c,u=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),m=u==null?void 0:u.getSelfOrHeaderFooterModel(A).getBody();if(u==null||m==null)return!1;const g=m.dataStream,h=c,p=u.getUnitId(),{startOffset:f,collapsed:S}=h;if(!S)return!1;const E=a===oe.LEFT?f:f+1;let C,b;for(const V of m.paragraphs){if(V.startIndex>=E){b=V;break}C=V}if(C==null||b==null)return!1;const R=a===oe.LEFT?f-1:f,I=[{startOffset:R,endOffset:R,style:d}],O={id:D.RichTextEditingMutation.id,params:{unitId:p,actions:[],textRanges:I,prevTextRanges:[r]}},M=new s.TextX,y=s.JSONX.getInstance();C.startIndex>0&&M.push({t:s.TextXActionType.RETAIN,len:C.startIndex}),M.push({t:s.TextXActionType.DELETE,len:1}),b.startIndex>C.startIndex+1&&M.push({t:s.TextXActionType.RETAIN,len:b.startIndex-C.startIndex-1});const N=Object.values(s.DataStreamTreeTokenType),x=g[C.startIndex-1];(x&&!N.includes(x)||x===" ")&&M.push({t:s.TextXActionType.RETAIN,len:1,coverType:s.UpdateDocsAttributeType.REPLACE,body:{dataStream:"",paragraphs:[{...s.Tools.deepClone(C),startIndex:0}]}});const w=Z(u,A);return O.params.actions=y.editOp(M.serialize(),w),!!o.syncExecuteCommand(O.id,O.params)}},cs={id:"doc.command.remove-horizontal-line",type:s.CommandType.COMMAND,handler:async i=>{var R;const t=i.get(D.DocSelectionManagerService),e=i.get(s.IUniverInstanceService),n=i.get(s.ICommandService),o=t.getActiveTextRange(),a=t.getTextRanges();if(o==null||a==null)return!1;const{segmentId:r,style:c}=o,l=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),A=l==null?void 0:l.getSelfOrHeaderFooterModel(r).getBody();if(l==null||A==null)return!1;const d=o,u=l.getUnitId(),{startOffset:m,collapsed:g}=d;if(!g)return!1;const h=(R=A.paragraphs)==null?void 0:R.find(I=>I.startIndex===m-1);if(h==null)return!1;const p=[{startOffset:m,endOffset:m,style:c}],f={id:D.RichTextEditingMutation.id,params:{unitId:u,actions:[],textRanges:p}},S=new s.TextX,E=s.JSONX.getInstance();h.startIndex>0&&S.push({t:s.TextXActionType.RETAIN,len:h.startIndex}),S.push({t:s.TextXActionType.RETAIN,len:1,coverType:s.UpdateDocsAttributeType.REPLACE,body:{dataStream:"",paragraphs:[{...s.Tools.deepClone({...h,paragraphStyle:{...h.paragraphStyle,borderBottom:void 0}}),startIndex:0}]}});const C=Z(l,r);return f.params.actions=E.editOp(S.serialize(),C),!!n.syncExecuteCommand(f.id,f.params)}};function Zt(i,t){let e=0;if(i==null||i.length===0){if(typeof t[0].startOffset=="number"){const n=t[0],{spanEntireRow:o,spanEntireTable:a}=n;a?e=n.startOffset-3:o?n.startRow>0?e=n.startOffset-6:e=n.startOffset:e=t[0].startOffset}}else if(i.length>0&&t.length>0){const n=i[0],o=t[0];if(n.startOffset!=null&&o.startOffset!=null){if(n.startOffset<o.startOffset)e=n.startOffset;else if(n.startOffset>=o.startOffset){const{spanEntireRow:a,spanEntireTable:r}=o;r?e=o.startOffset-3:a&&(e=o.startOffset-6)}}}return e}const pt={id:"doc.command.delete-left",type:s.CommandType.COMMAND,handler:async i=>{var y,N,x,w,H,V;const t=i.get(D.DocSelectionManagerService),e=i.get(s.IUniverInstanceService),n=i.get(s.ICommandService);let o=!0;const a=e.getCurrentUniverDocInstance();if(a==null)return!1;const r=a.getUnitId(),c=re(i,r),l=t.getActiveTextRange(),A=t.getRectRanges(),d=t.getTextRanges(),u=c==null?void 0:c.getSkeleton();if(u==null)return!1;if(A!=null&&A.length){const F=Zt(d,A),Q=A[0].segmentId,j=[{startOffset:F,endOffset:F}];return n.executeCommand(Ve.id,{segmentId:Q,textRanges:j})}if(l==null||d==null)return!1;const{segmentId:m,style:g,segmentPage:h}=l,p=a.getSelfOrHeaderFooterModel(m).getBody();if(p==null)return!1;const f=l,{startOffset:S,collapsed:E}=f,C=u.findNodeByCharIndex(S,m,h),b=_.hasListGlyph(C),R=_.isIndentByGlyph(C,p);let I=S;const O=u.findNodeByCharIndex(S-1,m,h);if(_.isFirstGlyph(C)&&O!==C&&(b===!0||R===!0)&&E){const F=_.getParagraphByGlyph(C,p);if(F==null)return!1;const Q=F==null?void 0:F.startIndex,j={startIndex:0},G=F.paragraphStyle;if(b===!0){const W=F.paragraphStyle;if(W){j.paragraphStyle=W;const{hanging:z}=W;z&&(j.paragraphStyle.indentStart=z,j.paragraphStyle.hanging=void 0)}}else if(R===!0){const W=F.bullet;W&&(j.bullet=W),G!=null&&(j.paragraphStyle={...G},delete j.paragraphStyle.hanging,delete j.paragraphStyle.indentStart)}const k=[{startOffset:I,endOffset:I,style:g}];o=await n.executeCommand(ai.id,{unitId:a.getUnitId(),updateBody:{dataStream:"",paragraphs:[{...j}]},range:{startOffset:Q,endOffset:Q+1},textRanges:k,coverType:s.UpdateDocsAttributeType.REPLACE,segmentId:m})}else if(E===!0){if(O==null)return!0;if(O.content==="\r"){const F=(y=p.paragraphs)==null?void 0:y.find(Q=>Q.startIndex===S-1);(N=F==null?void 0:F.paragraphStyle)!=null&&N.borderBottom?o=await n.executeCommand(cs.id):o=await n.executeCommand(Jt.id,{direction:oe.LEFT,range:f})}else if(O.streamType==="\b"){const F=(w=a.getSnapshot().drawings)==null?void 0:w[(x=O.drawingId)!=null?x:""];if(F==null)return!0;const Q=(V=(H=a.getBody())==null?void 0:H.customBlocks)==null?void 0:V.find(G=>G.blockId===O.drawingId);if(F.layoutType===s.PositionedObjectLayoutType.INLINE||(Q==null?void 0:Q.blockType)===s.BlockType.CUSTOM){const G=a.getUnitId();o=await n.executeCommand(qt.id,{direction:oe.LEFT,range:l,unitId:G,drawingId:O.drawingId})}else{const G=u.findNodeByCharIndex(S-2);if(G==null)return!0;I-=O.count,I-=G.count;const k=[{startOffset:I,endOffset:I,style:g}];o=await n.executeCommand(Ze.id,{unitId:a.getUnitId(),range:{...l,startOffset:l.startOffset-1,endOffset:l.endOffset-1},segmentId:m,direction:oe.LEFT,len:G.count,textRanges:k})}}else I-=O.count,o=await n.executeCommand(Ze.id,{unitId:a.getUnitId(),range:f,segmentId:m,direction:oe.LEFT,len:O.count})}else{const F=ls(f,[f]);o=await n.executeCommand(Ve.id,{segmentId:m,textRanges:F,selections:[f]})}return o}},ri={id:"doc.command.delete-right",type:s.CommandType.COMMAND,handler:async i=>{var C,b;const t=i.get(D.DocSelectionManagerService),n=i.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(!n)return!1;const o=re(i,n.getUnitId()),a=i.get(s.ICommandService),r=t.getActiveTextRange(),c=t.getRectRanges(),l=t.getTextRanges(),A=o==null?void 0:o.getSkeleton();if(c!=null&&c.length){const R=Zt(l,c),I=c[0].segmentId,O=[{startOffset:R,endOffset:R}];return a.executeCommand(Ve.id,{segmentId:I,textRanges:O})}if(r==null||A==null||l==null)return!1;const{segmentId:d,style:u,segmentPage:m}=r,g=n==null?void 0:n.getSelfOrHeaderFooterModel(d).getBody();if(!n||!g)return!1;const h=r,{startOffset:p,endOffset:f,collapsed:S}=h;if(p===g.dataStream.length-2&&S)return!0;let E=!1;if(S===!0){const R=A.findNodeByCharIndex(p,d,m),I=A.findNodeByCharIndex(p+1);if(R.streamType===s.DataStreamTreeTokenType.PARAGRAPH&&(I==null?void 0:I.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK)return!1;if(R.content==="\r")E=await a.executeCommand(Jt.id,{direction:oe.RIGHT,range:r});else if(R.streamType==="\b"){const O=(b=n.getSnapshot().drawings)==null?void 0:b[(C=R.drawingId)!=null?C:""];if(O==null)return!0;if(O.layoutType===s.PositionedObjectLayoutType.INLINE){const y=n.getUnitId();E=await a.executeCommand(qt.id,{direction:oe.RIGHT,range:r,unitId:y,drawingId:R.drawingId})}else{if(I==null)return!0;const y=[{startOffset:p+1,endOffset:p+1,style:u}];E=await a.executeCommand(Ze.id,{unitId:n.getUnitId(),range:{...r,startOffset:p+1,endOffset:f+1},segmentId:d,direction:oe.RIGHT,textRanges:y,len:I.count})}}else{const O=[{startOffset:p,endOffset:p,style:u}];E=await a.executeCommand(Ze.id,{unitId:n.getUnitId(),range:h,segmentId:d,direction:oe.RIGHT,textRanges:O,len:R.count})}}else{const R=ls(h,[h]);E=await a.executeCommand(Ve.id,{segmentId:d,textRanges:R,selections:[h]})}return E}};function ls(i,t){let e=i.endOffset;for(const o of t){const{startOffset:a,endOffset:r}=o;a==null||r==null||r<=i.endOffset&&(e-=r-a)}return[{startOffset:e,endOffset:e,style:i.style}]}const ci={id:"doc.command.delete-current-paragraph",type:s.CommandType.COMMAND,handler:async i=>{var A,d;const t=i.get(s.IUniverInstanceService),e=i.get(s.ICommandService),n=t.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!n)return!1;const o=(d=(A=n.getBody())==null?void 0:A.dataStream)!=null?d:"",a=mt(i);if(!a)return!1;const r=s.BuildTextUtils.selection.delete([{startOffset:a.paragraphStart,endOffset:o[a.paragraphEnd+1]===`
`?a.paragraphEnd:a.paragraphEnd+1,collapsed:!1}],n.getBody(),0,void 0,!0),c=Z(n),l={unitId:n.getUnitId(),actions:s.JSONX.getInstance().editOp(r,c),textRanges:[{startOffset:a.paragraphStart,endOffset:a.paragraphStart,collapsed:!0}]};return e.syncExecuteCommand(D.RichTextEditingMutation.id,l)}},Hr=10,kr=6;function Vr(){return s.Tools.generateRandomId(kr)}function Wr(i){const t=i.match(/data-copy-id="([^\s]+)"/);return t&&t[1]?t[1]:null}class zr{constructor(){B(this,"_cache",new s.LRUMap(Hr))}set(t,e){this._cache.set(t,e)}get(t){return this._cache.get(t)}clear(){this._cache.clear()}}const li=new zr;function di(i){const t=i.style,e={},n=i.tagName.toLowerCase();switch(n){case"b":case"em":case"strong":{e.bl=s.BooleanNumber.TRUE;break}case"s":{e.st={s:s.BooleanNumber.TRUE};break}case"u":{e.ul={s:s.BooleanNumber.TRUE};break}case"i":{e.it=s.BooleanNumber.TRUE;break}case"sub":case"sup":{e.va=n==="sup"?s.BaselineOffset.SUPERSCRIPT:s.BaselineOffset.SUBSCRIPT;break}}for(let o=0;o<t.length;o++){const a=t[o],r=t.getPropertyValue(a);switch(a){case"font-family":{e.ff=r.replace(/^"/g,"").replace(/"$/g,"");break}case"font-size":{const c=Number.parseInt(r);Number.isNaN(c)||(r.endsWith("pt")?e.fs=c:r.endsWith("px")&&(e.fs=_.pixelToPt(c)));break}case"font-style":{r==="italic"&&(e.it=s.BooleanNumber.TRUE);break}case"font-weight":{(Number(r)>400||String(r)==="bold")&&(e.bl=s.BooleanNumber.TRUE);break}case"text-decoration":{/underline/.test(r)?e.ul={s:s.BooleanNumber.TRUE}:/overline/.test(r)?e.ol={s:s.BooleanNumber.TRUE}:/line-through/.test(r)&&(e.st={s:s.BooleanNumber.TRUE});break}case"color":{try{const c=new s.ColorKit(r);c.isValid&&(e.cl={rgb:c.toRgbString()})}catch{}break}case"background-color":{const c=new s.ColorKit(r);c.isValid&&(e.bg={rgb:c.toRgbString()});break}}}return e}function Gr(i){const t=new DOMParser,e=`<x-univer id="univer-root">${i}</x-univer>`;return t.parseFromString(e,"text/html").querySelector("#univer-root")}function ds(i,t){const e=i.tagName.toLowerCase();return typeof t=="string"?e===t:Array.isArray(t)?t.some(n=>n===e):t(i)}const As=660,xn=class xn{constructor(){B(this,"_tableCache",[]);B(this,"_styleCache",new Map);B(this,"_styleRules",[]);B(this,"_afterProcessRules",[])}static use(t){if(this._pluginList.includes(t))throw new Error(`Univer paste plugin ${t.name} already added`);this._pluginList.push(t)}convert(t,e={}){var c;const n=xn._pluginList.find(l=>l.checkPasteType(t)),o=Gr(t),r={body:{dataStream:"",paragraphs:[],sectionBreaks:[],tables:[],textRuns:[],customBlocks:[]},tableSource:{},id:(c=e==null?void 0:e.unitId)!=null?c:""};return n&&(this._styleRules=[...n.stylesRules],this._afterProcessRules=[...n.afterProcessRules]),this._tableCache=[],this._styleCache.clear(),this._process(null,o.childNodes,r),this._styleCache.clear(),this._styleRules=[],this._afterProcessRules=[],r}_process(t,e,n){var a,r,c,l;const o=n.body;for(const A of e)if(A.nodeType===Node.TEXT_NODE){if(((a=A.nodeValue)==null?void 0:a.trim())==="")continue;const d=(r=A.nodeValue)==null?void 0:r.replace(/[\r\n]/g,"");let u;t&&this._styleCache.has(t)&&(u=this._styleCache.get(t)),o.dataStream+=d,u&&Object.getOwnPropertyNames(u).length&&o.textRuns.push({st:o.dataStream.length-d.length,ed:o.dataStream.length,ts:u})}else if(A.nodeName==="IMG"){const d=A,u=d.dataset.imageSourceType,m=u===Dn.ImageSourceType.UUID?d.dataset.source:d.src;if(m&&u){const g=Number(d.dataset.width||100),h=Number(d.dataset.height||100),p=Number(d.dataset.docTransformWidth||g),f=Number(d.dataset.docTransformHeight||h),S=s.Tools.generateRandomId(6);(l=(c=n.body)==null?void 0:c.customBlocks)==null||l.push({startIndex:o.dataStream.length,blockId:S}),o.dataStream+="\b",n.drawings||(n.drawings={}),n.drawings[S]={drawingId:S,title:"",description:"",imageSourceType:u,source:m,transform:{width:g,height:h,left:0},docTransform:{size:{width:p,height:f},angle:0,positionH:{relativeFrom:s.ObjectRelativeFromH.PAGE,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.PARAGRAPH,posOffset:0}},layoutType:s.PositionedObjectLayoutType.INLINE,drawingType:s.DrawingTypeEnum.DRAWING_IMAGE,unitId:n.id||"",subUnitId:n.id||""}}}else{if(s.skipParseTagNames.includes(A.nodeName.toLowerCase()))continue;if(A.nodeType===Node.ELEMENT_NODE){const d=A,u=this._processBeforeLink(d,n),m=t?this._styleCache.get(t):{},g=this._styleRules.find(({filter:S})=>ds(A,S)),h=g?g.getStyle(A):di(A);this._styleCache.set(A,{...m,...h});const{childNodes:p}=A;this._processBeforeTable(A,n),this._process(A,p,n),this._processAfterTable(A,n);const f=this._afterProcessRules.find(({filter:S})=>ds(A,S));f&&f.handler(n,A),this._processAfterLink(d,n,u)}}}_processBeforeTable(t,e){var a;const n=t.tagName.toUpperCase(),o=e.body;switch(n){case"TABLE":{o.dataStream[o.dataStream.length-1]!=="\r"&&(o.dataStream+="\r",o.paragraphs==null&&(o.paragraphs=[]),(a=o.paragraphs)==null||a.push({startIndex:o.dataStream.length-1}));const r=ni(0,0,As);this._tableCache.push({table:r,startIndex:o.dataStream.length}),o.dataStream+=s.DataStreamTreeTokenType.TABLE_START;break}case"TR":{const r=Kt(0);this._tableCache[this._tableCache.length-1].table.tableRows.push(r),o.dataStream+=s.DataStreamTreeTokenType.TABLE_ROW_START;break}case"TD":{const r=Xt(),c=this._tableCache[this._tableCache.length-1].table;c.tableRows[c.tableRows.length-1].tableCells.push(r),o.dataStream+=s.DataStreamTreeTokenType.TABLE_CELL_START;break}}}_processAfterTable(t,e){var r,c;const n=t.tagName.toUpperCase(),o=e.body;e.tableSource==null&&(e.tableSource={}),o.tables==null&&(o.tables=[]),o.sectionBreaks==null&&(o.sectionBreaks=[]);const{tableSource:a}=e;switch(n){case"TABLE":{const l=this._tableCache.pop(),{startIndex:A,table:d}=l,u=d.tableRows[0].tableCells.length,m=Yt(As/u),g=[...new Array(u).fill(null).map(()=>s.Tools.deepClone(m))];d.tableColumns=g,a[d.tableId]=d,o.dataStream+=s.DataStreamTreeTokenType.TABLE_END,o.tables.push({startIndex:A,endIndex:o.dataStream.length,tableId:d.tableId});break}case"TR":{o.dataStream+=s.DataStreamTreeTokenType.TABLE_ROW_END;break}case"TD":{o.dataStream[o.dataStream.length-1]!=="\r"&&((r=o.paragraphs)==null||r.push({startIndex:o.dataStream.length}),o.dataStream+="\r"),(c=o.sectionBreaks)==null||c.push({startIndex:o.dataStream.length}),o.dataStream+=`
${s.DataStreamTreeTokenType.TABLE_CELL_END}`;break}}}_processBeforeLink(t,e){return e.body.dataStream.length}_processAfterLink(t,e,n){var r,c;const o=e.body,a=t;a.tagName.toUpperCase()==="A"&&(o.customRanges=(r=o.customRanges)!=null?r:[],o.customRanges.push({startIndex:n,endIndex:o.dataStream.length-1,rangeId:(c=a.dataset.rangeid)!=null?c:s.generateRandomId(),rangeType:s.CustomRangeType.HYPERLINK,properties:{url:a.href}}))}};B(xn,"_pluginList",[]);let $e=xn;const us={name:"univer-doc-paste-plugin-lark",checkPasteType(i){return/lark-record-clipboard/i.test(i)},stylesRules:[{filter:["s"],getStyle(i){const t=di(i);return{st:{s:s.BooleanNumber.TRUE},...t}}}],afterProcessRules:[{filter(i){return i.tagName==="DIV"&&/ace-line/i.test(i.className)},handler(i){const t=i.body;t.paragraphs==null&&(t.paragraphs=[]),t.paragraphs.push({startIndex:t.dataStream.length}),t.dataStream+="\r"}}]};function gs(i){const t=i.style,e={};for(let n=0;n<t.length;n++){const o=t[n],a=t.getPropertyValue(o);switch(o){case"margin-top":{const r=Number.parseInt(a);e.spaceAbove={v:/pt/.test(a)?_.ptToPixel(r):r};break}case"margin-bottom":{const r=Number.parseInt(a);e.spaceBelow={v:/pt/.test(a)?_.ptToPixel(r):r};break}case"line-height":{let r=Number.parseFloat(a);a.endsWith("%")&&(r/=100),e.lineSpacing=r;break}}}return Object.getOwnPropertyNames(e).length?e:null}const hs={name:"univer-doc-paste-plugin-univer",checkPasteType(i){return/UniverNormal/i.test(i)},stylesRules:[],afterProcessRules:[{filter(i){return i.tagName==="P"&&/UniverNormal/i.test(i.className)},handler(i,t){const e=i.body;e.paragraphs==null&&(e.paragraphs=[]);const n={startIndex:e.dataStream.length},o=gs(t);o&&(n.paragraphStyle=o),e.paragraphs.push(n),e.dataStream+="\r"}}]},ms={name:"univer-doc-paste-plugin-word",checkPasteType(i){return/word|mso/i.test(i)},stylesRules:[{filter:["b"],getStyle(i){const t=di(i);return{bl:s.BooleanNumber.TRUE,...t}}}],afterProcessRules:[{filter(i){return i.tagName==="P"},handler(i,t){const e=i.body;e.paragraphs==null&&(e.paragraphs=[]);const n={startIndex:e.dataStream.length},o=gs(t);o&&(n.paragraphStyle=o),e.paragraphs.push(n),e.dataStream+="\r"}}]};function jr(i){var n,o;const t=a=>{let r="";return Object.keys(a).forEach(c=>{a[c]!==void 0&&(r+=` ${c}=${a[c]}`)}),r},e={"data-doc-transform-height":i.docTransform.size.height,"data-doc-transform-width":i.docTransform.size.width,"data-width":(n=i.transform)==null?void 0:n.width,"data-height":(o=i.transform)==null?void 0:o.height,"data-image-source-type":i.imageSourceType,"data-source":i.imageSourceType===Dn.ImageSourceType.UUID?i.source:void 0,src:i.source};return`<img  ${t(e)}></img>`}function ps(i,t){const{st:e,ed:n,ts:o={}}=t,{ff:a,fs:r,it:c,bl:l,ul:A,st:d,ol:u,bg:m,cl:g,va:h}=o;let p=i.slice(e,n);const f=[];return c===s.BooleanNumber.TRUE&&(p=`<i>${p}</i>`),h===s.BaselineOffset.SUPERSCRIPT?p=`<sup>${p}</sup>`:h===s.BaselineOffset.SUBSCRIPT&&(p=`<sub>${p}</sub>`),(A==null?void 0:A.s)===s.BooleanNumber.TRUE&&(p=`<u>${p}</u>`),(d==null?void 0:d.s)===s.BooleanNumber.TRUE&&(p=`<s>${p}</s>`),l===s.BooleanNumber.TRUE&&(p=`<strong>${p}</strong>`),a&&f.push(`font-family: ${a}`),g&&f.push(`color: ${g.rgb}`),r&&f.push(`font-size: ${r}pt`),u&&f.push("text-decoration: overline"),m&&f.push(`background: ${m.rgb}`),f.length?`<span style="${f.join("; ")};">${p}</span>`:p}function Ai(i,t,e){const{dataStream:n,textRuns:o=[]}=i;if(t===e)return"";let a=t;const r=[];for(const c of o){const{st:l,ed:A}=c;s.Tools.hasIntersectionBetweenTwoRanges(t,e,l,A)&&(l>a?(r.push(n.slice(a,l)),r.push(ps(n,{...c,ed:Math.min(A,e)}))):r.push(ps(n,{...c,st:a,ed:Math.min(A,e)}))),a=Math.max(t,Math.min(A,e))}return a!==e&&r.push(n.slice(a,e)),r.join("")}function Xr(i,t,e){const n=i.body,o=i.drawings||{},{customRanges:a=[],customBlocks:r=[]}=n||{},c=[...r],l=a.filter(g=>g.startIndex>=t&&g.endIndex<=e);let A=t,d="";const u=(g,h)=>{let p="",f=0,S=g,E=c.findIndex(C=>g<=C.startIndex&&h>=C.startIndex);if(E===-1)return p=Ai(n,g,h),{sliceHtml:p,customBlockLength:f};for(;E!==-1;){const C=c[E];c.splice(E,1),p+=Ai(n,S,C.startIndex);const b=o[C.blockId];if(b)switch(b.drawingType){case s.DrawingTypeEnum.DRAWING_IMAGE:{p+=jr(b),f++;break}}S=C.startIndex+1,E=c.findIndex(R=>S<=R.startIndex&&h>=R.startIndex)}return p=p+Ai(n,S,h+1),{sliceHtml:p,customBlockLength:f}};l.forEach(g=>{var b,R;const{startIndex:h,endIndex:p,rangeType:f,rangeId:S}=g,E=u(A,h);d+=E.sliceHtml;const C=u(h,p+1);switch(f){case s.CustomRangeType.HYPERLINK:{d+=`<a data-rangeid="${S}" href="${(R=(b=g.properties)==null?void 0:b.url)!=null?R:""}">${C.sliceHtml}</a>`;break}default:{d+=C.sliceHtml;break}}A=p+1+(E.customBlockLength+C.customBlockLength)});const m=u(A,e);return d+=m.sliceHtml,d}function fs(i){const t=i.body||{},{paragraphs:e=[],sectionBreaks:n=[]}=t;let{dataStream:o=""}=t;o.endsWith(`\r
`)||(o+=`\r
`,e.push({startIndex:o.length-2}),n.push({startIndex:o.length-1}),t.dataStream=o,t.paragraphs=e,t.sectionBreaks=n);const a={html:""},r=_.parseDataStreamToTree(o).sectionList;for(const c of r)et(c,i,a);return a.html}function et(i,t,e){var n,o;switch(i.nodeType){case s.DataStreamTreeNodeType.SECTION_BREAK:{for(const a of i.children)et(a,t,e);break}case s.DataStreamTreeNodeType.PARAGRAPH:{const{children:a,startIndex:r,endIndex:c}=i,l=(o=(n=t.body)==null?void 0:n.paragraphs.find(h=>h.startIndex===c))!=null?o:{},{paragraphStyle:A={}}=l,{spaceAbove:d,spaceBelow:u,lineSpacing:m}=A,g=[];if(d!=null&&(typeof d=="number"?g.push(`margin-top: ${d}px`):g.push(`margin-top: ${d.v}px`)),u!=null&&(typeof u=="number"?g.push(`margin-bottom: ${u}px`):g.push(`margin-bottom: ${u.v}px`)),m!=null&&g.push(`line-height: ${m}`),e.html+=`<p class="UniverNormal" ${g.length?`style="${g.join("; ")};"`:""}>`,a.length)for(const h of a)et(h,t,e);e.html+=`${Xr(t,r,c)}</p>`;break}case s.DataStreamTreeNodeType.TABLE:{const{children:a}=i;e.html+='<table class="UniverTable" style="width: 100%; border-collapse: collapse;"><tbody>';for(const r of a)et(r,t,e);e.html+="</tbody></table>";break}case s.DataStreamTreeNodeType.TABLE_ROW:{const{children:a}=i;e.html+='<tr class="UniverTableRow">';for(const r of a)et(r,t,e);e.html+="</tr>";break}case s.DataStreamTreeNodeType.TABLE_CELL:{const{children:a}=i;e.html+='<td class="UniverTableCell">';for(const r of a)et(r,t,e);e.html+="</td>";break}default:throw new Error(`Unknown node type: ${i.nodeType}`)}}class Kr{convert(t){if(t.length===0)throw new Error("The bodyList length at least to be 1");let e="";for(const n of s.Tools.deepClone(t))e+=fs(n);return e}}var Yr=Object.getOwnPropertyDescriptor,qr=(i,t,e,n)=>{for(var o=n>1?void 0:n?Yr(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},ft=(i,t)=>(e,n)=>t(e,n,i);$e.use(ms),$e.use(us),$e.use(hs);function Ss(i,t,e){var a,r,c;const n=s.getBodySlice(i,t,e+2),o=s.DataStreamTreeTokenType.TABLE_START+s.DataStreamTreeTokenType.TABLE_ROW_START+s.DataStreamTreeTokenType.TABLE_CELL_START+n.dataStream+s.DataStreamTreeTokenType.TABLE_CELL_END+s.DataStreamTreeTokenType.TABLE_ROW_END+s.DataStreamTreeTokenType.TABLE_END;return n.dataStream=o,(a=n.textRuns)==null||a.forEach(l=>{const{st:A,ed:d}=l;l.st=A+3,l.ed=d+3}),(r=n.tables)==null||r.forEach(l=>{const{startIndex:A,endIndex:d}=l;l.startIndex=A+3,l.endIndex=d+3}),(c=n.paragraphs)==null||c.forEach(l=>{const{startIndex:A}=l;l.startIndex=A+3}),n}const xe=s.createIdentifier("doc.clipboard-service");let ui=class extends s.Disposable{constructor(t,e,n,o,a){super();B(this,"_clipboardHooks",[]);B(this,"_htmlToUDM",new $e);B(this,"_umdToHtml",new Kr);this._univerInstanceService=t,this._logService=e,this._commandService=n,this._clipboardInterfaceService=o,this._docSelectionManagerService=a}async copy(t=s.SliceBodyType.copy,e){var c,l;const{newSnapshotList:n=[],needCache:o=!1,snapshot:a,ranges:r}=(c=this._getDocumentBodyInRanges(t,e))!=null?c:{};if(n.length===0||a==null)return!1;try{const A=!!((l=r==null?void 0:r[0])!=null&&l.segmentId);this._setClipboardData(n,!A&&o)}catch(A){return this._logService.error("[DocClipboardService] copy failed",A),!1}return!0}async cut(t){return this._cut(t)}async paste(t){const e=await this._genDocDataFromClipboardItems(t);return this._paste(e)}async legacyPaste(t){let{html:e,text:n,files:o}=t;const a=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=(a==null?void 0:a.getUnitId())||"";!e&&!n&&o.length&&(e=await this._createImagePasteHtml(o));const c=this._genDocDataFromHtmlAndText(e,n,r);if(r===s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY)if(n){const l=s.BuildTextUtils.transform.fromPlainText(n);return this._paste({body:l})}else c.body.textRuns=[];return this._paste(c)}async _cut(t){var c,l,A,d,u;const e=(l=(c=t==null?void 0:t.filter(m=>m.rangeType===s.DOC_RANGE_TYPE.TEXT))!=null?c:this._docSelectionManagerService.getTextRanges())!=null?l:[],n=(d=(A=t==null?void 0:t.filter(m=>m.rangeType===s.DOC_RANGE_TYPE.RECT))!=null?A:this._docSelectionManagerService.getRectRanges())!=null?d:[],{segmentId:o,endOffset:a,style:r}=(u=e[0])!=null?u:{};if(o==null&&this._logService.error("[DocClipboardController] segmentId is not existed"),e.length===0&&n.length===0)return!1;this.copy(s.SliceBodyType.cut,t);try{let m=0;if(n.length>0)m=Zt(e,n);else if(a!=null){m=a;for(const h of e){const{startOffset:p,endOffset:f}=h;p==null||f==null||f<=a&&(m-=f-p)}}const g=[{startOffset:m,endOffset:m,style:r}];return this._commandService.executeCommand(Ve.id,{segmentId:o,textRanges:g,rectRanges:n,selections:e})}catch{return this._logService.error("[DocClipboardController] cut content failed"),!1}}async _paste(t){var d,u,m;const{body:e}=t;if(e==null)return!1;let n=s.normalizeBody(e);if(!((d=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC))==null?void 0:d.getUnitId()))return!1;this._clipboardHooks.forEach(g=>{g.onBeforePaste&&(n=g.onBeforePaste(n))}),n.customRanges=(u=n.customRanges)==null?void 0:u.map(s.BuildTextUtils.customRange.copyCustomRange),(m=n.paragraphs)==null||m.forEach(g=>{var h;(h=g.paragraphStyle)!=null&&h.headingId&&(g.paragraphStyle.headingId=s.generateRandomId(6))});const a=this._docSelectionManagerService.getActiveTextRange(),{segmentId:r,endOffset:c,style:l}=a||{},A=this._docSelectionManagerService.getTextRanges();if(r==null&&this._logService.error("[DocClipboardController] segmentId does not exist!"),c==null||A==null)return!1;try{let g=c;for(const p of A){const{startOffset:f,endOffset:S}=p;f==null||S==null||S<=c&&(g+=n.dataStream.length-(S-f))}const h=[{startOffset:g,endOffset:g,style:l}];return this._commandService.executeCommand(oi.id,{doc:{...t,body:n},segmentId:r,textRanges:h})}catch{return this._logService.error("[DocClipboardController]","clipboard is empty."),!1}}async _setClipboardData(t,e=!0){var r,c,l,A;const n=Vr(),o=(t.length>1?t.map(d=>{var u;return((u=d.body)==null?void 0:u.dataStream)||""}).join(`
`):((r=t[0].body)==null?void 0:r.dataStream)||"").replaceAll(s.DataStreamTreeTokenType.TABLE_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_END,"").replaceAll(s.DataStreamTreeTokenType.TABLE_ROW_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_ROW_END,"").replaceAll(s.DataStreamTreeTokenType.TABLE_CELL_START,"").replaceAll(s.DataStreamTreeTokenType.TABLE_CELL_END,"").replaceAll(`\r
`," ");let a=this._umdToHtml.convert(t);if(t.length===1&&e){a=a.replace(/(<[a-z]+)/,(m,g)=>`${g} data-copy-id="${n}"`);const d=t[0],u={body:d.body};if((l=(c=d.body)==null?void 0:c.customBlocks)!=null&&l.length){u.drawings={};for(const m of d.body.customBlocks){const{blockId:g}=m,h=(A=d.drawings)==null?void 0:A[g];if(h){const p=s.Tools.generateRandomId(6);m.blockId=p,u.drawings[p]={...s.Tools.deepClone(h),drawingId:p}}}}li.set(n,u)}return this._clipboardInterfaceService.write(o,a)}addClipboardHook(t){return this._clipboardHooks.push(t),s.toDisposable(()=>{const e=this._clipboardHooks.indexOf(t);e>-1&&this._clipboardHooks.splice(e,1)})}_getDocumentBodyInRanges(t,e){var d;const n=this._univerInstanceService.getCurrentUniverDocInstance(),o=e!=null?e:this._docSelectionManagerService.getDocRanges(),a=[];let r=!0;if(n==null||o.length===0)return;const c=o[0].segmentId,l=(d=n==null?void 0:n.getSelfOrHeaderFooterModel(c))==null?void 0:d.getBody(),A=n.getSnapshot();if(l!=null){for(const u of o){const{startOffset:m,endOffset:g,collapsed:h,rangeType:p}=u;if(h||m==null||g==null)continue;if(p===s.DOC_RANGE_TYPE.RECT){r=!1;const{spanEntireRow:E}=u;let C;C=Ss(l,m,g),a.push(C);continue}const f={startOffset:m,endOffset:g},S=n.getSelfOrHeaderFooterModel(c).sliceBody(f.startOffset,f.endOffset,t);S!=null&&a.push(S)}return{newSnapshotList:a.map(u=>({...A,body:u})),needCache:r,snapshot:A,ranges:o}}}async _genDocDataFromClipboardItems(t){try{let e="",n="";const o=[];for(const a of t)for(const r of a.types)switch(r){case v.PLAIN_TEXT_CLIPBOARD_MIME_TYPE:{n=await a.getType(r).then(c=>c&&c.text());break}case v.HTML_CLIPBOARD_MIME_TYPE:{e=await a.getType(r).then(c=>c&&c.text());break}case v.FILE__BMP_CLIPBOARD_MIME_TYPE:case v.FILE__JPEG_CLIPBOARD_MIME_TYPE:case v.FILE__WEBP_CLIPBOARD_MIME_TYPE:case v.FILE_PNG_CLIPBOARD_MIME_TYPE:{const c=await a.getType(r),l=new File([c],`pasted_image.${r.split("/")[1]}`,{type:r});o.push(l);break}}return!e&&!n&&o.length&&(e=await this._createImagePasteHtml(o)),this._genDocDataFromHtmlAndText(e,n)}catch(e){return Promise.reject(e)}}_genDocDataFromHtmlAndText(t,e,n){if(!t){if(e)return{body:s.BuildTextUtils.transform.fromPlainText(e)};throw new Error("[DocClipboardService] html and text cannot be both empty!")}const o=Wr(t);if(o){const r=li.get(o);if(r)return r}if(!n){const r=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);n=(r==null?void 0:r.getUnitId())||""}const a=this._htmlToUDM.convert(t,{unitId:n});return o&&li.set(o,a),a}async _createImagePasteHtml(t){var c,l;const e={id:"",documentStyle:{},body:{dataStream:"",customBlocks:[]},drawings:{}},n=async A=>{const d=new FileReader;return new Promise(u=>{d.onloadend=function(){u({source:d.result,imageSourceType:Dn.ImageSourceType.BASE64})},d.readAsDataURL(A)})},o=A=>{const d=new Image,u=500;return new Promise(m=>{d.src=typeof A=="string"?A:URL.createObjectURL(A),d.onload=()=>{const g=Math.min(u,d.naturalWidth),h=d.naturalHeight/d.naturalWidth;m({width:g,height:g*h})}})},a=(l=(c=this._clipboardHooks.find(A=>A.onBeforePasteImage))==null?void 0:c.onBeforePasteImage)!=null?l:n;return await Promise.all(t.map(async(A,d)=>{var S;const u=await a(A);if(!u)return Promise.resolve();const{width:m=100,height:g=100}=await o(A),h=`paste_image_id_${d}`,p=e.body,f=e.drawings;p.dataStream+="\b",(S=p.customBlocks)==null||S.push({startIndex:d,blockId:h}),f[h]={drawingId:h,unitId:"",subUnitId:"",imageSourceType:u.imageSourceType,title:"",source:u.source,description:"",layoutType:s.PositionedObjectLayoutType.INLINE,drawingType:s.DrawingTypeEnum.DRAWING_IMAGE,transform:{width:m,height:g,angle:0},docTransform:{angle:0,size:{width:m,height:g},positionH:{relativeFrom:s.ObjectRelativeFromH.CHARACTER,posOffset:0},positionV:{relativeFrom:s.ObjectRelativeFromV.LINE,posOffset:0}}}})),this._umdToHtml.convert([e])}};ui=qr([ft(0,s.IUniverInstanceService),ft(1,s.ILogService),ft(2,s.ICommandService),ft(3,v.IClipboardInterfaceService),ft(4,s.Inject(D.DocSelectionManagerService))],ui);function $t(i){return i.getContextValue(s.FOCUSING_DOC)||i.getContextValue(s.EDITOR_ACTIVATED)}const gi=999,St={id:v.CopyCommand.id,name:"doc.command.copy",type:s.CommandType.COMMAND,multi:!0,priority:gi,preconditions:$t,handler:async i=>i.get(xe).copy()},hi={id:"doc.command.copy-current-paragraph",type:s.CommandType.COMMAND,handler:async i=>{const t=i.get(xe),e=mt(i);return e?t.copy(s.SliceBodyType.copy,[{startOffset:e.paragraphStart,endOffset:e.paragraphEnd+1,collapsed:!1}]):!1}},en={id:v.CutCommand.id,name:"doc.command.cut",type:s.CommandType.COMMAND,multi:!0,priority:gi,preconditions:$t,handler:async i=>i.get(xe).cut()},mi={id:"doc.command.cut-current-paragraph",type:s.CommandType.COMMAND,handler:async i=>{const t=i.get(xe),e=mt(i);return e?t.cut([{startOffset:e.paragraphStart,endOffset:e.paragraphEnd+1,collapsed:!1,rangeType:s.DOC_RANGE_TYPE.TEXT}]):!1}},tn={id:v.PasteCommand.id,name:"doc.command.paste",type:s.CommandType.COMMAND,multi:!0,priority:gi,preconditions:$t,handler:async i=>{const t=i.get(xe),n=await i.get(v.IClipboardInterfaceService).read();return n.length===0?!1:t.paste(n)}};var Jr=Object.getOwnPropertyDescriptor,Zr=(i,t,e,n)=>{for(var o=n>1?void 0:n?Jr(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},pi=(i,t)=>(e,n)=>t(e,n,i);const $r=11,ec=9,nn={ff:"Arial",fs:$r};let Te=class extends s.Disposable{constructor(t,e,n){super();B(this,"_cacheStyle",null);this._textSelectionManagerService=t,this._univerInstanceService=e,this._renderManagerService=n,this._init()}_init(){this._listenDocRangeChange()}_listenDocRangeChange(){this.disposeWithMe(this._textSelectionManagerService.textSelection$.subscribe(()=>{this._clearStyleCache()}))}getStyleCache(){return this._cacheStyle}getDefaultStyle(){var r;const t=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(t==null)return{...nn};const e=t==null?void 0:t.getUnitId(),n=(r=this._renderManagerService.getRenderById(e))==null?void 0:r.with(D.DocSkeletonManagerService),o=n==null?void 0:n.getViewModel();return o==null?{...nn}:o.getEditArea()===_.DocumentEditArea.BODY?{...nn}:{...nn,fs:ec}}setStyleCache(t){this._cacheStyle={...this._cacheStyle,...t}}_clearStyleCache(){this._cacheStyle=null}};Te=Zr([pi(0,s.Inject(D.DocSelectionManagerService)),pi(1,s.IUniverInstanceService),pi(2,_.IRenderManagerService)],Te);function fi(i,t,e){const n=[];for(let o=0,a=i.length;o<a;o++)i[o]===s.DataStreamTreeTokenType.PARAGRAPH&&n.push({startIndex:o});if(t)for(const o of n)t.bullet&&(o.bullet=s.Tools.deepClone(t.bullet)),t.paragraphStyle&&(o.paragraphStyle=s.Tools.deepClone(t.paragraphStyle),delete o.paragraphStyle.borderBottom,t.paragraphStyle.headingId&&(o.paragraphStyle.headingId=s.generateRandomId(6)));if(e)for(const o of n)o.paragraphStyle||(o.paragraphStyle={}),o.paragraphStyle.borderBottom=e;return n}const on={id:"doc.command.break-line",type:s.CommandType.COMMAND,handler:(i,t)=>{var Q,j,G,k,W;const e=i.get(D.DocSelectionManagerService),n=i.get(s.IUniverInstanceService),o=i.get(s.ICommandService),a=i.get(Te),r=(Q=t==null?void 0:t.textRange)!=null?Q:e.getActiveTextRange(),c=e.getRectRanges();if(r==null)return!1;if(c&&c.length){const{startOffset:z}=r;return e.replaceDocRanges([{startOffset:z,endOffset:z}]),!0}const{horizontalLine:l}=t!=null?t:{},{segmentId:A}=r,d=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A!=null?A:"").getBody();if(d==null||u==null)return!1;const m=d.getUnitId(),{startOffset:g,endOffset:h}=r,f=((j=u.paragraphs)!=null?j:[]).find(z=>z.startIndex>=g);if(!f)return!1;const S=g===f.startIndex,E=f.startIndex,C=a.getDefaultStyle(),b=a.getStyleCache(),R=Qt(u,h,C,b),I={dataStream:s.DataStreamTreeTokenType.PARAGRAPH,paragraphs:fi(s.DataStreamTreeTokenType.PARAGRAPH,f,l),textRuns:[{st:0,ed:1,ts:{...R.ts}}]};if(d==null)return!1;const O=e.getActiveTextRange();if(u==null)return!1;const{collapsed:M}=r,y=I.dataStream.length,N=[{startOffset:g+y,endOffset:g+y,style:O==null?void 0:O.style,collapsed:M}],x={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:N,debounce:!0}},w=new s.TextX,H=s.JSONX.getInstance();if(M)g>0&&w.push({t:s.TextXActionType.RETAIN,len:g}),w.push({t:s.TextXActionType.INSERT,body:I,len:I.dataStream.length});else{const z=s.BuildTextUtils.selection.delete([r],u,0,I);w.push(...z)}(((G=f.bullet)==null?void 0:G.listType)===s.PresetListType.CHECK_LIST_CHECKED||(k=f.paragraphStyle)!=null&&k.headingId)&&(r.endOffset<E&&w.push({t:s.TextXActionType.RETAIN,len:E-r.endOffset}),w.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...f,paragraphStyle:{...f.paragraphStyle,...S?{headingId:void 0,namedStyleType:void 0}:null},startIndex:0,bullet:(W=f.paragraphStyle)!=null&&W.headingId?void 0:{...f.bullet,listType:s.PresetListType.CHECK_LIST}}]},coverType:s.UpdateDocsAttributeType.REPLACE})),x.params.textRanges=[{startOffset:g+y,endOffset:g+y,collapsed:M}];const V=Z(d,A);return x.params.actions=H.editOp(w.serialize(),V),!!o.syncExecuteCommand(x.id,x.params)}},vt={id:"doc.command.horizontal-line",type:s.CommandType.COMMAND,handler:(i,t)=>i.get(s.ICommandService).syncExecuteCommand(on.id,{horizontalLine:{padding:5,color:{rgb:"#CDD0D8"},width:1,dashStyle:s.DashStyleType.SOLID},textRange:t==null?void 0:t.insertRange})},Si={id:"doc.command.insert-horizontal-line-bellow",type:s.CommandType.COMMAND,handler:i=>{const t=i.get(s.ICommandService),e=mt(i);return e?t.syncExecuteCommand(vt.id,{insertRange:{startOffset:e.startIndex+1,endOffset:e.startIndex+1}}):!1}};function ue(i,t,e){return e.executeCommand(be.id,{preCommandId:i,...t!=null?t:{}})}const vs="doc.command.set-inline-format-bold",De={id:vs,type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(s.ICommandService);return ue(vs,t,e)}},Is="doc.command.set-inline-format-italic",Be={id:Is,type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(s.ICommandService);return ue(Is,t,e)}},Es="doc.command.set-inline-format-underline",_e={id:Es,type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(s.ICommandService);return ue(Es,t,e)}},Cs="doc.command.set-inline-format-strikethrough",Ne={id:Cs,type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(s.ICommandService);return ue(Cs,t,e)}},Ts="doc.command.set-inline-format-subscript",ye={id:Ts,type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(s.ICommandService);return ue(Ts,t,e)}},ys="doc.command.set-inline-format-superscript",Pe={id:ys,type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(s.ICommandService);return ue(ys,t,e)}},bs="doc.command.set-inline-format-fontsize",he={id:bs,type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(s.ICommandService);return ue(bs,t,e)}},Os="doc.command.set-inline-format-font-family",We={id:Os,type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(s.ICommandService);return ue(Os,t,e)}},Rs="doc.command.set-inline-format-text-color",Ue={id:Rs,type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(s.ICommandService);return ue(Rs,t,e)}},Ms="doc.command.set-inline-format-text-background-color",we={id:Ms,type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(s.ICommandService);return ue(Ms,t,e)}},xs="doc.command.reset-inline-format-text-background-color",tt={id:xs,type:s.CommandType.COMMAND,handler:async(i,t)=>{const e=i.get(s.ICommandService);return ue(xs,t,e)}},vi={[De.id]:"bl",[Be.id]:"it",[_e.id]:"ul",[Ne.id]:"st",[he.id]:"fs",[We.id]:"ff",[Ue.id]:"cl",[we.id]:"bg",[tt.id]:"bg",[ye.id]:"va",[Pe.id]:"va"},be={id:"doc.command.set-inline-format",type:s.CommandType.COMMAND,handler:async(i,t)=>{var R;const{value:e,preCommandId:n}=t,o=i.get(s.ICommandService),a=i.get(D.DocSelectionManagerService),r=i.get(s.IUniverInstanceService),c=i.get(Te),l=a.getDocRanges(),A=(R=l.find(I=>I.isActive))!=null?R:l[0];if(l.length===0)return!1;const{segmentId:d}=l[0],u=r.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(u==null)return!1;const m=u.getSelfOrHeaderFooterModel(d).getBody();if(m==null)return!1;const g=u.getUnitId();let h;switch(n){case De.id:case Be.id:case _e.id:case Ne.id:case ye.id:case Pe.id:{const I=c.getDefaultStyle(),O=Bs(m,A,I);h=nc(O,n);break}case he.id:case We.id:{h=e;break}case Ue.id:case we.id:{h={rgb:e};break}case tt.id:{h={rgb:null};break}default:throw new Error(`Unknown command: ${n} in handleInlineFormat`)}const p={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:l}},f=new s.TextX,S=s.JSONX.getInstance(),E=new s.MemoryCursor;E.reset();for(const I of l){let{startOffset:O,endOffset:M,rangeType:y}=I;if(O==null||M==null)continue;if(y===s.DOC_RANGE_TYPE.RECT&&(O=O-1),O===M){const w=c.getStyleCache(),H=vi[n];c.setStyleCache({[H]:(w==null?void 0:w[H])!==void 0?Ds(w,H,n):h});continue}const N={dataStream:"",textRuns:[{st:0,ed:M-O,ts:{[vi[n]]:h}}]},x=O-E.cursor;x!==0&&f.push({t:s.TextXActionType.RETAIN,len:x}),f.push({t:s.TextXActionType.RETAIN,body:N,len:M-O}),E.reset(),E.moveCursor(M)}const C=Z(u,d);return p.params.actions=S.editOp(f.serialize(),C),!!o.syncExecuteCommand(p.id,p.params)}};function tc(i){return i!==null&&typeof i=="object"}function Ds(i,t,e){if(/bl|it/.test(t))return(i==null?void 0:i[t])===s.BooleanNumber.TRUE?s.BooleanNumber.FALSE:s.BooleanNumber.TRUE;if(/ul|st/.test(t))return tc(i==null?void 0:i[t])&&(i==null?void 0:i[t]).s===s.BooleanNumber.TRUE?{s:s.BooleanNumber.FALSE}:{s:s.BooleanNumber.TRUE};if(/va/.test(t))return e===ye.id?(i==null?void 0:i[t])===s.BaselineOffset.SUBSCRIPT?s.BaselineOffset.NORMAL:s.BaselineOffset.SUBSCRIPT:(i==null?void 0:i[t])===s.BaselineOffset.SUPERSCRIPT?s.BaselineOffset.NORMAL:s.BaselineOffset.SUPERSCRIPT}function Bs(i,t,e){var d,u,m,g,h,p,f,S,E,C,b,R,I,O;const{startOffset:n,endOffset:o,collapsed:a}=t;if(a){const M=(d=i.textRuns)!=null?d:[];let y=null;for(let N=M.length-1;N>=0;N--){const x=M[N];if(x.st<n&&n<=x.ed){y=x;break}}return y!=null&&y.ts?{...e,...y.ts}:e}const{textRuns:r=[]}=s.getBodySlice(i,n,o),c=s.Tools.deepClone(e),l=r.map(M=>{var y;return(y=M==null?void 0:M.ts)==null?void 0:y.fs}).filter(Boolean);c.fs=c.fs?Math.max(c.fs,...l):l.length?Math.max(...l):void 0,c.fs=!c.fs||Number.isNaN(c.fs)?void 0:c.fs,c.ff=(g=(m=(u=r.find(M=>{var y;return((y=M.ts)==null?void 0:y.ff)!=null}))==null?void 0:u.ts)==null?void 0:m.ff)!=null?g:c.ff,c.it=r.length&&r.every(M=>{var y;return((y=M.ts)==null?void 0:y.it)===s.BooleanNumber.TRUE})?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE,c.bl=r.length&&r.every(M=>{var y;return((y=M.ts)==null?void 0:y.bl)===s.BooleanNumber.TRUE})?s.BooleanNumber.TRUE:s.BooleanNumber.FALSE,c.ul=r.length&&r.every(M=>{var y,N;return((N=(y=M.ts)==null?void 0:y.ul)==null?void 0:N.s)===s.BooleanNumber.TRUE})?(h=r[0].ts)==null?void 0:h.ul:c.ul,c.st=r.length&&r.every(M=>{var y,N;return((N=(y=M.ts)==null?void 0:y.st)==null?void 0:N.s)===s.BooleanNumber.TRUE})?(p=r[0].ts)==null?void 0:p.st:c.st,c.bg=(E=(S=(f=r.find(M=>{var y;return((y=M.ts)==null?void 0:y.bg)!=null}))==null?void 0:f.ts)==null?void 0:S.bg)!=null?E:c.bg,c.cl=(R=(b=(C=r.find(M=>{var y;return((y=M.ts)==null?void 0:y.cl)!=null}))==null?void 0:C.ts)==null?void 0:b.cl)!=null?R:c.cl;const A=r.filter(M=>{var y;return((y=M==null?void 0:M.ts)==null?void 0:y.va)!=null});if(A.length>0&&A.length===r.length){const M=(I=A[0].ts)==null?void 0:I.va;let y=!0;for(let N=1;N<A.length;N++)if(((O=A[N].ts)==null?void 0:O.va)!==M){y=!1;break}y&&(c.va=M)}return c}function nc(i,t){const e=vi[t];return Ds(i,e,t)}const nt={id:"doc.command.list-operation",type:s.CommandType.COMMAND,handler:(i,t)=>{var b,R,I,O,M,y;const e=i.get(D.DocSelectionManagerService),n=i.get(s.IUniverInstanceService),o=i.get(s.ICommandService),a=t.listType,r=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=(R=(b=t.docRange)!=null?b:e.getDocRanges())!=null?R:[];if(r==null||c.length===0)return!1;const l=c[0].segmentId,A=r.getSelfOrHeaderFooterModel(l),d=(O=(I=A.getBody())==null?void 0:I.paragraphs)!=null?O:[],u=(y=(M=A.getBody())==null?void 0:M.dataStream)!=null?y:"";if(!d.length)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),g=r.getUnitId(),h={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:c,isEditing:!1}};new s.MemoryCursor().reset();const f=s.BuildTextUtils.paragraph.bullet.switch({paragraphs:m,listType:a,document:r,segmentId:l}),S=s.JSONX.getInstance(),E=Z(r,l);return h.params.actions=S.editOp(f.serialize(),E),!!o.syncExecuteCommand(h.id,h.params)}},It={id:"doc.command.change-list-type",type:s.CommandType.COMMAND,handler:(i,t)=>{var C,b,R,I,O;const e=i.get(D.DocSelectionManagerService),n=i.get(s.IUniverInstanceService),o=i.get(s.ICommandService),{listType:a}=t,r=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=(C=t.docRange)!=null?C:e.getDocRanges();if(r==null||c==null||!c.length)return!1;const{segmentId:l}=c[0],A=r.getSelfOrHeaderFooterModel(l),d=(R=(b=A.getBody())==null?void 0:b.paragraphs)!=null?R:[],u=(O=(I=A.getBody())==null?void 0:I.dataStream)!=null?O:"";if(!d.length)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),g=r.getUnitId(),h=s.BuildTextUtils.paragraph.bullet.set({paragraphs:m,listType:a,segmentId:l,document:r});if(!h)return!1;const p=s.JSONX.getInstance(),f={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:c,isEditing:!1}},S=Z(r,l);return f.params.actions=p.editOp(h.serialize(),S),!!o.syncExecuteCommand(f.id,f.params)}};var Et=(i=>(i[i.increase=1]="increase",i[i.decrease=-1]="decrease",i))(Et||{});const sn={id:"doc.command.change-list-nesting-level",type:s.CommandType.COMMAND,handler:(i,t)=>{var b,R,I,O,M;if(!t)return!1;const{type:e}=t,n=i.get(D.DocSelectionManagerService),o=i.get(s.IUniverInstanceService),a=i.get(s.ICommandService),r=o.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=n.getActiveTextRange();if(r==null||c==null)return!1;const{segmentId:l}=c,A=(b=n.getDocRanges())!=null?b:[],d=r.getSelfOrHeaderFooterModel(l),u=(I=(R=d.getBody())==null?void 0:R.paragraphs)!=null?I:[],m=(M=(O=d.getBody())==null?void 0:O.dataStream)!=null?M:"";if(!u.length)return!1;const g=s.BuildTextUtils.range.getParagraphsInRange(c,u,m),h=r.getUnitId(),p=s.JSONX.getInstance(),f=s.BuildTextUtils.paragraph.bullet.changeNestLevel({paragraphs:g,type:e,segmentId:l,document:r}),S={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:A,isEditing:!1}},E=Z(r,l);return S.params.actions=p.editOp(f.serialize(),E),!!a.syncExecuteCommand(S.id,S.params)}},it={id:"doc.command.bullet-list",type:s.CommandType.COMMAND,handler:(i,t)=>{const e=i.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(It.id,{listType:t.value,docRange:t.docRange}):e.syncExecuteCommand(nt.id,{listType:s.PresetListType.BULLET_LIST,docRange:t==null?void 0:t.docRange})}},Ct={id:"doc.command.check-list",type:s.CommandType.COMMAND,handler:(i,t)=>{const e=i.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(It.id,{listType:t.value,docRange:t.docRange}):e.syncExecuteCommand(nt.id,{listType:s.PresetListType.CHECK_LIST,docRange:t==null?void 0:t.docRange})}},Ii={id:"doc.command.toggle-check-list",type:s.CommandType.COMMAND,handler:(i,t)=>{var p;if(!t)return!1;const e=i.get(s.IUniverInstanceService),n=i.get(s.ICommandService),{index:o,segmentId:a,textRanges:r}=t,c=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(c==null||((p=c.getSelfOrHeaderFooterModel(a).getBody())==null?void 0:p.paragraphs)==null)return!1;const A=c.getUnitId(),d={id:D.RichTextEditingMutation.id,params:{unitId:A,actions:[],textRanges:r!=null?r:[],segmentId:a,isEditing:!1}},u=s.BuildTextUtils.paragraph.bullet.toggleChecklist({document:c,paragraphIndex:o,segmentId:a});if(!u)return!1;const m=s.JSONX.getInstance(),g=Z(c,a);return d.params.actions=m.editOp(u.serialize(),g),!!n.syncExecuteCommand(d.id,d.params)}},ot={id:"doc.command.order-list",type:s.CommandType.COMMAND,handler:(i,t)=>{const e=i.get(s.ICommandService);return t!=null&&t.value?e.syncExecuteCommand(It.id,{listType:t.value}):e.syncExecuteCommand(nt.id,{listType:s.PresetListType.ORDER_LIST})}},Ei={id:"doc.command.quick-list",type:s.CommandType.COMMAND,handler(i,t){var X,Y,q,K,$;if(!t)return!1;const e=i.get(D.DocSelectionManagerService),n=i.get(s.IUniverInstanceService),o=i.get(s.ICommandService),a=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=e.getActiveTextRange();if(a==null||r==null)return!1;const{segmentId:c,startOffset:l}=r,{listType:A,paragraph:d}=t,{paragraphStart:u,paragraphEnd:m}=d,g=new s.TextX,h=s.JSONX.getInstance(),{defaultTabStop:p=36}=a.getSnapshot().documentStyle,f=(Y=(X=a.getSelfOrHeaderFooterModel(c).getBody())==null?void 0:X.sectionBreaks)!=null?Y:[],{startIndex:S,paragraphStyle:E={}}=d,{indentFirstLine:C,snapToGrid:b,indentStart:R}=E,I=s.PRESET_LIST_TYPE[A].nestingLevel[0].paragraphProperties||{},{hanging:O,indentStart:M}=I,y=I.textStyle,{charSpace:N,gridType:x}=ic(S,f)||{charSpace:0,gridType:s.GridType.LINES},w=_.getCharSpaceApply(N,p,x,b);let V=s.Tools.generateRandomId(6);const F=(K=(q=a.getBody())==null?void 0:q.paragraphs)!=null?K:[],Q=F.findIndex(ie=>ie.startIndex===d.startIndex),j=F[Q-1],G=F[Q+1];j&&j.bullet&&j.bullet.listType.indexOf(A)===0?V=j.bullet.listId:G&&G.bullet&&G.bullet.listType.indexOf(A)===0&&(V=G.bullet.listId);const k={id:D.RichTextEditingMutation.id,params:{unitId:a.getUnitId(),actions:[],textRanges:[{startOffset:u,endOffset:u,collapsed:!0}],isEditing:!1}};g.push({t:s.TextXActionType.RETAIN,len:u}),g.push({t:s.TextXActionType.DELETE,len:l-u}),m>l&&g.push({t:s.TextXActionType.RETAIN,len:m-l}),g.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{startIndex:0,paragraphStyle:{...E,textStyle:{...E.textStyle,...y},indentFirstLine:void 0,hanging:O,indentStart:{v:_.getNumberUnitValue(M,w)-_.getNumberUnitValue(O,w)+_.getNumberUnitValue(C,w)+_.getNumberUnitValue(R,w)}},bullet:{...($=d.bullet)!=null?$:{nestingLevel:0,textStyle:{fs:20}},listType:A,listId:V}}]}});const W=Z(a,c);return k.params.actions=h.editOp(g.serialize(),W),!!o.syncExecuteCommand(k.id,k.params)}};function Ci(i,t){var d,u;const e=i.get(s.ICommandService),n=mt(i);if(!n)return!1;const o=i.get(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!o)return!1;const a=s.BuildTextUtils.selection.replace({doc:o,selection:{startOffset:n.startIndex+1,endOffset:n.startIndex+1,collapsed:!0},body:{dataStream:"\r",paragraphs:[{startIndex:0,paragraphStyle:{...n.paragraphStyle},bullet:{listType:t,listId:((d=n.bullet)==null?void 0:d.listType)===t?n.bullet.listId:s.Tools.generateRandomId(6),nestingLevel:((u=n.bullet)==null?void 0:u.listType)===t?n.bullet.nestingLevel:0}}]}});if(!a)return!1;const r={id:D.RichTextEditingMutation.id,params:{unitId:o.getUnitId(),actions:[],textRanges:[{startOffset:n.startIndex+1,endOffset:n.startIndex+1,collapsed:!0}],isEditing:!1}},c=s.JSONX.getInstance(),l=Z(o);return r.params.actions=c.editOp(a.serialize(),l),!!e.syncExecuteCommand(r.id,r.params)}const Ti={id:"doc.command.insert-bullet-list-bellow",type:s.CommandType.COMMAND,handler:i=>Ci(i,s.PresetListType.BULLET_LIST)},yi={id:"doc.command.insert-order-list-bellow",type:s.CommandType.COMMAND,handler:i=>Ci(i,s.PresetListType.ORDER_LIST)},bi={id:"doc.command.insert-check-list-bellow",type:s.CommandType.COMMAND,handler:i=>Ci(i,s.PresetListType.CHECK_LIST)};function ic(i,t){const e=t.sort(s.sortRulesFactory("startIndex"));for(let n=0;n<e.length;n++){const o=t[n];if(o.startIndex>=i)return o}}const de={id:"doc.command.set-paragraph-named-style",type:s.CommandType.COMMAND,handler(i,t){var h;if(!t)return!1;const n=i.get(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!n)return!1;const o=n.getUnitId(),a=i.get(D.DocSelectionManagerService),r=(h=t.textRanges)!=null?h:a.getTextRanges({unitId:o,subUnitId:o});if(!(r!=null&&r.length))return!1;const c=r[0].segmentId,l=s.BuildTextUtils.paragraph.style.set({document:n.getSelfOrHeaderFooterModel(c),textRanges:r,style:{namedStyleType:t.value,headingId:!t.value||t.value===s.NamedStyleType.NORMAL_TEXT?void 0:s.generateRandomId(6),spaceAbove:void 0,spaceBelow:void 0},paragraphTextRun:{}}),A={id:D.RichTextEditingMutation.id,params:{actions:[],textRanges:r,unitId:o,segmentId:c}},d=s.JSONX.getInstance(),u=Z(n,c);return A.params.actions=d.editOp(l.serialize(),u),!!i.get(s.ICommandService).syncExecuteCommand(A.id,A.params)}},_s={id:"doc.command.quick-heading",type:s.CommandType.COMMAND,handler(i,t){var R,I,O,M;if(!t)return!1;const{value:e}=t,n=i.get(D.DocSelectionManagerService),o=i.get(s.IUniverInstanceService),a=i.get(s.ICommandService),r=o.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),c=n.getActiveTextRange();if(r==null||c==null||!c.collapsed)return!1;const{segmentId:l,startOffset:A}=c,d=r.getSelfOrHeaderFooterModel(l),u=(I=(R=d.getBody())==null?void 0:R.paragraphs)!=null?I:[],m=(M=(O=d.getBody())==null?void 0:O.dataStream)!=null?M:"",g=s.BuildTextUtils.paragraph.util.getParagraphsInRange(c,u,m)[0];if(!g)return!1;const{paragraphStart:h}=g,p=new s.TextX,f=s.JSONX.getInstance(),{paragraphStyle:S={}}=g,E={id:D.RichTextEditingMutation.id,params:{unitId:r.getUnitId(),actions:[],textRanges:[{startOffset:h,endOffset:h,collapsed:!0}],isEditing:!1}};p.push({t:s.TextXActionType.RETAIN,len:h}),s.BuildTextUtils.paragraph.style.set({textRanges:[c],document:r,style:{...S,headingId:s.generateRandomId(6),namedStyleType:e},cursor:A,deleteLen:A-h,textX:p,paragraphTextRun:{}});const C=Z(r,l);return E.params.actions=f.editOp(p.serialize(),C),!!a.syncExecuteCommand(E.id,E.params)}},Oi={"#":s.NamedStyleType.HEADING_1,"##":s.NamedStyleType.HEADING_2,"###":s.NamedStyleType.HEADING_3,"####":s.NamedStyleType.HEADING_4,"#####":s.NamedStyleType.HEADING_5},Ri={id:"doc.command.h1-heading",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(de.id,{value:s.NamedStyleType.HEADING_1})},Mi={id:"doc.command.h2-heading",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(de.id,{value:s.NamedStyleType.HEADING_2})},xi={id:"doc.command.h3-heading",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(de.id,{value:s.NamedStyleType.HEADING_3})},Di={id:"doc.command.h4-heading",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(de.id,{value:s.NamedStyleType.HEADING_4})},Bi={id:"doc.command.h5-heading",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(de.id,{value:s.NamedStyleType.HEADING_5})},an={id:"doc.command.normal-text-heading",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(de.id,{value:s.NamedStyleType.NORMAL_TEXT})},Ns={id:"doc.command.title",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(de.id,{value:s.NamedStyleType.TITLE})},Ps={id:"doc.command.subtitle-heading",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(de.id,{value:s.NamedStyleType.SUBTITLE})},me={id:"doc.command.align-action",type:s.CommandType.COMMAND,handler:(i,t)=>{var R,I,O,M;const e=i.get(D.DocSelectionManagerService),n=i.get(s.IUniverInstanceService),o=i.get(s.ICommandService),{alignType:a}=t,r=n.getCurrentUniverDocInstance();if(r==null)return!1;const c=e.getDocRanges();if(c.length===0)return!1;const l=c[0].segmentId,A=r.getSelfOrHeaderFooterModel(l),d=(I=(R=A.getBody())==null?void 0:R.paragraphs)!=null?I:[],u=(M=(O=A.getBody())==null?void 0:O.dataStream)!=null?M:"";if(d==null)return!1;const m=s.BuildTextUtils.range.getParagraphsInRanges(c,d,u),g=r.getUnitId(),h=m.every(y=>{var N;return((N=y.paragraphStyle)==null?void 0:N.horizontalAlign)===a}),p={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:c}},f=new s.MemoryCursor;f.reset();const S=new s.TextX,E=s.JSONX.getInstance();for(const y of m){const{startIndex:N}=y;S.push({t:s.TextXActionType.RETAIN,len:N-f.cursor});const x={...y.paragraphStyle,horizontalAlign:h?s.HorizontalAlign.UNSPECIFIED:a};S.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...y,paragraphStyle:x,startIndex:0}]},coverType:s.UpdateDocsAttributeType.REPLACE}),f.moveCursorTo(N+1)}const C=Z(r,l);return p.params.actions=E.editOp(S.serialize(),C),!!o.syncExecuteCommand(p.id,p.params)}},Tt={id:"doc.command.align-left",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(me.id,{alignType:s.HorizontalAlign.LEFT})},yt={id:"doc.command.align-center",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(me.id,{alignType:s.HorizontalAlign.CENTER})},bt={id:"doc.command.align-right",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(me.id,{alignType:s.HorizontalAlign.RIGHT})},Ot={id:"doc.command.align-justify",type:s.CommandType.COMMAND,handler:i=>i.get(s.ICommandService).syncExecuteCommand(me.id,{alignType:s.HorizontalAlign.JUSTIFIED})},Rt={id:"doc.command.switch-mode",type:s.CommandType.COMMAND,handler:i=>{var E,C,b,R,I;const t=i.get(s.ICommandService),e=i.get(_.IRenderManagerService),n=i.get(D.DocSelectionManagerService),a=i.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(a==null)return!1;const r=a.getUnitId(),c=(E=e.getRenderById(r))==null?void 0:E.with(D.DocSkeletonManagerService).getSkeleton(),l=(C=e.getRenderById(r))==null?void 0:C.with(T.DocSelectionRenderService);if(c==null||l==null)return!1;const A=l==null?void 0:l.getSegment(),d=l==null?void 0:l.getSegmentPage(),u=a.getSnapshot().documentStyle.documentFlavor,m=n.getDocRanges(),g={id:D.RichTextEditingMutation.id,params:{unitId:r,actions:[],textRanges:u===s.DocumentFlavor.TRADITIONAL&&A?[]:m}},h=s.JSONX.getInstance(),p=[];let f;if(u===void 0?f=h.insertOp(["documentStyle","documentFlavor"],s.DocumentFlavor.MODERN):u===s.DocumentFlavor.MODERN?f=h.replaceOp(["documentStyle","documentFlavor"],u,s.DocumentFlavor.TRADITIONAL):f=h.replaceOp(["documentStyle","documentFlavor"],u,s.DocumentFlavor.MODERN),f)p.push(f);else return!1;if(u!==s.DocumentFlavor.MODERN){const O=a.getSnapshot(),{drawings:M={},body:y}=O,N=(b=y==null?void 0:y.customBlocks)!=null?b:[];for(const x in M){const w=M[x],H=N.find($=>$.blockId===x);if(H==null)continue;const V=w.docTransform.positionV,{relativeFrom:F,posOffset:Q}=V;if(F===s.ObjectRelativeFromV.PARAGRAPH)continue;const{startIndex:j}=H,G=c.findNodeByCharIndex(j,A,d),k=(R=G==null?void 0:G.parent)==null?void 0:R.parent,W=k==null?void 0:k.parent,z=W==null?void 0:W.lines.find($=>$.paragraphIndex===(k==null?void 0:k.paragraphIndex)&&$.paragraphStart),X=(I=W==null?void 0:W.parent)==null?void 0:I.parent;if(G==null||k==null||z==null||W==null||X==null)continue;let Y=0;F===s.ObjectRelativeFromV.LINE?Y-=k.top:F===s.ObjectRelativeFromV.PAGE&&(Y+=X.marginTop),Y+=z.top;const q={...V,relativeFrom:s.ObjectRelativeFromV.PARAGRAPH,posOffset:(Q!=null?Q:0)-Y},K=h.replaceOp(["drawings",x,"docTransform","positionV"],V,q);K&&p.push(K)}}return g.params.actions=p.reduce((O,M)=>s.JSONX.compose(O,M),null),!!t.syncExecuteCommand(g.id,g.params)}},Us="COMPONENT_DOC_CREATE_TABLE_CONFIRM",_i={id:"doc.command.create-table",type:s.CommandType.COMMAND,handler:async(i,t)=>{var q,K,$,ie,fe;const{rowCount:e,colCount:n}=t,o=i.get(D.DocSelectionManagerService),a=i.get(s.IUniverInstanceService),r=i.get(s.ICommandService),c=i.get(Te),l=o.getActiveTextRange();if(l==null)return!1;const{segmentId:A,segmentPage:d}=l,u=a.getCurrentUniverDocInstance(),m=u==null?void 0:u.getSelfOrHeaderFooterModel(A).getBody();if(u==null||m==null)return!1;const g=u.getUnitId(),h=re(i,g),p=h==null?void 0:h.getSkeleton();if(p==null)return!1;const{startOffset:f}=l,E=((q=m.paragraphs)!=null?q:[]).find(Fe=>Fe.startIndex>=f),C=p.findNodeByCharIndex(f,A,d);if(C==null)return!1;const b=new s.TextX,R=s.JSONX.getInstance(),I=[],O=f+4,M=[{startOffset:O,endOffset:O,collapsed:!0}],y={id:D.RichTextEditingMutation.id,params:{unitId:g,actions:[],textRanges:M}};f>0&&b.push({t:s.TextXActionType.RETAIN,len:f}),b.push({t:s.TextXActionType.INSERT,body:{dataStream:s.DataStreamTreeTokenType.PARAGRAPH,paragraphs:fi(s.DataStreamTreeTokenType.PARAGRAPH,E)},len:1});const N=c.getDefaultStyle(),x=c.getStyleCache(),w=Qt(m,f,N,x),{dataStream:H,paragraphs:V,sectionBreaks:F}=Rr(e,n),Q=(fe=(ie=($=(K=C.parent)==null?void 0:K.parent)==null?void 0:$.parent)==null?void 0:ie.parent)==null?void 0:fe.parent;if(Q==null)return!1;const{pageWidth:j,marginLeft:G,marginRight:k}=Q,W=ni(e,n,j-G-k);b.push({t:s.TextXActionType.INSERT,body:{dataStream:H,paragraphs:V,sectionBreaks:F,textRuns:[{...w,st:0,ed:H.length}],tables:[{startIndex:0,endIndex:H.length,tableId:W.tableId}]},len:H.length});const z=Z(u,A);I.push(R.editOp(b.serialize(),z));const X=R.insertOp(["tableSource",W.tableId],W);return I.push(X),y.params.actions=I.reduce((Fe,Se)=>s.JSONX.compose(Fe,Se),null),!!r.syncExecuteCommand(y.id,y.params)}},Ni="doc.component.create-table-confirm",rn={id:"doc.operation.create-table",type:s.CommandType.COMMAND,handler:async i=>{const t=i.get(s.LocaleService),e=i.get(v.IConfirmService),n=i.get(s.ICommandService),o={rowCount:3,colCount:5},a=(r,c)=>{o.rowCount=r,o.colCount=c};return await e.open({id:Ni,children:{label:{name:Us,props:{handleRowColChange:a,tableCreateParams:o}}},width:400,title:{title:t.t("toolbar.table.insert")},onConfirm:()=>{n.executeCommand(_i.id,o),e.close(Ni)},onClose:()=>{e.close(Ni)}}),!0}},oc=i=>{const e=Object.keys(s.PAGE_SIZE).find(n=>{const{width:o,height:a}=s.PAGE_SIZE[n];return i.width===o&&i.height===a});return e!=null?e:"A4"};function sc(i){const{hooks:t}=i,o=v.useDependency(s.IUniverInstanceService).getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC).getDocumentStyle(),a=v.useDependency(s.LocaleService),[r,c]=U.useState(()=>{var d,u,m,g,h;return{paperSize:oc(o.pageSize),orientation:(d=o.pageOrient)!=null?d:s.PageOrientType.PORTRAIT,margins:{top:(u=o.marginTop)!=null?u:0,bottom:(m=o.marginBottom)!=null?m:0,left:(g=o.marginLeft)!=null?g:0,right:(h=o.marginRight)!=null?h:0}}});U.useEffect(()=>{t.beforeClose=()=>r,t.beforeConfirm=()=>r},[r]);const l=d=>{c(u=>({...u,paperSize:d}))},A=(d,u)=>{c(m=>({...m,margins:{...m.margins,[d]:u||0}}))};return P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-4",children:[P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:univer-text-white",children:a.t("page-settings.paper-size")}),P.jsx(J.Select,{value:r.paperSize,onChange:l,options:s.PAPER_TYPES.map(d=>({label:a.t(`page-settings.page-size.${d.toLocaleLowerCase()}`),value:d}))})]}),P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-900 dark:univer-text-white",children:a.t("page-settings.custom-paper-size")}),P.jsxs("div",{className:"univer-flex univer-flex-col univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.top")}),P.jsx(J.InputNumber,{value:r.margins.top,onChange:d=>A("top",d)})]}),P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.bottom")}),P.jsx(J.InputNumber,{value:r.margins.bottom,onChange:d=>A("bottom",d)})]})]}),P.jsxs("div",{className:"univer-flex univer-gap-2.5",children:[P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.left")}),P.jsx(J.InputNumber,{value:r.margins.left,onChange:d=>A("left",d)})]}),P.jsxs("div",{className:"univer-flex univer-flex-1 univer-flex-col univer-gap-2",children:[P.jsx("label",{className:"univer-text-sm univer-font-medium univer-text-gray-500",children:a.t("page-settings.right")}),P.jsx(J.InputNumber,{value:r.margins.right,onChange:d=>A("right",d)})]})]})]})]})]})}const Pi="docs.component.page-setting",ws={id:"docs.command.page-setup",type:s.CommandType.COMMAND,handler:(i,t)=>{if(!t)return!1;const e=i.get(s.IUniverInstanceService),n=i.get(s.ICommandService),o=e.getCurrentUnitOfType(s.UniverInstanceType.UNIVER_DOC);if(!o)return!1;const{marginLeft:a,marginRight:r,marginBottom:c,marginTop:l,pageOrient:A,pageSize:d}=t,u=s.JSONX.getInstance(),m=o.getDocumentStyle(),{marginBottom:g,marginLeft:h,marginRight:p,marginTop:f,pageOrient:S,pageSize:E}=m,C=[];if(g===void 0){const I=u.insertOp(["documentStyle","marginBottom"],c);I&&C.push(I)}else{const I=u.replaceOp(["documentStyle","marginBottom"],g,c);I&&C.push(I)}if(h===void 0){const I=u.insertOp(["documentStyle","marginLeft"],a);I&&C.push(I)}else{const I=u.replaceOp(["documentStyle","marginLeft"],h,a);I&&C.push(I)}if(p===void 0){const I=u.insertOp(["documentStyle","marginRight"],r);I&&C.push(I)}else{const I=u.replaceOp(["documentStyle","marginRight"],p,r);I&&C.push(I)}if(f===void 0){const I=u.insertOp(["documentStyle","marginTop"],l);I&&C.push(I)}else{const I=u.replaceOp(["documentStyle","marginTop"],f,l);I&&C.push(I)}if(E===void 0){const I=u.insertOp(["documentStyle","pageSize"],d);I&&C.push(I)}else{const I=u.replaceOp(["documentStyle","pageSize"],E,d);I&&C.push(I)}if(S===void 0){const I=u.insertOp(["documentStyle","pageOrient"],A);I&&C.push(I)}else{const I=u.replaceOp(["documentStyle","pageOrient"],S,A);I&&C.push(I)}const b={id:D.RichTextEditingMutation.id,params:{unitId:o.getUnitId(),actions:[],textRanges:void 0}};return b.params.actions=C.reduce((I,O)=>s.JSONX.compose(I,O),null),!!n.syncExecuteCommand(b.id,b.params)}},Ui={id:"docs.operation.open-page-setting",type:s.CommandType.OPERATION,handler:i=>{const t=i.get(v.IConfirmService),e=i.get(s.ICommandService),n=i.get(s.LocaleService),o=t.open({id:Pi,title:{label:n.t("page-settings.document-setting")},children:{label:Pi},width:528,onClose:()=>{o.dispose()},onConfirm:a=>{if(o.dispose(),!a)return;const r=s.PAGE_SIZE[a.paperSize];e.executeCommand(ws.id,{pageOrient:a.orientation,marginTop:a.margins.top,marginBottom:a.margins.bottom,marginLeft:a.margins.left,marginRight:a.margins.right,pageSize:r})}});return!0}};function ac(i){const t=i.get(s.IUniverInstanceService),e=i.get(_.IRenderManagerService);return new L.Observable(n=>{const o=t.focused$.subscribe(a=>{if(a==null||t.getUnitType(a)!==s.UniverInstanceType.UNIVER_DOC)return n.next(!0);const c=e.getRenderById(a);if(c==null)return n.next(!0);c.with(D.DocSkeletonManagerService).getViewModel().editAreaChange$.subscribe(A=>{n.next(A===_.DocumentEditArea.HEADER||A===_.DocumentEditArea.FOOTER)})});return()=>o.unsubscribe()})}function rc(i){const t=i.get(s.IUniverInstanceService),e=i.get(s.ICommandService);return new L.Observable(n=>{const o=e.onCommandExecuted(l=>{if(l.id===D.RichTextEditingMutation.id){const{unitId:A}=l.params,d=t.getUnit(A);if(d==null){n.next(!0);return}const{documentStyle:u}=d.getSnapshot();n.next((u==null?void 0:u.documentFlavor)!==s.DocumentFlavor.TRADITIONAL)}}),a=t.focused$.subscribe(l=>{if(l==null)return n.next(!0);const A=t.getUniverDocInstance(l),d=A==null?void 0:A.getSnapshot().documentStyle.documentFlavor;n.next(d!==s.DocumentFlavor.TRADITIONAL)}),r=t.getCurrentUniverDocInstance();if(r==null)return n.next(!0);const c=r==null?void 0:r.getSnapshot().documentStyle.documentFlavor;return n.next(c!==s.DocumentFlavor.TRADITIONAL),()=>{o.dispose(),a.unsubscribe()}})}function cc(i){const t=i.get(D.DocSelectionManagerService),e=i.get(s.IUniverInstanceService);return new L.Observable(n=>{const o=t.textSelection$.subscribe(a=>{if(a==null){n.next(!0);return}const{textRanges:r}=a;if(r.length!==1){n.next(!0);return}const c=r[0],{collapsed:l,startNodePosition:A,startOffset:d}=c;if(!l||d==null){n.next(!0);return}const u=e.getCurrentUniverDocInstance();if(u==null){n.next(!0);return}const m=re(i,u.getUnitId());if(m==null){n.next(!0);return}if(m.getViewModel().getCustomRangeRaw(d)){n.next(!0);return}if(A!=null){const{path:p}=A;if(p.indexOf("cells")!==-1){n.next(!0);return}}n.next(!1)});return()=>o.unsubscribe()})}function te(i){const t=i.get(D.DocSelectionManagerService);return new L.Observable(e=>{const n=t.textSelection$.subscribe(o=>{if(o==null){e.next(!0);return}const{textRanges:a,rectRanges:r}=o;if(a.length===0&&r.length===0){e.next(!0);return}e.next(!1)});return()=>n.unsubscribe()})}function lc(i){const t=i.get(s.ICommandService);return{id:De.id,type:v.MenuItemType.BUTTON,icon:"BoldSingle",title:"Set bold",tooltip:"toolbar.bold",activated$:new L.Observable(e=>{const n=()=>{var c;const a=Le(i);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.bl;e.next(r===s.BooleanNumber.TRUE)},o=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===be.id)&&n()});return n(),o.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function dc(i){const t=i.get(s.ICommandService);return{id:Be.id,type:v.MenuItemType.BUTTON,icon:"ItalicSingle",title:"Set italic",tooltip:"toolbar.italic",activated$:new L.Observable(e=>{const n=()=>{var c;const a=Le(i);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.it;e.next(r===s.BooleanNumber.TRUE)},o=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===be.id)&&n()});return n(),o.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function Ac(i){const t=i.get(s.ICommandService);return{id:_e.id,type:v.MenuItemType.BUTTON,icon:"UnderlineSingle",title:"Set underline",tooltip:"toolbar.underline",activated$:new L.Observable(e=>{const n=()=>{var c;const a=Le(i);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.ul;e.next((r==null?void 0:r.s)===s.BooleanNumber.TRUE)},o=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===be.id)&&n()});return n(),o.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function uc(i){const t=i.get(s.ICommandService);return{id:Ne.id,type:v.MenuItemType.BUTTON,icon:"StrikethroughSingle",title:"Set strike through",tooltip:"toolbar.strikethrough",activated$:new L.Observable(e=>{const n=()=>{var c;const a=Le(i);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.st;e.next((r==null?void 0:r.s)===s.BooleanNumber.TRUE)},o=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===be.id)&&n()});return n(),o.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function gc(i){const t=i.get(s.ICommandService);return{id:ye.id,type:v.MenuItemType.BUTTON,icon:"SubscriptSingle",tooltip:"toolbar.subscript",activated$:new L.Observable(e=>{const n=()=>{var c;const a=Le(i);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.va;e.next(r===s.BaselineOffset.SUBSCRIPT)},o=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===be.id)&&n()});return n(),o.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function hc(i){const t=i.get(s.ICommandService);return{id:Pe.id,type:v.MenuItemType.BUTTON,icon:"SuperscriptSingle",tooltip:"toolbar.superscript",activated$:new L.Observable(e=>{const n=()=>{var c;const a=Le(i);if(a==null){e.next(!1);return}const r=(c=a.ts)==null?void 0:c.va;e.next(r===s.BaselineOffset.SUPERSCRIPT)},o=t.onCommandExecuted(a=>{const r=a.id;(r===D.SetTextSelectionsOperation.id||r===be.id)&&n()});return n(),o.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function mc(i){const t=i.get(s.ICommandService);return{id:We.id,tooltip:"toolbar.font",type:v.MenuItemType.SELECTOR,label:qo,selections:v.FONT_FAMILY_LIST.map(e=>({label:{name:Jo},value:e.value})),value$:new L.Observable(e=>{const n=s.DEFAULT_STYLES.ff,o=()=>{var l;const r=Le(i);if(r==null){e.next(n);return}const c=(l=r.ts)==null?void 0:l.ff;e.next(c!=null?c:n)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===We.id)&&o()});return o(),a.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function pc(i){const t=i.get(s.ICommandService);return{id:he.id,type:v.MenuItemType.SELECTOR,tooltip:"toolbar.fontSize",label:{name:Zo,props:{min:1,max:400}},selections:v.FONT_SIZE_LIST,value$:new L.Observable(e=>{const n=s.DEFAULT_STYLES.fs,o=()=>{var l;const r=Le(i);if(r==null){e.next(n);return}const c=(l=r.ts)==null?void 0:l.fs;e.next(c!=null?c:n)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===he.id)&&o()});return o(),a.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function fc(i){const t=i.get(s.ICommandService);return{id:de.id,type:v.MenuItemType.SELECTOR,tooltip:"toolbar.heading.tooltip",label:{name:v.COMMON_LABEL_COMPONENT,props:{selections:v.HEADING_LIST}},selections:v.HEADING_LIST.map(e=>({label:{name:v.HEADING_ITEM_COMPONENT,props:{value:e.value,text:e.label}},value:e.value})),value$:new L.Observable(e=>{const n=s.NamedStyleType.NORMAL_TEXT,o=()=>{var l,A;const r=ze(i);if(r==null){e.next(n);return}const c=(A=(l=r.paragraphStyle)==null?void 0:l.namedStyleType)!=null?A:n;e.next(c)},a=t.onCommandExecuted(r=>{const c=r.id;(c===D.SetTextSelectionsOperation.id||c===he.id)&&o()});return o(),a.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function Sc(i){const t=i.get(s.ICommandService),e=i.get(s.ThemeService);return{id:Ue.id,icon:"FontColor",tooltip:"toolbar.textColor.main",type:v.MenuItemType.BUTTON_SELECTOR,selections:[{label:{name:ei,hoverable:!1,selectable:!1}}],value$:new L.Observable(n=>{const o=e.getColorFromTheme("gray.900"),a=t.onCommandExecuted(r=>{if(r.id===Ue.id){const c=r.params.value;n.next(c!=null?c:o)}});return n.next(o),a.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function vc(i){return{id:Zn.id,type:v.MenuItemType.BUTTON,icon:"HeaderFooterSingle",tooltip:"toolbar.headerFooter",hidden$:L.combineLatest(v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),rc(i),(t,e)=>t||e)}}const Ic="GridSingle",Ls="doc.menu.table";function Ec(i){return{id:Ls,type:v.MenuItemType.SUBITEMS,icon:Ic,tooltip:"toolbar.table.main",disabled$:cc(i),hidden$:L.combineLatest(v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),ac(i),(t,e)=>t||e)}}function Cc(i){return{id:rn.id,title:"toolbar.table.insert",type:v.MenuItemType.BUTTON,hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function Tc(i){const t=i.get(s.ICommandService);return{id:Tt.id,type:v.MenuItemType.BUTTON,icon:"LeftJustifyingSingle",tooltip:"toolbar.alignLeft",disabled$:te(i),activated$:new L.Observable(e=>{const n=t.onCommandExecuted(o=>{var r;const a=o.id;if(a===D.SetTextSelectionsOperation.id||a===me.id){const c=ze(i);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.LEFT)}});return e.next(!1),n.dispose}),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function yc(i){const t=i.get(s.ICommandService);return{id:yt.id,type:v.MenuItemType.BUTTON,icon:"HorizontallySingle",tooltip:"toolbar.alignCenter",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(o=>{var r;const a=o.id;if(a===D.SetTextSelectionsOperation.id||a===me.id){const c=ze(i);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.CENTER)}});return e.next(!1),n.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function bc(i){const t=i.get(s.ICommandService);return{id:bt.id,type:v.MenuItemType.BUTTON,icon:"RightJustifyingSingle",tooltip:"toolbar.alignRight",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(o=>{var r;const a=o.id;if(a===D.SetTextSelectionsOperation.id||a===me.id){const c=ze(i);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.RIGHT)}});return e.next(!1),n.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Oc(i){const t=i.get(s.ICommandService);return{id:Ot.id,type:v.MenuItemType.BUTTON,icon:"AlignTextBothSingle",tooltip:"toolbar.alignJustify",activated$:new L.Observable(e=>{const n=t.onCommandExecuted(o=>{var r;const a=o.id;if(a===D.SetTextSelectionsOperation.id||a===me.id){const c=ze(i);if(c==null)return;const l=(r=c.paragraphStyle)==null?void 0:r.horizontalAlign;e.next(l===s.HorizontalAlign.JUSTIFIED)}});return e.next(!1),n.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}function Rc(i){return{id:vt.id,type:v.MenuItemType.BUTTON,icon:"ReduceSingle",tooltip:"toolbar.horizontalLine",disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)}}const Mt=i=>new L.Observable(t=>{const e=i.get(s.IUniverInstanceService),n=i.get(D.DocSelectionManagerService);let o;const a=e.focused$.subscribe(r=>{if(o==null||o.unsubscribe(),r==null)return;const c=e.getUniverDocInstance(r);c!=null&&(o=n.textSelection$.subscribe(()=>{var d,u,m,g,h;const l=n.getDocRanges(),A=(d=l.find(p=>p.isActive))!=null?d:l[0];if(A){const p=c.getSelfOrHeaderFooterModel(A==null?void 0:A.segmentId),f=s.BuildTextUtils.range.getParagraphsInRange(A,(m=(u=p.getBody())==null?void 0:u.paragraphs)!=null?m:[],(h=(g=p.getBody())==null?void 0:g.dataStream)!=null?h:"");let S;if(f.every(E=>{var C;return S||(S=(C=E.bullet)==null?void 0:C.listType),E.bullet&&E.bullet.listType===S})){t.next(S);return}}t.next(void 0)}))});return()=>{a.unsubscribe(),o==null||o.unsubscribe()}});function Qs(i){return{id:ot.id,type:v.MenuItemType.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:es,hoverable:!1,selectable:!1},value$:Mt(i)}],icon:"OrderSingle",tooltip:"toolbar.order",hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC),disabled$:te(i),activated$:Mt(i).pipe(L.map(t=>!!(t&&t.indexOf("ORDER_LIST")===0)))}}function Fs(i){return{id:it.id,type:v.MenuItemType.BUTTON_SELECTOR,slot:!0,selections:[{label:{name:ts,hoverable:!1,selectable:!1},value$:Mt(i)}],icon:"UnorderSingle",tooltip:"toolbar.unorder",disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC),activated$:Mt(i).pipe(L.map(t=>!!(t&&t.indexOf("BULLET_LIST")===0)))}}function Hs(i){return{id:Ct.id,type:v.MenuItemType.BUTTON,icon:"TodoList",tooltip:"toolbar.checklist",disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC),activated$:Mt(i).pipe(L.map(t=>!!(t&&t.indexOf("CHECK_LIST")===0)))}}function Mc(i){const t=i.get(s.ICommandService),e=i.get(s.IUniverInstanceService);return{id:Rt.id,type:v.MenuItemType.BUTTON,icon:"KeyboardSingle",tooltip:"toolbar.documentFlavor",hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC,void 0,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY),activated$:new L.Observable(n=>{var r;const o=t.onCommandExecuted(c=>{var l;if(c.id===D.RichTextEditingMutation.id){const A=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);n.next(((l=A==null?void 0:A.getSnapshot())==null?void 0:l.documentStyle.documentFlavor)===s.DocumentFlavor.MODERN)}}),a=e.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);return n.next(((r=a==null?void 0:a.getSnapshot())==null?void 0:r.documentStyle.documentFlavor)===s.DocumentFlavor.MODERN),()=>o.dispose()})}}function xc(i){return{id:tt.id,type:v.MenuItemType.BUTTON,title:"toolbar.resetColor",icon:"NoColor"}}function Dc(i){const t=i.get(s.ICommandService),e=i.get(s.ThemeService);return{id:we.id,tooltip:"toolbar.fillColor.main",type:v.MenuItemType.BUTTON_SELECTOR,icon:"PaintBucket",selections:[{label:{name:ei,hoverable:!1,selectable:!1}}],value$:new L.Observable(n=>{const o=e.getColorFromTheme("primary.600"),a=t.onCommandExecuted(r=>{if(r.id===we.id){const c=r.params.value;n.next(c!=null?c:o)}});return n.next(o),a.dispose}),disabled$:te(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function Le(i){var h,p,f,S;const t=i.get(s.IUniverInstanceService),e=i.get(D.DocSelectionManagerService),n=i.get(Te),o=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),a=e.getDocRanges(),r=(h=a.find(E=>E.isActive))!=null?h:a[0],c=n.getDefaultStyle(),l=(p=n.getStyleCache())!=null?p:{},A=ze(i),d=(f=A==null?void 0:A.paragraphStyle)!=null&&f.namedStyleType?s.NAMED_STYLE_MAP[(S=A==null?void 0:A.paragraphStyle)==null?void 0:S.namedStyleType]:null;if(o==null||r==null)return{ts:{...c,...d,...l}};const{segmentId:u}=r,m=o.getSelfOrHeaderFooterModel(u).getBody();if(m==null)return{ts:{...c,...d,...l}};const g=Bs(m,r,{});return s.Tools.deleteNull(g),{ts:{...c,...d,...g,...l}}}function ze(i){var d,u;const t=i.get(s.IUniverInstanceService),e=i.get(D.DocSelectionManagerService),n=t.getCurrentUniverDocInstance(),o=e.getDocRanges(),a=(d=o.find(m=>m.isActive))!=null?d:o[0];if(n==null||a==null)return;const{startOffset:r,segmentId:c}=a,l=(u=n.getSelfOrHeaderFooterModel(c).getBody())==null?void 0:u.paragraphs;if(l==null)return;let A=-1;for(const m of l){const{startIndex:g}=m;if(r>A&&r<=g)return m;A=g}return null}function Bc(i){return{id:Ui.id,type:v.MenuItemType.BUTTON,icon:"DocumentSettingSingle",tooltip:"toolbar.pageSetup",hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}const _c={[s.NamedStyleType.HEADING_1]:Ri,[s.NamedStyleType.HEADING_2]:Mi,[s.NamedStyleType.HEADING_3]:xi,[s.NamedStyleType.HEADING_4]:Di,[s.NamedStyleType.HEADING_5]:Bi,[s.NamedStyleType.NORMAL_TEXT]:an,[s.NamedStyleType.TITLE]:Ns,[s.NamedStyleType.SUBTITLE]:Ps,[s.NamedStyleType.NAMED_STYLE_TYPE_UNSPECIFIED]:an},ks={[s.NamedStyleType.HEADING_1]:{key:"H1Single",component:No},[s.NamedStyleType.HEADING_2]:{key:"H2Single",component:Po},[s.NamedStyleType.HEADING_3]:{key:"H3Single",component:Uo},[s.NamedStyleType.HEADING_4]:{key:"H4Single",component:wo},[s.NamedStyleType.HEADING_5]:{key:"H5Single",component:Lo},[s.NamedStyleType.NORMAL_TEXT]:{key:"TextTypeSingle",component:gt},[s.NamedStyleType.TITLE]:{key:"TextTypeSingle",component:gt},[s.NamedStyleType.SUBTITLE]:{key:"TextTypeSingle",component:gt},[s.NamedStyleType.NAMED_STYLE_TYPE_UNSPECIFIED]:{key:"TextTypeSingle",component:gt}},Qe=i=>t=>{const e=t.get(s.ICommandService),n=t.get(v.ComponentManager),o=ks[i];return n.get(o.key)||n.register(o.key,o.component),{id:_c[i].id,type:v.MenuItemType.BUTTON,icon:o.key,tooltip:"toolbar.heading.tooltip",disabled$:te(t),hidden$:v.getMenuHiddenObservable(t,s.UniverInstanceType.UNIVER_DOC),activated$:new L.Observable(a=>{const r=s.NamedStyleType.NORMAL_TEXT,c=()=>{var u,m;const A=ze(t);if(A==null){a.next(r===i);return}const d=(m=(u=A.paragraphStyle)==null?void 0:u.namedStyleType)!=null?m:r;a.next(d===i)},l=e.onCommandExecuted(A=>{const d=A.id;(d===D.SetTextSelectionsOperation.id||d===he.id)&&c()});return c(),l.dispose})}},Nc=Qe(s.NamedStyleType.HEADING_1),Pc=Qe(s.NamedStyleType.HEADING_2),Uc=Qe(s.NamedStyleType.HEADING_3),wc=Qe(s.NamedStyleType.HEADING_4),Lc=Qe(s.NamedStyleType.HEADING_5),Qc=Qe(s.NamedStyleType.NORMAL_TEXT);Qe(s.NamedStyleType.TITLE),Qe(s.NamedStyleType.SUBTITLE);const Fc=i=>({id:hi.id,type:v.MenuItemType.BUTTON,icon:"Copy",title:"rightClick.copy"}),Hc=i=>({id:mi.id,type:v.MenuItemType.BUTTON,icon:"CutSingle",title:"rightClick.cut"}),kc=i=>({id:ci.id,type:v.MenuItemType.BUTTON,icon:"DeleteSingle",title:"rightClick.delete"}),Vc=i=>({id:Ti.id,type:v.MenuItemType.BUTTON,icon:"UnorderSingle",title:"rightClick.bulletList"}),Wc=i=>({id:yi.id,type:v.MenuItemType.BUTTON,icon:"OrderSingle",title:"rightClick.orderList"}),zc=i=>({id:bi.id,type:v.MenuItemType.BUTTON,icon:"TodoList",title:"rightClick.checkList"}),Gc=i=>({id:Si.id,type:v.MenuItemType.BUTTON,icon:"ReduceSingle",title:"toolbar.horizontalLine"}),Vs="doc.menu.insert-bellow";function jc(i){return{id:Vs,type:v.MenuItemType.SUBITEMS,title:"rightClick.insertBellow"}}const wi=4,Xc=(i,t)=>{const e=i.get(s.IUniverInstanceService).getUniverDocInstance(t.unitId),n=(e==null?void 0:e.zoomRatio)||1;return{...s.Tools.deepClone(t),zoomRatio:n}},ge={id:"doc.operation.set-zoom-ratio",type:s.CommandType.OPERATION,handler:(i,t)=>{const e=i.get(s.IUniverInstanceService).getUniverDocInstance(t.unitId);if(!e)return!1;const n=e.getSnapshot();return n.settings==null?n.settings={zoomRatio:t.zoomRatio}:n.settings.zoomRatio=t.zoomRatio,!0}};var Kc=Object.getOwnPropertyDescriptor,Yc=(i,t,e,n)=>{for(var o=n>1?void 0:n?Kc(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},cn=(i,t)=>(e,n)=>t(e,n,i);function Ws(i,t){const e=zs(i.left,i.top,t),n=zs(i.right,i.bottom,t);return{left:e.x,top:e.y,right:n.x,bottom:n.y}}function zs(i,t,e){const{scaleX:n,scaleY:o}=e.getAncestorScale(),a=e.getViewport(ae.VIEW_MAIN);if(!a)return{x:i,y:t};const{viewportScrollX:r,viewportScrollY:c}=a,l=(i-r)*n,A=(t-c)*o;return{x:l,y:A}}function Gs(i,t,e){const{scaleX:n,scaleY:o}=e.getAncestorScale(),a=e.getViewport(ae.VIEW_MAIN);if(!a)return{x:i,y:t};const{viewportScrollX:r,viewportScrollY:c}=a,l=i/n+r,A=t/o+c;return{x:l,y:A}}const ln=(i,t)=>{const{scene:e,mainComponent:n,engine:o}=t,a=t.with(D.DocSkeletonManagerService).getSkeleton(),r=a.findNodePositionByCharIndex(i.startOffset,!0,i.segmentId,i.segmentPage),c=i.collapsed?i.startOffset:i.endOffset-1,l=a.findNodePositionByCharIndex(c,!0,i.segmentId,i.segmentPage),A=n;if(!l||!r)return;const d=A.getOffsetConfig(),{docsLeft:u,docsTop:m}=d,g=o.getCanvasElement(),h=g.getBoundingClientRect(),p=_.pxToNum(g.style.width),{top:f,left:S,width:E}=h,C=E/p,{scaleX:b,scaleY:R}=e.getAncestorScale(),I=new Ie(d,a),{borderBoxPointGroup:O}=I.getRangePointData(r,l);return kt(O).map(N=>Ws(N,e)).map(N=>({left:(N.left+u*b)*C+S,right:(N.right+u*b)*C+S,top:(N.top+m*R)*C+f,bottom:(N.bottom+m*R)*C+f}))};T.DocCanvasPopManagerService=class extends s.Disposable{constructor(t,e,n,o){super(),this._globalPopupManagerService=t,this._renderManagerService=e,this._univerInstanceService=n,this._commandService=o}_createRectPositionObserver(t,e){const n=()=>{const{scene:l,engine:A}=e,d=typeof t=="function"?t():t,u=A.getCanvasElement(),m=u.getBoundingClientRect(),g=_.pxToNum(u.style.width),h=Ws(d,l),{top:p,left:f,width:S}=m,E=S/g;return{left:h.left*E+f,right:h.right*E+f,top:h.top*E+p,bottom:h.bottom*E+p}},o=n(),a=new L.BehaviorSubject(o),r=new s.DisposableCollection;r.add(this._commandService.onCommandExecuted(l=>{if(l.id===ge.id||l.id===D.RichTextEditingMutation.id){const A=n();A&&a.next(A)}}));const c=e.scene.getViewport(ae.VIEW_MAIN);return c&&r.add(c.onScrollAfter$.subscribeEvent(()=>{a.next(n())})),{position:o,position$:a,disposable:r}}_createObjectPositionObserver(t,e){const n=()=>{const{left:o,top:a,width:r,height:c}=t;return{left:o,right:o+r,top:a,bottom:a+c}};return this._createRectPositionObserver(n,e)}_createRangePositionObserver(t,e){var c;const n=(c=ln(t,e))!=null?c:[],o=new L.BehaviorSubject(n),a=new s.DisposableCollection;a.add(this._commandService.onCommandExecuted(l=>{if((l.id===ge.id||l.id===D.RichTextEditingMutation.id)&&l.params.unitId===e.unitId){const d=ln(t,e);d&&o.next(d)}}));const r=e.scene.getViewport(ae.VIEW_MAIN);return r&&a.add(r.onScrollAfter$.subscribeEvent(()=>{const l=ln(t,e);l&&o.next(l)})),{positions:n,positions$:o,disposable:a}}attachPopupToRect(t,e,n){const o=this._renderManagerService.getRenderById(n);if(!o)throw new Error(`Current render not found, unitId: ${n}`);const{position:a,position$:r,disposable:c}=this._createRectPositionObserver(t,o),l=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a,anchorRect$:r,canvasElement:o.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(l),r.complete(),c.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==l}}attachPopupToObject(t,e,n){const o=this._renderManagerService.getRenderById(n);if(!o)throw new Error(`Current render not found, unitId: ${n}`);const{position:a,position$:r,disposable:c}=this._createObjectPositionObserver(t,o),l=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a,anchorRect$:r,canvasElement:o.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(l),r.complete(),c.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==l}}attachPopupToRange(t,e,n){if(!this._univerInstanceService.getUnit(n))throw new Error(`Document not found, unitId: ${n}`);const{direction:a="top",multipleDirection:r}=e,c=this._renderManagerService.getRenderById(n);if(!c)throw new Error(`Current render not found, unitId: ${n}`);const{positions:l,positions$:A,disposable:d}=this._createRangePositionObserver(t,c),u=A.pipe(L.map(g=>a.includes("top")?g[0]:g[g.length-1])),m=this._globalPopupManagerService.addPopup({...e,unitId:n,subUnitId:"default",anchorRect:a.includes("top")?l[0]:l[l.length-1],anchorRect$:u,excludeRects:l,excludeRects$:A,direction:["top","bottom","horizontal"].some(g=>a.includes(g))&&l.length>1&&r!=null?r:a,canvasElement:c.engine.getCanvasElement()});return{dispose:()=>{this._globalPopupManagerService.removePopup(m),A.complete(),d.dispose()},canDispose:()=>this._globalPopupManagerService.activePopupId!==m}}},T.DocCanvasPopManagerService=Yc([cn(0,s.Inject(v.ICanvasPopupService)),cn(1,_.IRenderManagerService),cn(2,s.IUniverInstanceService),cn(3,s.ICommandService)],T.DocCanvasPopManagerService);var qc=Object.getOwnPropertyDescriptor,Jc=(i,t,e,n)=>{for(var o=n>1?void 0:n?qc(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Zc=(i,t)=>(e,n)=>t(e,n,i);const $c=(i,t,e,n)=>{var m,g,h,p,f;const o=e.findNodePositionByCharIndex(i.startOffset,!0,i.segmentId,n),a=e.getSkeletonData();let r=i.endOffset-1;if(i.segmentId){const S=(f=Array.from((g=(m=a==null?void 0:a.skeFooters.get(i.segmentId))==null?void 0:m.values())!=null?g:[])[0])!=null?f:Array.from((p=(h=a==null?void 0:a.skeHeaders.get(i.segmentId))==null?void 0:h.values())!=null?p:[])[0];S&&(r=Math.min(S.ed,r))}const c=e.findNodePositionByCharIndex(r,!0,i.segmentId,n);if(!c||!o)return;const l=t.getOffsetConfig(),A=new Ie(l,e),{borderBoxPointGroup:d}=A.getRangePointData(o,c);return kt(d).map(S=>({top:S.top+l.docsTop-wi,bottom:S.bottom+l.docsTop+wi,left:S.left+l.docsLeft,right:S.right+l.docsLeft}))},js=(i,t,e,n)=>{const o=[];for(const a of i){const r=a.top;for(const c of a.columns){const l=c.left,A=a.colCount===1?n:c.width;let d=null;for(const u of c.lines){const m=u.paragraphIndex;if(u.paragraphStart){d&&(o.push(d),d=null);const g={top:t+r+u.top,left:e+l,right:e+l+A,bottom:t+r+u.top+u.lineHeight};d={paragraphStart:u.st,paragraphEnd:m,startIndex:m,rect:g,fisrtLine:{top:t+r+u.top+u.marginTop+u.paddingTop,left:e+l,right:e+l+A,bottom:t+r+u.top+u.marginTop+u.paddingTop+u.contentHeight}}}else d&&d.startIndex===m&&(d.rect.bottom=t+r+u.top+u.lineHeight)}d&&o.push(d)}}return o},el=(i,t,e,n=-1)=>{const o=e.findPositionByGlyph(i,n);if(!o)return;const a=t.getOffsetConfig(),r={...o,isBack:!0},c=new Ie(a,e),{borderBoxPointGroup:l}=c.getRangePointData(r,r),d=kt(l)[0];return{top:d.top+a.docsTop,bottom:d.bottom+a.docsTop,left:d.left+a.docsLeft,right:d.left+a.docsLeft+i.width}};function Ge(i,t,e){const{left:n,right:o,top:a,bottom:r}=e;return i>=n&&i<=o&&t>=a&&t<=r}T.DocEventManagerService=class extends s.Disposable{constructor(e,n){super();B(this,"_hoverCustomRanges$",new L.BehaviorSubject([]));B(this,"hoverCustomRanges$",this._hoverCustomRanges$.pipe(L.distinctUntilChanged((e,n)=>e.length===n.length&&e.every((o,a)=>n[a].range.rangeId===o.range.rangeId&&n[a].segmentId===o.segmentId&&n[a].segmentPageIndex===o.segmentPageIndex&&n[a].range.startIndex===o.range.startIndex))));B(this,"_clickCustomRanges$",new L.Subject);B(this,"clickCustomRanges$",this._clickCustomRanges$.asObservable());B(this,"_hoverBullet$",new L.Subject);B(this,"hoverBullet$",this._hoverBullet$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.paragraph.startIndex)===(n==null?void 0:n.paragraph.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.segmentPageIndex)===(n==null?void 0:n.segmentPageIndex))));B(this,"_clickBullet$",new L.Subject);B(this,"clickBullets$",this._clickBullet$.asObservable());B(this,"_hoverParagraph$",new L.BehaviorSubject(null));B(this,"hoverParagraph$",this._hoverParagraph$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.startIndex)===(n==null?void 0:n.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverParagraphRealTime$",this._hoverParagraph$.asObservable());B(this,"_hoverParagraphLeft$",new L.BehaviorSubject(null));B(this,"hoverParagraphLeft$",this._hoverParagraphLeft$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.startIndex)===(n==null?void 0:n.startIndex)&&(e==null?void 0:e.segmentId)===(n==null?void 0:n.segmentId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverParagraphLeftRealTime$",this._hoverParagraphLeft$.asObservable());B(this,"_hoverTableCell$",new L.Subject);B(this,"hoverTableCell$",this._hoverTableCell$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.rowIndex)===(n==null?void 0:n.rowIndex)&&(e==null?void 0:e.colIndex)===(n==null?void 0:n.colIndex)&&(e==null?void 0:e.tableId)===(n==null?void 0:n.tableId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverTableCellRealTime$",this._hoverTableCell$.asObservable());B(this,"_hoverTable$",new L.Subject);B(this,"hoverTable$",this._hoverTable$.pipe(L.distinctUntilChanged((e,n)=>(e==null?void 0:e.tableId)===(n==null?void 0:n.tableId)&&(e==null?void 0:e.pageIndex)===(n==null?void 0:n.pageIndex))));B(this,"hoverTableRealTime$",this._hoverTable$.asObservable());B(this,"_customRangeDirty",!0);B(this,"_bulletDirty",!0);B(this,"_paragraphDirty",!0);B(this,"_customRangeBounds",[]);B(this,"_bulletBounds",[]);B(this,"_paragraphBounds",new Map);B(this,"_paragraphLeftBounds",[]);B(this,"_tableParagraphBounds",new Map);B(this,"_segmentParagraphBounds",new Map);B(this,"_tableCellBounds",new Map);B(this,"_tableBounds",new Map);this._context=e,this._docSkeletonManagerService=n,this._initResetDirty(),this._initEvents(),this._initPointer()}get hoverParagraph(){return this._hoverParagraph$.value}get hoverParagraphLeft(){return this._hoverParagraphLeft$.value}get _skeleton(){return this._docSkeletonManagerService.getSkeleton()}get _documents(){return this._context.mainComponent}dispose(){this._hoverCustomRanges$.complete(),this._clickCustomRanges$.complete(),super.dispose()}_initPointer(){let e=_.CURSOR_TYPE.TEXT;this.disposeWithMe(this.hoverCustomRanges$.subscribe(n=>{n.length?(e=this._context.scene.getCursor(),this._context.scene.setCursor(_.CURSOR_TYPE.POINTER)):this._context.scene.setCursor(e)}))}_initResetDirty(){this.disposeWithMe(this._skeleton.dirty$.subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0})),this.disposeWithMe(s.fromEventSubject(this._context.engine.onTransformChange$).pipe(L.filter(e=>e.type===_.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize)).subscribe(()=>{this._customRangeDirty=!0,this._bulletDirty=!0,this._paragraphDirty=!0}))}_initEvents(){this.disposeWithMe(s.fromEventSubject(this._context.scene.onPointerMove$).pipe(L.throttleTime(30)).subscribe(o=>{if(o.buttons>0){this._hoverBullet$.next(null),this._hoverCustomRanges$.next([]),this._hoverParagraph$.next(null),this._hoverParagraphLeft$.next(null),this._hoverTableCell$.next(null),this._hoverTable$.next(null);return}const{x:a,y:r}=Gs(o.offsetX,o.offsetY,this._context.scene);this._hoverCustomRanges$.next(this._calcActiveRanges({x:a,y:r})),this._hoverParagraph$.next(this._calcActiveParagraph({x:a,y:r})),this._hoverParagraphLeft$.next(this._calcActiveParagraphLeft({x:a,y:r})),this._hoverBullet$.next(this._calcActiveBullet({x:a,y:r}))})),this.disposeWithMe(this._context.scene.onPointerEnter$.subscribeEvent(()=>{this._hoverBullet$.next(null),this._hoverCustomRanges$.next([])}));const e=s.fromEventSubject(this._context.mainComponent.onPointerDown$),n=s.fromEventSubject(this._context.scene.onPointerUp$);this.disposeWithMe(e.pipe(L.switchMap(o=>n.pipe(L.take(1),L.map(a=>({down:o,up:a})))),L.filter(({down:o,up:a})=>o.target===a.target&&a.timeStamp-o.timeStamp<300)).subscribe(({down:o})=>{if(o.button===2)return;const a=Gs(o.offsetX,o.offsetY,this._context.scene),r=this._calcActiveRanges(a);r.length&&this._clickCustomRanges$.next(r.pop());const c=this._calcActiveBullet(a);c&&this._clickBullet$.next(c)}))}_buildCustomRangeBoundsBySegment(e,n=-1){var r,c,l;const o=(l=(c=(r=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:r.getBody())==null?void 0:c.customRanges)!=null?l:[],a=[];return o.forEach(A=>{const d={startOffset:A.startIndex,endOffset:A.endIndex+1,segmentId:e},u=$c(d,this._documents,this._skeleton,n);if(!u)return null;a.push({customRange:A,rects:u,segmentId:e,segmentPageIndex:n})}),a}_buildCustomRangeBounds(){var n;if(!this._customRangeDirty)return;this._customRangeDirty=!1;const e=[];e.push(...this._buildCustomRangeBoundsBySegment()),(n=this._skeleton.getSkeletonData())==null||n.pages.forEach((o,a)=>{o.headerId&&e.push(...this._buildCustomRangeBoundsBySegment(o.headerId,a)),o.footerId&&e.push(...this._buildCustomRangeBoundsBySegment(o.footerId,a))}),this._customRangeBounds=e}_calcActiveRanges(e){this._buildCustomRangeBounds();const{x:n,y:o}=e;return this._customRangeBounds.filter(r=>r.rects.some(c=>Ge(n,o,c))).map(r=>({segmentId:r.segmentId,range:r.customRange,segmentPageIndex:r.segmentPageIndex,rects:r.rects}))}_buildBulletBoundsBySegment(e,n=-1){var A,d,u,m,g;const o=(A=this._context.unit.getSelfOrHeaderFooterModel(e))==null?void 0:A.getBody(),a=((d=o==null?void 0:o.paragraphs)!=null?d:[]).filter(h=>h.bullet&&h.bullet.listType.indexOf("CHECK_LIST")===0),r=[],c=this._skeleton.getSkeletonData();if(!c)return r;const l=h=>{var p,f,S;for(const E of h){const C=[...E.sections];if(E.skeTables){const b=Array.from(E.skeTables.values());C.push(...b.map(R=>R.rows.map(I=>I.cells.map(O=>O.sections))).flat(4))}for(const b of C)for(const R of b.columns)for(const I of R.lines)if(I.paragraphStart){const O=a.find(M=>M.startIndex===I.paragraphIndex);if(O){const M=I,y=(S=(f=(p=M==null?void 0:M.divides)==null?void 0:p[0])==null?void 0:f.glyphGroup)==null?void 0:S[0];if(!y)continue;const N=el(y,this._documents,this._skeleton,n);if(!N)continue;r.push({rect:N,segmentId:e,segmentPageIndex:n,paragraph:O})}}}return r};if(e){const h=(g=(u=c.skeFooters.get(e))==null?void 0:u.values())!=null?g:(m=c.skeHeaders.get(e))==null?void 0:m.values();return h?l(Array.from(h)):r}return l(c.pages)}_buildBulletBounds(){var e;this._bulletDirty&&(this._bulletDirty=!1,this._bulletBounds=[],this._bulletBounds.push(...this._buildBulletBoundsBySegment()),(e=this._skeleton.getSkeletonData())==null||e.pages.forEach((n,o)=>{n.headerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(n.headerId,o)),n.footerId&&this._bulletBounds.push(...this._buildBulletBoundsBySegment(n.footerId,o))}))}_calcActiveBullet(e){this._buildBulletBounds();const{x:n,y:o}=e;return this._bulletBounds.find(r=>Ge(n,o,r.rect))}_buildParagraphBoundsBySegment(e){var c,l,A;const n=this._skeleton.getSkeletonData(),a=this._documents.getOffsetConfig();if(!n)return null;const r=d=>{const u=new Map,m=(g,h,p,f)=>{js(g.sections,p,f,g.pageWidth-g.marginLeft-g.marginRight).forEach(E=>{if(!u.has(E.startIndex))u.set(E.startIndex,{rect:E.rect,paragraphStart:E.paragraphStart,paragraphEnd:E.paragraphEnd,startIndex:E.startIndex,rects:[E.rect],pageIndex:h,segmentId:e,firstLine:E.fisrtLine});else{const C=u.get(E.startIndex);C&&(C.rect.bottom=E.rect.bottom,C.rects.push(E.rect))}})};for(let g=0;g<d.length;g++){const h=d[g],p=((h.pageHeight===1/0?0:h.pageHeight)+a.pageMarginTop)*g+h.marginTop+a.docsTop,f=h.marginLeft+a.docsLeft;h.skeTables&&Array.from(h.skeTables.values()).forEach(S=>{const E=S.left+f,C=S.top+p,b=E+S.width,R=C+S.height,I=S.tableId;this._tableBounds.set(I,{rect:{left:E,top:C,right:b,bottom:R},pageIndex:g,tableId:I}),S.rows.forEach((O,M)=>{O.cells.forEach((y,N)=>{const x=((h.pageHeight===1/0?0:h.pageHeight)+a.pageMarginTop)*g+S.top+a.docsTop+h.marginTop+O.top+y.marginTop,w=S.left+a.docsLeft+h.marginLeft+y.left+y.marginLeft,H=js(y.sections,x,w,y.pageWidth-y.marginLeft-y.marginRight);let V=this._tableParagraphBounds.get(I);V||(V=[],this._tableParagraphBounds.set(I,V)),V.push(...H.map(Q=>({rect:Q.rect,paragraphStart:Q.paragraphStart,paragraphEnd:Q.paragraphEnd,startIndex:Q.startIndex,pageIndex:g,segmentId:e,rowIndex:M,colIndex:N,firstLine:Q.fisrtLine,tableId:I})));let F=this._tableCellBounds.get(I);F||(F=[],this._tableCellBounds.set(I,F)),F.push({rect:{top:x,left:w,right:w+y.pageWidth-y.marginLeft-y.marginRight,bottom:x+y.pageHeight-y.marginBottom-y.marginTop},pageIndex:g,rowIndex:M,colIndex:N,tableId:I})})})}),m(h,g,p,f)}return u};if(e){const d=(A=(c=n.skeFooters.get(e))==null?void 0:c.values())!=null?A:(l=n.skeHeaders.get(e))==null?void 0:l.values();return d?r(Array.from(d)):null}return r(n.pages)}_buildParagraphBounds(){var n,o;if(!this._paragraphDirty)return;this._paragraphDirty=!1,this._tableParagraphBounds=new Map,this._tableCellBounds=new Map,this._tableBounds=new Map,this._paragraphBounds=(n=this._buildParagraphBoundsBySegment())!=null?n:new Map,this._paragraphLeftBounds=Array.from(this._paragraphBounds.values()).map(a=>({...a,rect:{left:a.rect.left-60,right:a.rect.left,top:a.rect.top,bottom:a.rect.bottom}}));const e=a=>{var r;this._segmentParagraphBounds.set(a,(r=this._buildParagraphBoundsBySegment(a))!=null?r:new Map)};(o=this._skeleton.getSkeletonData())==null||o.pages.forEach(a=>{a.headerId&&e(a.headerId),a.footerId&&e(a.footerId)})}_calcActiveParagraph(e){var c,l;this._buildParagraphBounds();const{x:n,y:o}=e,a=Array.from(this._tableBounds.values()).find(A=>Ge(n,o,A.rect));if(this._hoverTable$.next(a),a){const A=(c=this._tableCellBounds.get(a.tableId))==null?void 0:c.find(m=>Ge(n,o,m.rect));if(this._hoverTableCell$.next(A),!A)return null;const d=(l=this._tableParagraphBounds.get(A.tableId))==null?void 0:l.filter(m=>m.colIndex===A.colIndex&&m.rowIndex===A.rowIndex),u=d==null?void 0:d.find(m=>Ge(n,o,m.rect));return u&&{...u,rects:[u.rect]}}return this._paragraphBounds.values().find(A=>A.rects.some(d=>Ge(n,o,d)))}_calcActiveParagraphLeft(e){this._buildParagraphBounds();const{x:n,y:o}=e;return this._paragraphLeftBounds.find(r=>Ge(n,o,r.rect))}get paragraphBounds(){return this._buildParagraphBounds(),this._paragraphBounds}findParagraphBoundByIndex(e){this._buildParagraphBounds();const n=this._paragraphBounds.get(e);return n||Array.from(this._tableParagraphBounds.values()).flat().find(a=>a.startIndex===e)}},T.DocEventManagerService=Jc([Zc(1,s.Inject(D.DocSkeletonManagerService))],T.DocEventManagerService);const tl=[he.id,De.id,Be.id,_e.id,Ne.id,ye.id,Pe.id,Ue.id,we.id];function nl(i){const{avaliableMenus:t=tl}=i,e=v.useDependency(v.IMenuManagerService),[n,o]=U.useState([]);return U.useEffect(()=>{function a(){const c=e.getFlatMenuByPositionKey(v.MenuManagerPosition.RIBBON),l=[];for(const A of t){const d=c.find(u=>u.key===A);d&&l.push(d)}o(l)}a();const r=e.menuChanged$.subscribe(a);return()=>{r.unsubscribe()}},[e]),P.jsx("div",{className:J.clsx("univer-box-border univer-flex univer-rounded univer-bg-white univer-py-1.5 univer-shadow-sm dark:univer-border-gray-700 dark:univer-bg-gray-900",J.borderClassName),children:n.map(a=>a.item&&P.jsx("div",{className:"univer-flex univer-flex-nowrap univer-gap-2 univer-px-2",children:P.jsx(v.ToolbarItem,{...a.item},a.key)},a.key))})}var il=Object.getOwnPropertyDescriptor,ol=(i,t,e,n)=>{for(var o=n>1?void 0:n?il(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},xt=(i,t)=>(e,n)=>t(e,n,i);const Xs="univer.doc.float-menu";function sl(i,t){if(i==null||t==null)return!1;const{glyph:e,...n}=i,{glyph:o,...a}=t;return s.deepCompare(n,a)}const al=[s.DataStreamTreeTokenType.CUSTOM_BLOCK,s.DataStreamTreeTokenType.PARAGRAPH];let dn=class extends s.Disposable{constructor(t,e,n,o,a,r){super();B(this,"_floatMenu",null);this._context=t,this._docSelectionManagerService=e,this._docCanvasPopManagerService=n,this._componentManager=o,this._univerInstanceService=a,this._docSelectionRenderService=r,!s.isInternalEditorID(this._context.unitId)&&(this._registerFloatMenu(),this._initSelectionChange(),this.disposeWithMe(()=>{this._hideFloatMenu()}))}get floatMenu(){return this._floatMenu}_registerFloatMenu(){this.disposeWithMe(this._componentManager.register(Xs,nl))}_initSelectionChange(){this.disposeWithMe(this._docSelectionRenderService.onSelectionStart$.subscribe(()=>{this._hideFloatMenu()})),this.disposeWithMe(this._docSelectionManagerService.textSelection$.subscribe(t=>{var a,r;const{unitId:e,textRanges:n}=t;if(e!==this._context.unitId)return;const o=n.length>0&&n.find(c=>!c.collapsed);if(o){if(o.startOffset===((a=this._floatMenu)==null?void 0:a.start)&&o.endOffset===((r=this._floatMenu)==null?void 0:r.end))return;this._hideFloatMenu(),this._showFloatMenu(e,o);return}this._hideFloatMenu()}))}_hideFloatMenu(){var t;(t=this._floatMenu)==null||t.disposable.dispose(),this._floatMenu=null}_showFloatMenu(t,e){var r,c,l;const n=this._univerInstanceService.getUnit(t,s.UniverInstanceType.UNIVER_DOC);if(!n||n.getDisabled())return;const o=(r=n.getBody())==null?void 0:r.dataStream[e.startOffset];if(e.endOffset-e.startOffset===1&&o&&al.includes(o))return;const a=(l=(c=n.getBody())==null?void 0:c.customRanges)==null?void 0:l.filter(A=>A.wholeEntity);if(!(a!=null&&a.some(A=>A.startIndex===e.startOffset&&A.endIndex===e.endOffset-1)))return this._floatMenu={disposable:this._docCanvasPopManagerService.attachPopupToRange(e,{componentKey:Xs,direction:e.direction==="backward"||sl(e.startNodePosition,e.endNodePosition)?"top-center":"bottom-center",offset:[0,4]},t),start:e.startOffset,end:e.endOffset},s.toDisposable(()=>this._hideFloatMenu())}};dn=ol([xt(1,s.Inject(D.DocSelectionManagerService)),xt(2,s.Inject(T.DocCanvasPopManagerService)),xt(3,s.Inject(v.ComponentManager)),xt(4,s.Inject(s.IUniverInstanceService)),xt(5,s.Inject(T.DocSelectionRenderService))],dn);var rl=Object.getOwnPropertyDescriptor,cl=(i,t,e,n)=>{for(var o=n>1?void 0:n?rl(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Dt=(i,t)=>(e,n)=>t(e,n,i);let An=class extends s.Disposable{constructor(t,e,n,o,a,r){super();B(this,"_paragrahMenu",null);this._context=t,this._docSelectionManagerService=e,this._docEventManagerService=n,this._docPopupManagerService=o,this._docSkeletonManagerService=a,this._floatMenuService=r,!s.isInternalEditorID(this._context.unitId)&&this._init()}get activeParagraph(){var t;return(t=this._paragrahMenu)==null?void 0:t.paragraph}_isCursorInActiveParagraph(){if(!this._paragrahMenu)return!1;const t=this._docSelectionManagerService.getActiveTextRange();return!(!(t!=null&&t.collapsed)||!(t!=null&&t.collapsed)||t.startOffset<this._paragrahMenu.paragraph.paragraphStart||t.startOffset>this._paragrahMenu.paragraph.paragraphEnd)}setParagraphMenuActive(t){this._paragrahMenu&&(this._paragrahMenu.active=t,this._isCursorInActiveParagraph()||this._docSelectionManagerService.replaceDocRanges([{startOffset:this._paragrahMenu.paragraph.paragraphStart,endOffset:this._paragrahMenu.paragraph.paragraphStart}]))}_init(){const t=n=>{var a;if(this._docSkeletonManagerService.getViewModel().getEditArea()===_.DocumentEditArea.BODY&&!this._floatMenuService.floatMenu&&!this._context.unit.getDisabled()){if((a=this._paragrahMenu)!=null&&a.active)return;if(n){this.showParagraphMenu(n);return}}this.hideParagraphMenu(!0)};this.disposeWithMe(L.combineLatest([this._docEventManagerService.hoverParagraphRealTime$,this._docEventManagerService.hoverParagraphLeft$]).pipe(L.throttleTime(16)).subscribe(([n,o])=>{const a=n!=null?n:o;t(a)}));let e=0;this.disposeWithMe(this._context.scene.getViewport(ae.VIEW_MAIN).onScrollAfter$.subscribeEvent(n=>{e!==n.scrollY&&(e=n.scrollY,this.hideParagraphMenu(!0))})),this.disposeWithMe(this._docEventManagerService.clickCustomRanges$.subscribe(()=>{this.hideParagraphMenu(!0)}))}showParagraphMenu(t){var l,A,d;if(((l=this._paragrahMenu)==null?void 0:l.paragraph.startIndex)===t.startIndex)return;this.hideParagraphMenu(!0);const e=(d=(A=this._context.unit.getBody())==null?void 0:A.dataStream)!=null?d:"",n=t?e.slice(t.paragraphStart,t.paragraphEnd):"";if(n==="\b"||n==="")return;const c=this._docPopupManagerService.attachPopupToRect(t.firstLine,{componentKey:"doc.paragraph.menu",direction:"left-center",onClickOutside:()=>{this._docSelectionManagerService.textSelection$.pipe(L.first()).subscribe(()=>{this._isCursorInActiveParagraph()||this.hideParagraphMenu(!0)})},zIndex:101},this._context.unitId);this._paragrahMenu={paragraph:t,disposable:c,active:!1}}hideParagraphMenu(t=!1){this._paragrahMenu&&(this._paragrahMenu.disposable.canDispose()||t)&&(this._paragrahMenu.disposable.dispose(),this._paragrahMenu=null)}};An=cl([Dt(1,s.Inject(D.DocSelectionManagerService)),Dt(2,s.Inject(T.DocEventManagerService)),Dt(3,s.Inject(T.DocCanvasPopManagerService)),Dt(4,s.Inject(D.DocSkeletonManagerService)),Dt(5,s.Inject(dn))],An);const ll=({popup:i})=>{var I,O;const[t,e]=U.useState(!1),n=U.useRef(null),o=v.useDependency(s.ICommandService),a=v.useDependency(v.ILayoutService),r=U.useRef(null),c=U.useRef(!1),l=v.useDependency(_.IRenderManagerService),A=v.useDependency(s.IUniverInstanceService),d=l.getRenderById(i.unitId),u=A.getUnit(i.unitId,s.UniverInstanceType.UNIVER_DOC),m=d==null?void 0:d.with(An),g=d==null?void 0:d.with(T.DocEventManagerService),h=v.useObservable(g==null?void 0:g.hoverParagraph$),p=v.useObservable(g==null?void 0:g.hoverParagraphLeft$),f=(I=h!=null?h:p)==null?void 0:I.startIndex,S=U.useMemo(()=>{var M,y;return(y=(M=u==null?void 0:u.getBody())==null?void 0:M.paragraphs)==null?void 0:y.find(N=>N.startIndex===f)},[u,h]),E=(O=S==null?void 0:S.paragraphStyle)==null?void 0:O.namedStyleType,C=ks[E!=null?E:s.NamedStyleType.NORMAL_TEXT],b=U.useMemo(()=>new L.BehaviorSubject({left:0,right:0,top:0,bottom:0}),[]),R=()=>{e(!1),m==null||m.hideParagraphMenu(!0)};return P.jsxs(P.Fragment,{children:[P.jsxs("div",{"data-u-comp":"paragraph-menu",ref:r,className:J.clsx("univer-mr-1 univer-inline-flex univer-h-7 univer-cursor-pointer univer-items-center univer-gap-1 univer-rounded-full univer-px-2.5 univer-py-0 dark:hover:univer-bg-gray-600 hover:univer-bg-gray-100",J.borderClassName,{"univer-bg-gray-100 dark:univer-bg-gray-700":t,"univer-bg-white dark:univer-bg-gray-700":!t}),onMouseEnter:M=>{var N,x,w,H,V,F;(N=i.onPointerEnter)==null||N.call(i,M),c.current=!0;const y=(x=r.current)==null?void 0:x.getBoundingClientRect();b.next({left:((w=y==null?void 0:y.left)!=null?w:0)-4,right:(H=y==null?void 0:y.right)!=null?H:0,top:(V=y==null?void 0:y.top)!=null?V:0,bottom:(F=y==null?void 0:y.bottom)!=null?F:0})},onMouseLeave:()=>{c.current=!1},onClick:()=>{e(!0),m==null||m.setParagraphMenuActive(!0)},children:[P.jsx(C.component,{className:"univer-size-4 univer-text-gray-900 dark:univer-text-white"}),P.jsx(_o,{className:"univer-size-3 univer-text-gray-600 dark:univer-text-gray-200"})]}),t&&P.jsx(v.RectPopup,{portal:!0,mask:!0,maskZIndex:100,anchorRect$:b,direction:"left",onMaskClick:R,children:P.jsx("section",{ref:n,onMouseEnter:M=>{var y;(y=i.onPointerEnter)==null||y.call(i,M),c.current=!0},onMouseLeave:()=>{c.current=!1},children:P.jsx(v.DesktopMenu,{style:{width:212},menuType:v.ContextMenuPosition.PARAGRAPH,onOptionSelect:M=>{const{label:y,commandId:N,value:x}=M;o&&o.executeCommand(N!=null?N:y,{value:x}),a.focus(),R()}})})})]})},je={id:"doc.command.tab",type:s.CommandType.COMMAND,async handler(i,t){const n=i.get(T.DocAutoFormatService).onAutoFormat(je.id,t);return(await s.sequenceExecuteAsync(n,i.get(s.ICommandService))).result}},Bt={id:"doc.command.after-space",type:s.CommandType.COMMAND,async handler(i){const e=i.get(T.DocAutoFormatService).onAutoFormat(Bt.id);return(await s.sequenceExecuteAsync(e,i.get(s.ICommandService))).result}},st={id:"doc.command.enter",type:s.CommandType.COMMAND,async handler(i){const e=i.get(T.DocAutoFormatService).onAutoFormat(st.id);return(await s.sequenceExecuteAsync(e,i.get(s.ICommandService))).result}};function ee(i){return i.getContextValue(s.FOCUSING_DOC)&&i.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&!i.getContextValue(s.FOCUSING_COMMON_DRAWINGS)}function dl(i){return i.getContextValue(s.FOCUSING_DOC)&&i.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&!i.getContextValue(s.FOCUSING_COMMON_DRAWINGS)}const Al={id:je.id,binding:v.KeyCode.TAB,preconditions:ee},ul={id:je.id,binding:v.KeyCode.TAB|v.MetaKeys.SHIFT,preconditions:ee,staticParameters:{shift:!0}},gl={id:De.id,binding:v.KeyCode.B|v.MetaKeys.CTRL_COMMAND,preconditions:ee},hl={id:Be.id,binding:v.KeyCode.I|v.MetaKeys.CTRL_COMMAND,preconditions:ee},ml={id:_e.id,binding:v.KeyCode.U|v.MetaKeys.CTRL_COMMAND,preconditions:ee},pl={id:Ne.id,binding:v.KeyCode.X|v.MetaKeys.SHIFT|v.MetaKeys.CTRL_COMMAND,preconditions:ee},fl={id:ye.id,binding:v.KeyCode.COMMA|v.MetaKeys.CTRL_COMMAND,preconditions:ee},Sl={id:Pe.id,binding:v.KeyCode.PERIOD|v.MetaKeys.CTRL_COMMAND,preconditions:ee},vl={id:Tt.id,binding:v.KeyCode.L|v.MetaKeys.CTRL_COMMAND|v.MetaKeys.SHIFT,preconditions:ee},Il={id:bt.id,binding:v.KeyCode.R|v.MetaKeys.CTRL_COMMAND|v.MetaKeys.SHIFT,preconditions:ee},El={id:yt.id,binding:v.KeyCode.E|v.MetaKeys.CTRL_COMMAND|v.MetaKeys.SHIFT,preconditions:ee},Cl={id:Ot.id,binding:v.KeyCode.J|v.MetaKeys.CTRL_COMMAND|v.MetaKeys.SHIFT,preconditions:ee},Tl={id:ot.id,binding:v.KeyCode.Digit7|v.MetaKeys.CTRL_COMMAND|v.MetaKeys.SHIFT,preconditions:ee},yl={id:it.id,binding:v.KeyCode.Digit8|v.MetaKeys.CTRL_COMMAND|v.MetaKeys.SHIFT,preconditions:ee},un="docs-ui.config",Ks={layout:{docContainerConfig:ao,toolbarConfig:so}},bl=[50,80,100,130,150,170,200,400],Ol=[10,400];function Rl(){const i=v.useDependency(s.ICommandService),t=v.useDependency(s.IUniverInstanceService),e=U.useMemo(()=>t.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC),[]),n=v.useObservable(e),o=U.useCallback(()=>{var A,d;if(!n)return 100;const l=((d=(A=n.getSettings())==null?void 0:A.zoomRatio)!=null?d:1)*100;return Math.round(l)},[n]),[a,r]=U.useState(()=>o());U.useEffect(()=>(r(o()),i.onCommandExecuted(A=>{if(A.id===ge.id){const d=o();r(d)}}).dispose),[i,o]);function c(l){if(r(l),n==null)return;const A=l/100;i.executeCommand(ge.id,{unitId:n.getUnitId(),zoomRatio:A})}return P.jsx(v.Slider,{min:Ol[0],value:a,shortcuts:bl,onChange:c})}function Ml(i){return P.jsx("section",{className:"univer-flex univer-flex-shrink-0 univer-justify-end",children:P.jsx(Rl,{})})}function xl(){var o,a,r;const i=v.useDependency(s.IUniverInstanceService),t=v.useConfigValue(un),e=v.useObservable(()=>i.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_SHEET),void 0,void 0,[]),n=(r=(a=(o=t==null?void 0:t.layout)==null?void 0:o.docContainerConfig)==null?void 0:a.footer)!=null?r:!0;return e?null:n&&P.jsxs("div",{className:"univer-box-border univer-flex univer-items-center univer-justify-between univer-px-5",children:[P.jsx("div",{}),P.jsx(Ml,{})]})}const Dl="univer-overflow-hidden univer-font-[500] univer-truncate univer-h-[24px] univer-mb-2 univer-leading-[24px] univer-ellipsis univer-cursor-pointer",Bl="univer-text-base univer-font-semibold",_l="univer-text-sm univer-font-semibold",Nl="univer-text-sm",Pl=U.forwardRef((i,t)=>{const{menus:e,onClick:n,className:o,style:a,mode:r,maxHeight:c,activeId:l,open:A,onOpenChange:d,maxWidth:u,wrapperClass:m,wrapperStyle:g,iconClass:h,iconStyle:p}=i,f=r==="side-bar",S=U.useRef(null),E=U.useRef(e);E.current=e;const C=U.useMemo(()=>({scrollTo:b=>{var x;if(!E.current||E.current.findIndex(w=>w.id===b)===-1||!S.current)return;const I=document.getElementById(`univer-side-menu-${b}`);if(!I)return;const O=I.offsetTop,M=S.current.clientHeight,y=S.current.scrollHeight-M,N=Math.max(0,Math.min(O-M/2+I.clientHeight/2,y));(x=S.current)==null||x.scrollTo({behavior:"smooth",top:N})}}),[]);return U.useImperativeHandle(t,()=>C),U.useEffect(()=>{l&&C.scrollTo(l)},[l,C]),P.jsxs("div",{className:J.clsx("univer-relative",m),style:g,children:[P.jsx("div",{onClick:()=>d==null?void 0:d(!A),className:J.clsx("univer-absolute univer-left-5 univer-top-4 univer-z-[100] univer-flex univer-h-8 univer-w-8 univer-cursor-pointer univer-items-center univer-justify-center univer-rounded-full univer-bg-white univer-text-gray-800 univer-shadow-[0px_1px_3px_-1px_rgba(30,40,77,0.10),0px_1px_4px_0px_rgba(30,40,77,0.12)] dark:univer-bg-gray-600 dark:univer-text-gray-200",h),style:p,children:A?P.jsx(Ho,{}):P.jsx(Mo,{})}),P.jsx("div",{className:J.clsx(o,`
                      univer-absolute univer-left-0 univer-top-0 univer-box-border univer-flex univer-min-w-[180px]
                      univer-flex-col univer-pb-4 univer-pl-5 univer-pr-5 univer-pt-14 univer-transition-all
                      univer-duration-300
                    `,f?"":["univer-bg-white","univer-rounded-r-2xl","univer-shadow-[0px_1px_6px_-2px_rgba(30,40,77,0.08),0px_2px_6px_-1px_rgba(30,40,77,0.10)]","univer-backdrop-blur-[10px]"]),style:{...a,transform:A?"translateX(0)":"translateX(-100%)",maxHeight:c,opacity:A?1:0,maxWidth:u!=null?u:r==="side-bar"?480:180,paddingRight:r==="float"?void 0:0},children:P.jsx("div",{ref:S,className:J.clsx("univer-flex-1 univer-overflow-y-auto univer-overflow-x-hidden univer-scrollbar-none"),children:e==null?void 0:e.map(b=>P.jsx("div",{id:`univer-side-menu-${b.id}`,className:J.clsx(Dl,{[Bl]:b.isTitle,[_l]:b.level===1,[Nl]:b.level>1,"univer-text-gray-500 dark:univer-text-gray-400":b.id!==l,"univer-text-gray-800 dark:univer-text-gray-200":b.id===l}),style:{paddingLeft:(b.level-1)*12},onClick:()=>{n==null||n(b)},children:b.text},b.id))})})]})}),Ul=i=>{switch(i){case s.NamedStyleType.HEADING_1:return 1;case s.NamedStyleType.HEADING_2:return 2;case s.NamedStyleType.HEADING_3:return 3;case s.NamedStyleType.HEADING_4:return 4;case s.NamedStyleType.HEADING_5:return 5;case s.NamedStyleType.TITLE:return 1;default:return 1}};function wl(i,t,e,n){var c,l;if(!i)return;const o=Array.from(i.values()),a=o.findIndex(A=>A.paragraphStart!==A.paragraphEnd&&A.rect.top<n&&A.rect.bottom>e);if(a===-1)return;const r=o==null?void 0:o.findLastIndex(A=>A.paragraphStart!==A.paragraphEnd&&A.rect.top<n&&A.rect.bottom>e);for(let A=a;A<=r;A++){const d=o[A],u=t.get(d.startIndex);if((c=u==null?void 0:u.paragraphStyle)!=null&&c.headingId)return u.paragraphStyle.headingId}for(let A=a;A>=0;A--){const d=o[A],u=t.get(d.startIndex);if((l=u==null?void 0:u.paragraphStyle)!=null&&l.headingId)return u.paragraphStyle.headingId}}const Ys="__title";function Ll(){var t,e,n;const i=v.useConfigValue(un);return(n=(e=(t=i==null?void 0:i.layout)==null?void 0:t.docContainerConfig)==null?void 0:e.sideMenu)==null||n?P.jsx(Ql,{}):null}function Ql(){var N,x,w,H,V,F,Q,j,G;const i=v.useDependency(s.ICommandService),t=v.useDependency(s.IUniverInstanceService),e=v.useObservable(U.useMemo(()=>t.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_DOC),[])),n=v.useDependency(_.IRenderManagerService),o=(x=(N=e==null?void 0:e.getBody())==null?void 0:N.dataStream)!=null?x:"",[a,r]=U.useState(0),[c,l]=U.useState(void 0),A=(w=e==null?void 0:e.getUnitId())!=null?w:"",d=n.getRenderById(A),u=e==null?void 0:e.getTitle(),m=d==null?void 0:d.with(T.DocEventManagerService),g=m==null?void 0:m.paragraphBounds,h=(V=(H=d==null?void 0:d.mainComponent)==null?void 0:H.left)!=null?V:0,p=(F=d==null?void 0:d.engine.height)!=null?F:0,f=(Q=d==null?void 0:d.scene.scaleY)!=null?Q:1,S=(G=(j=e==null?void 0:e.getBody())==null?void 0:j.paragraphs)!=null?G:[],E=U.useMemo(()=>{const k=new Map;return S.forEach(W=>{k.set(W.startIndex,W)}),k},[S]);v.useObservable(U.useMemo(()=>d!=null&&d.engine.onTransformChange$?s.fromEventSubject(d==null?void 0:d.engine.onTransformChange$).pipe(L.throttleTime(33)):L.of(null),[d==null?void 0:d.engine.onTransformChange$]));const C=h<180?"float":"side-bar",b=S==null?void 0:S.filter(k=>{var W;return((W=k.paragraphStyle)==null?void 0:W.namedStyleType)!==void 0&&k.paragraphStyle.namedStyleType!==s.NamedStyleType.SUBTITLE&&k.paragraphStyle.namedStyleType!==s.NamedStyleType.NORMAL_TEXT}).map(k=>{var q;const W=Ul(k.paragraphStyle.namedStyleType),z=g==null?void 0:g.get(k.startIndex);if(!z)return null;const{paragraphStart:X,paragraphEnd:Y}=z;return{id:k.paragraphStyle.headingId,text:s.getPlainText(o.slice(X,Y)),level:W,isTitle:((q=k.paragraphStyle)==null?void 0:q.namedStyleType)===s.NamedStyleType.TITLE}}).filter(k=>k==null?void 0:k.text),R=v.useEvent(k=>{const W=k.viewportScrollY,z=W+p/f,X=wl(g,E,W,z);X&&l(X)}),I=b!=null&&b.find(k=>k.isTitle)?b:[...u?[{id:Ys,text:u,level:1,isTitle:!0}]:[],...b!=null?b:[]].filter(Boolean),[O,M]=U.useState(!0);U.useEffect(()=>{const k=s.debounce(r,100),W=i.onCommandExecuted(z=>{z.id===D.RichTextEditingMutation.id&&z.params.unitId===(e==null?void 0:e.getUnitId())&&k(Y=>Y+1)});return()=>{W.dispose()}},[i,e]),U.useEffect(()=>{const k=d==null?void 0:d.scene.getViewport(ae.VIEW_MAIN);if(!k)return;const W=s.fromEventSubject(k.onScrollAfter$).pipe(L.throttleTime(33)).subscribe(R);return()=>{W.unsubscribe()}},[d]);const y=v.useEvent(k=>{const W=d==null?void 0:d.scene.getViewport(ae.VIEW_MAIN);if(!W)return;if(k.id===Ys){W.scrollToViewportPos({viewportScrollY:0});return}const z=S.find(Y=>{var q;return((q=Y.paragraphStyle)==null?void 0:q.headingId)===k.id});if(!z)return;const X=g==null?void 0:g.get(z.startIndex);X&&(W.scrollToViewportPos({viewportScrollY:X.rect.top}),l(k.id))});return!e||s.isInternalEditorID(A)||!(I!=null&&I.length)?null:P.jsx("div",{className:"univer-absolute univer-bottom-0 univer-left-0 univer-top-0 univer-z-[100] univer-w-[0px]",children:P.jsx(Pl,{menus:I,open:O,onOpenChange:M,mode:C,maxWidth:C==="float"?void 0:Math.floor(h),wrapperClass:"univer-mt-12",activeId:c,onClick:y,maxHeight:p-48})})}const gn={id:"doc.table.delete-rows",type:s.CommandType.COMMAND,handler:async i=>{const t=i.get(D.DocSelectionManagerService),e=i.get(s.IUniverInstanceService),n=i.get(s.ICommandService),o=t.getRectRanges(),a=t.getActiveTextRange(),r=ht(a,o);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(i,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),g=new s.TextX,h=s.JSONX.getInstance(),p=ns(r,u);if(p==null)return!1;const{offset:f,rowIndexes:S,len:E,tableId:C,cursor:b,selectWholeTable:R}=p;if(R)return n.executeCommand(at.id);const I=[],O=[{startOffset:b,endOffset:b,collapsed:!0}],M={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:O}};f>0&&g.push({t:s.TextXActionType.RETAIN,len:f}),g.push({t:s.TextXActionType.DELETE,len:E});const y=Z(l,c);I.push(h.editOp(g.serialize(),y));for(const x of S.reverse()){const w=h.removeOp(["tableSource",C,"tableRows",x]);I.push(w)}return M.params.actions=I.reduce((x,w)=>s.JSONX.compose(x,w),null),!!n.syncExecuteCommand(M.id,M.params)}},hn={id:"doc.table.delete-columns",type:s.CommandType.COMMAND,handler:async i=>{const t=i.get(D.DocSelectionManagerService),e=i.get(s.IUniverInstanceService),n=i.get(s.ICommandService),o=t.getRectRanges(),a=t.getActiveTextRange(),r=ht(a,o);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(i,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),g=new s.TextX,h=s.JSONX.getInstance(),p=Nr(r,u);if(p==null)return!1;const{offsets:f,columnIndexes:S,tableId:E,cursor:C,rowCount:b,selectWholeTable:R}=p;if(R)return n.executeCommand(at.id);const I=[],O=[{startOffset:C,endOffset:C,collapsed:!0}],M={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:O}};for(const x of f){const{retain:w,delete:H}=x;w>0&&g.push({t:s.TextXActionType.RETAIN,len:w}),g.push({t:s.TextXActionType.DELETE,len:H})}const y=Z(l,c);I.push(h.editOp(g.serialize(),y)),S.reverse();for(let x=0;x<b;x++)for(const w of S){const H=h.removeOp(["tableSource",E,"tableRows",x,"tableCells",w]);I.push(H)}for(const x of S){const w=h.removeOp(["tableSource",E,"tableColumns",x]);I.push(w)}return M.params.actions=I.reduce((x,w)=>s.JSONX.compose(x,w),null),!!n.syncExecuteCommand(M.id,M.params)}},at={id:"doc.table.delete-table",type:s.CommandType.COMMAND,handler:async i=>{const t=i.get(D.DocSelectionManagerService),e=i.get(s.IUniverInstanceService),n=i.get(s.ICommandService),o=t.getRectRanges(),a=t.getActiveTextRange(),r=ht(a,o);if(r==null)return!1;const{segmentId:c}=r,l=e.getCurrentUniverDocInstance(),A=l==null?void 0:l.getSelfOrHeaderFooterModel(c).getBody();if(l==null||A==null)return!1;const d=re(i,l.getUnitId());if(d==null)return!1;const u=d.getViewModel(),m=l==null?void 0:l.getUnitId(),g=new s.TextX,h=s.JSONX.getInstance(),p=is(r,u);if(p==null)return!1;const{offset:f,len:S,tableId:E,cursor:C}=p,b=[],R=[{startOffset:C,endOffset:C,collapsed:!0}],I={id:D.RichTextEditingMutation.id,params:{unitId:m,actions:[],textRanges:R}};f>0&&g.push({t:s.TextXActionType.RETAIN,len:f}),g.push({t:s.TextXActionType.DELETE,len:S});const O=Z(l,c);b.push(h.editOp(g.serialize(),O));const M=h.removeOp(["tableSource",E]);return b.push(M),I.params.actions=b.reduce((N,x)=>s.JSONX.compose(N,x),null),!!n.syncExecuteCommand(I.id,I.params)}},Li="doc.command.table-insert-row",Qi="doc.command.table-insert-column",Fl="doc.command.table-insert-row-above",Hl="doc.command.table-insert-row-bellow",kl="doc.command.table-insert-column-left",Vl="doc.command.table-insert-column-right",mn={id:Fl,type:s.CommandType.COMMAND,handler:async i=>i.get(s.ICommandService).executeCommand(Li,{position:jt.ABOVE})},pn={id:Hl,type:s.CommandType.COMMAND,handler:async i=>i.get(s.ICommandService).executeCommand(Li,{position:jt.BELLOW})},fn={id:kl,type:s.CommandType.COMMAND,handler:async i=>i.get(s.ICommandService).executeCommand(Qi,{position:ti.LEFT})},Sn={id:Vl,type:s.CommandType.COMMAND,handler:async i=>i.get(s.ICommandService).executeCommand(Qi,{position:ti.RIGHT})},Fi={id:Li,type:s.CommandType.COMMAND,handler:async(i,t)=>{const{position:e}=t,n=i.get(D.DocSelectionManagerService),o=i.get(s.IUniverInstanceService),a=i.get(s.ICommandService),r=n.getRectRanges(),c=n.getActiveTextRange(),l=ht(c,r);if(l==null)return!1;const{segmentId:A}=l,d=o.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A).getBody();if(d==null||u==null)return!1;const m=re(i,d.getUnitId());if(m==null)return!1;const g=m.getViewModel(),h=d==null?void 0:d.getUnitId(),p=new s.TextX,f=s.JSONX.getInstance(),S=Dr(l,e,g);if(S==null)return!1;const{offset:E,colCount:C,tableId:b,insertRowIndex:R}=S,I=[],O=E+2,M=[{startOffset:O,endOffset:O,collapsed:!0}],y={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:M}};E>0&&p.push({t:s.TextXActionType.RETAIN,len:E});const N=Mr(C);p.push({t:s.TextXActionType.INSERT,body:N,len:N.dataStream.length});const x=Z(d,A);I.push(f.editOp(p.serialize(),x));const w=Kt(C),H=f.insertOp(["tableSource",b,"tableRows",R],w);return I.push(H),y.params.actions=I.reduce((F,Q)=>s.JSONX.compose(F,Q),null),!!a.syncExecuteCommand(y.id,y.params)}},qs={id:Qi,type:s.CommandType.COMMAND,handler:async(i,t)=>{var X,Y,q;const{position:e}=t,n=i.get(D.DocSelectionManagerService),o=i.get(s.IUniverInstanceService),a=i.get(s.ICommandService),r=n.getRectRanges(),c=n.getActiveTextRange(),l=ht(c,r);if(l==null)return!1;const{segmentId:A}=l,d=o.getCurrentUniverDocInstance(),u=d==null?void 0:d.getSelfOrHeaderFooterModel(A).getBody();if(d==null||u==null)return!1;const m=re(i,d.getUnitId());if(m==null)return!1;const g=m.getViewModel(),h=d==null?void 0:d.getUnitId(),p=new s.TextX,f=s.JSONX.getInstance(),S=Br(l,e,g);if(S==null)return!1;const{offsets:E,columnIndex:C,tableId:b,rowCount:R}=S,I=[],O=E[0]+1,M=[{startOffset:O,endOffset:O,collapsed:!0}],y={id:D.RichTextEditingMutation.id,params:{unitId:h,actions:[],textRanges:M}};for(const K of E){p.push({t:s.TextXActionType.RETAIN,len:K});const $=xr();p.push({t:s.TextXActionType.INSERT,body:$,len:$.dataStream.length})}const N=Z(d,A);I.push(f.editOp(p.serialize(),N));for(let K=0;K<R;K++){const $=Xt(),ie=f.insertOp(["tableSource",b,"tableRows",K,"tableCells",C],$);I.push(ie)}const x=d.getSnapshot(),w=x.documentStyle,{marginLeft:H=0,marginRight:V=0}=w,F=((Y=(X=w.pageSize)==null?void 0:X.width)!=null?Y:800)-H-V,Q=(q=x==null?void 0:x.tableSource)==null?void 0:q[b].tableColumns,{newColWidth:j,widths:G}=_r(F,Q,C);for(let K=0;K<G.length;K++){const $=f.replaceOp(["tableSource",b,"tableColumns",K,"size","width","v"],Q[K].size.width.v,G[K]);I.push($)}const k=Yt(j),W=f.insertOp(["tableSource",b,"tableColumns",C],k);return I.push(W),y.params.actions=I.reduce((K,$)=>s.JSONX.compose(K,$),null),!!a.syncExecuteCommand(y.id,y.params)}},pe={id:"doc-paragraph-setting.command",type:s.CommandType.COMMAND,handler:async(i,t)=>{var C,b,R,I,O;const e=i.get(D.DocSelectionManagerService),n=i.get(s.IUniverInstanceService),o=i.get(s.ICommandService),a=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),r=e.getDocRanges();if(!a||r.length===0||!t)return!1;const c=r[0].segmentId,l=a.getUnitId(),A=a.getSelfOrHeaderFooterModel(c),d=(b=(C=A.getBody())==null?void 0:C.paragraphs)!=null?b:[],u=(I=(R=A.getBody())==null?void 0:R.dataStream)!=null?I:"",m=(O=s.BuildTextUtils.range.getParagraphsInRanges(r,d,u))!=null?O:[],g={id:D.RichTextEditingMutation.id,params:{unitId:l,actions:[],textRanges:r}},h=new s.MemoryCursor;h.reset();const p=new s.TextX,f=s.JSONX.getInstance();for(const M of m){const{startIndex:y}=M;p.push({t:s.TextXActionType.RETAIN,len:y-h.cursor});const N={...M.paragraphStyle,...t.paragraph};p.push({t:s.TextXActionType.RETAIN,len:1,body:{dataStream:"",paragraphs:[{...M,paragraphStyle:N,startIndex:0}]},coverType:s.UpdateDocsAttributeType.REPLACE}),h.moveCursorTo(y+1)}const S=Z(a,c);return g.params.actions=f.editOp(p.serialize(),S),!!o.syncExecuteCommand(g.id,g.params)}},Wl=()=>{const i=v.useDependency(D.DocSelectionManagerService),t=v.useDependency(rt),e=U.useMemo(()=>i.getDocRanges(),[]);return U.useEffect(()=>{e.length||t.closePanel()},[e]),e},zl=()=>{var l,A,d,u,m;const t=v.useDependency(s.IUniverInstanceService).getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),e=Wl();if(!t||e.length===0)return[];const n=e[0].segmentId,o=t.getSelfOrHeaderFooterModel(n),a=(A=(l=o.getBody())==null?void 0:l.paragraphs)!=null?A:[],r=(u=(d=o.getBody())==null?void 0:d.dataStream)!=null?u:"";return(m=s.BuildTextUtils.range.getParagraphsInRanges(e,a,r))!=null?m:[]},Gl=(i,t)=>{const e=v.useDependency(s.ICommandService),[n,o]=U.useState(()=>{var c,l;const r=i[0];return r?String((l=(c=r.paragraphStyle)==null?void 0:c.horizontalAlign)!=null?l:t):t});return[n,r=>(o(r),e.executeCommand(pe.id,{paragraph:{horizontalAlign:Number(r)}}))]},jl=i=>{const t=v.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=i[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentStart,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentStart:{v:a}}}))]},Xl=i=>{const t=v.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=i[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentEnd,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentEnd:{v:a}}}))]},Kl=i=>{const t=v.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=i[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.indentFirstLine,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{indentFirstLine:{v:a}}}))]},Yl=i=>{const t=v.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=i[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.hanging,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{hanging:{v:a}}}))]},ql=i=>{const t=v.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=i[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.spaceAbove,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{spaceAbove:{v:a}}}))]},Jl=i=>{const t=v.useDependency(s.ICommandService),[e,n]=U.useState(()=>{var r;const a=i[0];return a?_.getNumberUnitValue((r=a.paragraphStyle)==null?void 0:r.spaceBelow,0):0});return[e,a=>(n(a),t.executeCommand(pe.id,{paragraph:{spaceBelow:{v:a}}}))]},Zl=i=>{const t=v.useDependency(s.ICommandService),e=v.useDependency(_.IRenderManagerService),n=v.useDependency(s.IUniverInstanceService),o=U.useMemo(()=>{var h;const g=n.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(g)return(h=e.getRenderById(g==null?void 0:g.getUnitId()))==null?void 0:h.with(D.DocSkeletonManagerService).getSkeleton()},[]),a=U.useMemo(()=>new L.BehaviorSubject({}),[]),[r,c]=U.useState(()=>{var h,p;const g=i[0];return g&&(p=(h=g.paragraphStyle)==null?void 0:h.lineSpacing)!=null?p:1}),l=U.useRef(r),[A,d]=U.useState(()=>{var h,p;const g=i[0];return g&&(p=(h=g.paragraphStyle)==null?void 0:h.spacingRule)!=null?p:s.SpacingRule.AUTO}),u=async g=>{c(g),a.next({lineSpacing:g,spacingRule:A})},m=async g=>{if(g!==A){let h=l.current;if(g===s.SpacingRule.AT_LEAST){const p=o==null?void 0:o.findNodeByCharIndex(i[0].startIndex),f=p==null?void 0:p.parent,S=f==null?void 0:f.parent;(S==null?void 0:S.contentHeight)!==void 0&&(h=Math.max(S.contentHeight,h))}else h>5&&(h=2);l.current=r,u(h),d(g),a.next({spacingRule:g})}};return U.useEffect(()=>{const g=a.pipe(At.filter(h=>!!Object.keys(h).length),At.bufferTime(16),At.filter(h=>!!h.length),At.map(h=>h.reduce((p,f)=>(Object.keys(f).forEach(S=>{p[S]=f[S]}),p),{}))).subscribe(h=>t.executeCommand(pe.id,{paragraph:{...h}}));return()=>g.unsubscribe()},[]),{lineSpacing:[r,u],spacingRule:[A,m]}},Xe=i=>{const{value:t,onChange:e,className:n="",min:o=0,max:a=100,step:r=1}=i,c=U.useRef(null);return P.jsx(J.InputNumber,{step:r,ref:c,min:o,max:a,value:t,onChange:l=>{e(l!=null?l:0).finally(()=>{setTimeout(()=>{var A;(A=c.current)==null||A.focus()},30)})},className:n})};function $l(){const i=v.useDependency(s.LocaleService),t=U.useMemo(()=>[{label:i.t("toolbar.alignLeft"),value:String(s.HorizontalAlign.LEFT),icon:P.jsx(Fo,{})},{label:i.t("toolbar.alignCenter"),value:String(s.HorizontalAlign.CENTER),icon:P.jsx(Qo,{})},{label:i.t("toolbar.alignRight"),value:String(s.HorizontalAlign.RIGHT),icon:P.jsx(ko,{})},{label:i.t("toolbar.alignJustify"),value:String(s.HorizontalAlign.JUSTIFIED),icon:P.jsx(Ro,{})}],[]),e=zl(),[n,o]=Gl(e,t[0].value),[a,r]=jl(e),[c,l]=Xl(e),[A,d]=Kl(e),[u,m]=Yl(e),[g,h]=ql(e),[p,f]=Jl(e),{lineSpacing:[S,E],spacingRule:[C,b]}=Zl(e),R=U.useMemo(()=>C===s.SpacingRule.AUTO?{min:1,max:5,step:S<2?.5:1}:{min:1,max:100},[C,S]);return P.jsxs("div",{children:[P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:i.t("doc.paragraphSetting.alignment")}),P.jsx("div",{className:J.clsx("univer-mt-4 univer-box-border univer-flex univer-w-full univer-items-center univer-justify-between univer-gap-1 univer-rounded-md univer-p-1",J.borderClassName),children:t.map(I=>P.jsx(J.Tooltip,{title:I.label,placement:"bottom",children:P.jsx("span",{className:J.clsx("univer-flex univer-cursor-pointer univer-items-center univer-justify-center univer-rounded univer-bg-none univer-px-3 univer-py-1 hover:univer-bg-black/60",{"univer-bg-blend-color-dodge/90":n===I.value}),onClick:()=>o(I.value),children:I.icon})},I.value))}),P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:i.t("doc.paragraphSetting.indentation")}),P.jsxs("div",{children:[P.jsxs("div",{className:"univer-flex univer-justify-between univer-item-center",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[i.t("doc.paragraphSetting.left"),"(px)"]}),P.jsx(Xe,{className:"univer-mt-4",value:a,onChange:I=>r(I!=null?I:0)})]}),P.jsxs("div",{className:"univer-flex univer-justify-between univer-item-center",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[i.t("doc.paragraphSetting.right"),"(px)"]}),P.jsx(Xe,{className:"univer-mt-4",value:c,onChange:I=>l(I!=null?I:0)})]}),P.jsxs("div",{className:"univer-flex univer-justify-between univer-item-center",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[i.t("doc.paragraphSetting.firstLine"),"(px)"]}),P.jsx(Xe,{className:"univer-mt-4",value:A,onChange:I=>d(I!=null?I:0)})]}),P.jsxs("div",{className:"univer-flex univer-justify-between univer-item-center",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[i.t("doc.paragraphSetting.hanging"),"(px)"]}),P.jsx(Xe,{className:"univer-mt-4",value:u,onChange:I=>m(I!=null?I:0)})]})]}),P.jsx("div",{className:"univer-t-4 univer-text-sm univer-font-medium",children:i.t("doc.paragraphSetting.spacing")}),P.jsxs("div",{children:[P.jsxs("div",{className:"univer-flex univer-justify-betweenuniver-item-center",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[i.t("doc.paragraphSetting.before"),"(px)"]}),P.jsx(Xe,{className:"univer-mt-4",value:g,onChange:I=>h(I!=null?I:0)})]}),P.jsxs("div",{className:"univer-flex univer-justify-between univer-item-center",children:[P.jsxs("div",{className:"univer-mt-3 univer-text-xs",children:[i.t("doc.paragraphSetting.after"),"(px)"]}),P.jsx(Xe,{className:"univer-mt-4",value:p,onChange:I=>f(I!=null?I:0)})]}),P.jsxs("div",{className:"univer-flex univer-justify-between item-center",children:[P.jsx("div",{className:"univer-mt-3 univer-text-xs",children:i.t("doc.paragraphSetting.lineSpace")}),P.jsxs("div",{className:"univer-mt-4 univer-flex univer-flex-col univer-gap-1.5",style:{width:162},children:[P.jsx(J.Select,{value:`${C}`,options:[{label:i.t("doc.paragraphSetting.multiSpace"),value:`${s.SpacingRule.AUTO}`},{label:i.t("doc.paragraphSetting.fixedValue"),value:`${s.SpacingRule.AT_LEAST}`}],onChange:I=>b(Number(I))}),P.jsx(Xe,{...R,value:S,onChange:I=>E(I!=null?I:0)})]})]})]})]})}const ed=(i,t)=>t.length===i.length&&i.some(e=>t.some(n=>n.startOffset===e.startOffset&&n.endOffset===e.endOffset));function td(){const i=v.useDependency(s.ICommandService),t=v.useDependency(s.LocaleService),e=v.useObservable(t.currentLocale$),[n,o]=U.useState(""),a=U.useMemo(()=>s.debounce(()=>o(s.generateRandomId(4)),300),[]),r=U.useRef([]);return U.useEffect(()=>{const c=i.onCommandExecuted(l=>{if(D.SetTextSelectionsOperation.id===l.id){const A=l.params.ranges;ed(A,r.current)||o(s.generateRandomId(4)),r.current=A}D.RichTextEditingMutation.id===l.id&&l.params.trigger!==pe.id&&a()});return()=>c.dispose()},[a]),U.useEffect(()=>{o(s.generateRandomId(4))},[e]),U.useEffect(()=>()=>a.cancel(),[a]),P.jsx($l,{},n)}var nd=Object.getOwnPropertyDescriptor,id=(i,t,e,n)=>{for(var o=n>1?void 0:n?nd(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Hi=(i,t)=>(e,n)=>t(e,n,i);const Js="doc_ui_paragraph-setting-panel";let rt=class extends s.Disposable{constructor(t,e,n){super();B(this,"_id");this._commandService=t,this._componentManager=e,this._sidebarService=n,this._init()}_init(){this.disposeWithMe(this._componentManager.register(Js,td))}openPanel(){const t={header:{title:"doc.slider.paragraphSetting"},id:this._id,children:{label:Js},width:300};this._sidebarService.open(t)}closePanel(){this._sidebarService.close(this._id)}};rt=id([Hi(0,s.ICommandService),Hi(1,s.Inject(v.ComponentManager)),Hi(2,s.Inject(v.ISidebarService))],rt);const ki={id:"sidebar.operation.doc-paragraph-setting-panel",type:s.CommandType.OPERATION,handler:i=>(i.get(rt).openPanel(),!0)},Vi=i=>{const t=i.get(D.DocSelectionManagerService);return new L.Observable(e=>{const n=t.textSelection$.subscribe(()=>{t.getDocRanges().some(r=>r.collapsed===!1||r.rangeType===s.DOC_RANGE_TYPE.RECT)?e.next(!1):e.next(!0)});return()=>n.unsubscribe()})};function od(i){if(i.length<2)return!0;const t=i.map(e=>e.tableId);return t.every(e=>e===t[0])}function Zs(i,t,e){var a;const n=t.getRectRanges(),o=t.getActiveTextRange();if(n&&n.length&&od(n)&&o==null){i.next(!1);return}if(o&&(n==null||n.length===0)){const{segmentId:r,startOffset:c,endOffset:l}=o,A=e.getCurrentUniverDocInstance(),d=(a=A==null?void 0:A.getSelfOrHeaderFooterModel(r).getBody())==null?void 0:a.tables;if(d&&d.length&&d.some(u=>{const{startIndex:m,endIndex:g}=u;return c>m&&c<g||l>m&&l<g})){i.next(!1);return}}i.next(!0)}const Oe=i=>{const t=i.get(D.DocSelectionManagerService),e=i.get(s.IUniverInstanceService);return new L.Observable(n=>{const o=t.textSelection$.subscribe(()=>{Zs(n,t,e)});return Zs(n,t,e),()=>o.unsubscribe()})},sd=i=>({id:St.name,commandId:St.id,type:v.MenuItemType.BUTTON,icon:"Copy",title:"rightClick.copy",disabled$:Vi(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}),ad=i=>({id:ki.id,type:v.MenuItemType.BUTTON,icon:"MenuSingle24",title:"doc.menu.paragraphSetting",hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}),rd=i=>({id:en.id,type:v.MenuItemType.BUTTON,icon:"Copy",title:"rightClick.cut",disabled$:Vi(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}),cd=i=>({id:tn.id,type:v.MenuItemType.BUTTON,icon:"PasteSpecial",title:"rightClick.paste",hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}),ld=i=>({id:pt.id,type:v.MenuItemType.BUTTON,icon:"PasteSpecial",title:"rightClick.delete",disabled$:Vi(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}),$s="doc.menu.table-insert";function dd(i){return{id:$s,type:v.MenuItemType.SUBITEMS,title:"table.insert",icon:"Insert",hidden$:L.combineLatest(v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC),Oe(i),(t,e)=>t||e)}}function Ad(i){return{id:mn.id,type:v.MenuItemType.BUTTON,title:"table.insertRowAbove",icon:"InsertRowAbove",disabled$:Oe(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function ud(i){return{id:pn.id,type:v.MenuItemType.BUTTON,title:"table.insertRowBelow",icon:"InsertRowBelow",disabled$:Oe(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function gd(i){return{id:fn.id,type:v.MenuItemType.BUTTON,title:"table.insertColumnLeft",icon:"LeftInsertColumn",disabled$:Oe(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function hd(i){return{id:Sn.id,type:v.MenuItemType.BUTTON,title:"table.insertColumnRight",icon:"RightInsertColumn",disabled$:Oe(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}const ea="doc.menu.table-delete";function md(i){return{id:ea,type:v.MenuItemType.SUBITEMS,title:"table.delete",icon:"Reduce",hidden$:L.combineLatest(v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC),Oe(i),(t,e)=>t||e)}}function pd(i){return{id:gn.id,type:v.MenuItemType.BUTTON,title:"table.deleteRows",icon:"DeleteRow",disabled$:Oe(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function fd(i){return{id:hn.id,type:v.MenuItemType.BUTTON,title:"table.deleteColumns",icon:"DeleteColumn",disabled$:Oe(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}function Sd(i){return{id:at.id,type:v.MenuItemType.BUTTON,title:"table.deleteTable",icon:"GridSingle",disabled$:Oe(i),hidden$:v.getMenuHiddenObservable(i,s.UniverInstanceType.UNIVER_DOC)}}const ta={[v.RibbonStartGroup.FORMAT]:{[De.id]:{order:0,menuItemFactory:lc},[Be.id]:{order:1,menuItemFactory:dc},[_e.id]:{order:2,menuItemFactory:Ac},[Ne.id]:{order:3,menuItemFactory:uc},[ye.id]:{order:4,menuItemFactory:gc},[Pe.id]:{order:5,menuItemFactory:hc},[de.id]:{order:5.5,menuItemFactory:fc},[he.id]:{order:6,menuItemFactory:pc},[We.id]:{order:7,menuItemFactory:mc},[Ue.id]:{order:8,menuItemFactory:Sc},[we.id]:{order:9,menuItemFactory:Dc,[tt.id]:{order:0,menuItemFactory:xc}}},[v.RibbonStartGroup.LAYOUT]:{[Ls]:{order:1,menuItemFactory:Ec,[rn.id]:{order:0,menuItemFactory:Cc}},[Tt.id]:{order:2,menuItemFactory:Tc},[yt.id]:{order:3,menuItemFactory:yc},[bt.id]:{order:4,menuItemFactory:bc},[Ot.id]:{order:5,menuItemFactory:Oc},[vt.id]:{order:6,menuItemFactory:Rc},[ot.id]:{order:7,menuItemFactory:Qs},[it.id]:{order:8,menuItemFactory:Fs},[Ct.id]:{order:9,menuItemFactory:Hs},[Zn.id]:{order:10,menuItemFactory:vc},[Rt.id]:{order:11,menuItemFactory:Mc},[Ui.id]:{order:12,menuItemFactory:Bc}},[v.ContextMenuPosition.MAIN_AREA]:{[v.ContextMenuGroup.FORMAT]:{[St.name]:{order:0,menuItemFactory:sd},[en.id]:{order:1,menuItemFactory:rd},[tn.id]:{order:2,menuItemFactory:cd},[pt.id]:{order:3,menuItemFactory:ld}},[v.ContextMenuGroup.LAYOUT]:{[ki.id]:{order:0,menuItemFactory:ad},[$s]:{order:1,menuItemFactory:dd,[mn.id]:{order:1,menuItemFactory:Ad},[pn.id]:{order:2,menuItemFactory:ud},[fn.id]:{order:3,menuItemFactory:gd},[Sn.id]:{order:4,menuItemFactory:hd}},[ea]:{order:2,menuItemFactory:md,[gn.id]:{order:1,menuItemFactory:pd},[hn.id]:{order:2,menuItemFactory:fd},[at.id]:{order:3,menuItemFactory:Sd}}}},[v.ContextMenuPosition.PARAGRAPH]:{[v.ContextMenuGroup.QUICK]:{[Ri.id]:{order:0,menuItemFactory:Nc},[Mi.id]:{order:1,menuItemFactory:Pc},[xi.id]:{order:2,menuItemFactory:Uc},[Di.id]:{order:3,menuItemFactory:wc},[Bi.id]:{order:4,menuItemFactory:Lc},[an.id]:{order:5,menuItemFactory:Qc},[ot.id]:{order:6,menuItemFactory:Qs},[it.id]:{order:7,menuItemFactory:Fs},[Ct.id]:{order:8,menuItemFactory:Hs}},[v.ContextMenuGroup.FORMAT]:{[hi.id]:{order:0,menuItemFactory:Fc},[mi.id]:{order:1,menuItemFactory:Hc},[ci.id]:{order:2,menuItemFactory:kc}},[v.ContextMenuGroup.LAYOUT]:{[Vs]:{menuItemFactory:jc,[Ti.id]:{order:0,menuItemFactory:Vc},[yi.id]:{order:1,menuItemFactory:Wc},[bi.id]:{order:2,menuItemFactory:zc},[Si.id]:{order:3,menuItemFactory:Gc}}}}};var vd=Object.getOwnPropertyDescriptor,Id=(i,t,e,n)=>{for(var o=n>1?void 0:n?vd(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Re=(i,t)=>(e,n)=>t(e,n,i);T.DocUIController=class extends s.Disposable{constructor(t,e,n,o,a,r,c,l,A){super(),this._injector=t,this._componentManager=e,this._commandService=n,this._layoutService=o,this._menuManagerService=a,this._uiPartsService=r,this._univerInstanceService=c,this._shortcutService=l,this._configService=A,this._init()}_initCustomComponents(){const t=this._componentManager;this.disposeWithMe(t.register(ei,J.ColorPicker)),this.disposeWithMe(t.register(qo,v.FontFamily)),this.disposeWithMe(t.register(Jo,v.FontFamilyItem)),this.disposeWithMe(t.register(Zo,v.FontSize)),this.disposeWithMe(t.register(ts,Or)),this.disposeWithMe(t.register(es,yr)),this.disposeWithMe(t.register("TodoList",Vo)),this.disposeWithMe(t.register("doc.paragraph.menu",ll)),this.disposeWithMe(t.register("CutSingle",xo)),this.disposeWithMe(t.register("DeleteSingle",Do)),this.disposeWithMe(t.register(Pi,sc)),this.disposeWithMe(t.register("DocumentSettingSingle",Bo))}_initUiParts(){this.disposeWithMe(this._uiPartsService.registerComponent(v.BuiltInUIPart.FOOTER,()=>v.connectInjector(xl,this._injector))),this.disposeWithMe(this._uiPartsService.registerComponent(v.BuiltInUIPart.CONTENT,()=>v.connectInjector(Ll,this._injector)))}_initMenus(){this._menuManagerService.mergeMenu(ta)}_initShortCut(){[gl,hl,ml,pl,fl,Sl,El,Cl,Il,vl,Tl,yl,Al].forEach(t=>{this.disposeWithMe(this._shortcutService.registerShortcut(t))})}_init(){this._initCustomComponents(),this._initMenus(),this._initFocusHandler(),this._initCommands(),this._initUiParts(),this._initShortCut()}_initCommands(){[Yo,Zn,qn].forEach(t=>this.disposeWithMe(this._commandService.registerCommand(t)))}_initFocusHandler(){this.disposeWithMe(this._layoutService.registerFocusHandler(s.UniverInstanceType.UNIVER_DOC,t=>{this._injector.get(_.IRenderManagerService).getRenderById(t).with(T.DocSelectionRenderService).focus()}))}},T.DocUIController=Id([Re(0,s.Inject(s.Injector)),Re(1,s.Inject(v.ComponentManager)),Re(2,s.ICommandService),Re(3,v.ILayoutService),Re(4,v.IMenuManagerService),Re(5,v.IUIPartsService),Re(6,s.IUniverInstanceService),Re(7,v.IShortcutService),Re(8,s.IConfigService)],T.DocUIController);var Ed=Object.getOwnPropertyDescriptor,Cd=(i,t,e,n)=>{for(var o=n>1?void 0:n?Ed(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Wi=(i,t)=>(e,n)=>t(e,n,i);const na=1.5;T.DocBackScrollRenderController=class extends s.RxDisposable{constructor(t,e,n,o){super(),this._context=t,this._textSelectionManagerService=e,this._editorService=n,this._docSkeletonManagerService=o,this._init()}_init(){this._textSelectionManagerService.textSelection$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{if(t==null)return;const{isEditing:e,unitId:n}=t;n!==this._context.unitId||!e||this._context.unitId!==s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY&&this._scrollToSelection()})}scrollToRange(t){const e=this._docSkeletonManagerService.getSkeleton();if(!e)return;const{startOffset:n}=t,o=e.findNodePositionByCharIndex(n);o&&this.scrollToNode(o)}scrollToNode(t){var N;const{unitId:e,scene:n,mainComponent:o}=this._context,a=this._docSkeletonManagerService.getSkeleton();if(o==null||a==null)return;const r=o.getOffsetConfig(),{docsLeft:c,docsTop:l}=r,A=new Ie(r,a),{contentBoxPointGroup:d}=A.getRangePointData(t,t),{left:u,top:m,height:g}=ut(d),h=u+c,p=m+l,f=n.getViewport(ae.VIEW_MAIN),S=this._editorService.getEditor(e);if(f==null)return;const{left:E,top:C,right:b,bottom:R}=f.getBounding().viewBound;let I=0,O=0;const M=S?(N=S.params.backScrollOffset)!=null?N:0:100;p<C?I=p-C-M:p>R-g&&(I=p-R+g+M),h<E?O=h-E:h>b-na&&(O=h-b+na);const y=f.transViewportScroll2ScrollValue(O,I);f.scrollByBarDeltaValue(y)}_scrollToSelection(){const t=this._textSelectionManagerService.getActiveTextRange();if(t==null)return;const{collapsed:e,startNodePosition:n}=t;e&&this.scrollToNode(n)}},T.DocBackScrollRenderController=Cd([Wi(1,s.Inject(D.DocSelectionManagerService)),Wi(2,ce),Wi(3,s.Inject(D.DocSkeletonManagerService))],T.DocBackScrollRenderController);var Td=Object.getOwnPropertyDescriptor,yd=(i,t,e,n)=>{for(var o=n>1?void 0:n?Td(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},ct=(i,t)=>(e,n)=>t(e,n,i);T.DocRenderController=class extends s.RxDisposable{constructor(t,e,n,o,a,r,c){super(),this._context=t,this._commandService=e,this._docSelectionRenderService=n,this._docSkeletonManagerService=o,this._editorService=a,this._renderManagerService=r,this._univerInstanceService=c,this._addNewRender(),this._initRenderRefresh(),this._initCommandListener()}reRender(t){var r,c;const e=(r=this._renderManagerService.getRenderById(t))==null?void 0:r.with(D.DocSkeletonManagerService),n=e==null?void 0:e.getSkeleton();if(!n||!!n.getViewModel().getDataModel().getSnapshot().disabled)return;n.calculate();const a=this._editorService.getEditor(t);if(this._editorService.isEditor(t)&&!(a!=null&&a.params.scrollBar)){(c=this._context.mainComponent)==null||c.makeDirty();return}this._recalculateSizeBySkeleton(n)}_addNewRender(){const{scene:t,engine:e}=this._context,n=new _.Viewport(ae.VIEW_MAIN,t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.attachControl(),t.onMouseWheel$.subscribeEvent((a,r)=>{const c=this._univerInstanceService.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if((c==null?void 0:c.getUnitId())!==this._context.unitId)return;const l=a;if(l.ctrlKey){const A=Math.abs(l.deltaX);let d=A<40?.2:A<80?.4:.2;d*=l.deltaY>0?-1:1,t.scaleX<1&&(d/=2),t.scaleX+d>4?t.scale(4,4):t.scaleX+d<.1?t.scale(.1,.1):l.preventDefault()}else n.onMouseWheel(l,r)}),new _.ScrollBar(n),t.addLayer(new _.Layer(t,[],Lt),new _.Layer(t,[],lo)),this._addComponent();const o=()=>t.render();this.disposeWithMe(this._context.activated$.subscribe(a=>{a?e.runRenderLoop(o):e.stopRenderLoop(o)})),this._docSelectionRenderService.__attachScrollEvent()}_addComponent(){const{scene:t,unit:e,components:n}=this._context,r={pageMarginLeft:20,pageMarginTop:20},c=new _.Documents(Ae.MAIN,void 0,r);c.zIndex=Bn;const l=new _.DocBackground(Ae.BACKGROUND,void 0,r);l.zIndex=Bn,this._context.mainComponent=c,n.set(Ae.MAIN,c),n.set(Ae.BACKGROUND,l),t.addObjects([c],Lt),t.addObjects([l],co),this._editorService.getEditor(e.getUnitId())==null&&t.enableLayerCache(Lt)}_initRenderRefresh(){this._docSkeletonManagerService.currentSkeletonBefore$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{this._create(t)})}_create(t){var l;if(!t)return;const{mainComponent:e,components:n}=this._context,o=e,a=n.get(Ae.BACKGROUND);o.changeSkeleton(t),a.changeSkeleton(t);const{unitId:r}=this._context,c=this._editorService.getEditor(r);if(this._editorService.isEditor(r)&&!(c!=null&&c.params.scrollBar)){(l=this._context.mainComponent)==null||l.makeDirty();return}this._recalculateSizeBySkeleton(t)}_initCommandListener(){const t=[D.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{unitId:o}=n;this.reRender(o)}}))}_recalculateSizeBySkeleton(t){var h;const{mainComponent:e,scene:n,unitId:o,components:a}=this._context,r=e,c=a.get(Ae.BACKGROUND),l=(h=t.getSkeletonData())==null?void 0:h.pages;if(l==null)return;let A=0,d=0;const m=this._context.unit.getSnapshot().documentStyle.documentFlavor;for(let p=0,f=l.length;p<f;p++){const S=l[p];let{pageWidth:E,pageHeight:C}=S;if(m===s.DocumentFlavor.MODERN){const b=bd(S);E=b.pageWidth,C=b.pageHeight}r.pageLayoutType===_.PageLayoutType.VERTICAL?(d+=C,d+=r.pageMarginTop,p===f-1&&(d+=r.pageMarginTop),A=Math.max(A,E)):r.pageLayoutType===_.PageLayoutType.HORIZONTAL&&(A+=E,p!==f-1&&(A+=r.pageMarginLeft),d=Math.max(d,C))}r.resize(A,d),c.resize(A,d);const g=this._editorService.getEditor(o);(!this._editorService.isEditor(o)||g!=null&&g.params.scrollBar)&&n.resize(A,d)}},T.DocRenderController=yd([ct(1,s.ICommandService),ct(2,s.Inject(T.DocSelectionRenderService)),ct(3,s.Inject(D.DocSkeletonManagerService)),ct(4,ce),ct(5,_.IRenderManagerService),ct(6,s.IUniverInstanceService)],T.DocRenderController);function bd(i){let{pageWidth:t,pageHeight:e}=i;const{marginLeft:n,marginRight:o,marginTop:a,marginBottom:r,skeDrawings:c,skeTables:l}=i;t===Number.POSITIVE_INFINITY&&(t=i.width+n+o),e===Number.POSITIVE_INFINITY&&(e=i.height+a+r);for(const A of c.values())t=Math.max(t,A.aLeft+A.width+n+o),e=Math.max(e,A.aTop+A.height+a+r);for(const A of l.values())t=Math.max(t,A.left+A.width+n+o),e=Math.max(e,A.top+A.height+a+r);return{pageWidth:t,pageHeight:e}}const zi={id:"doc.command.select-all",type:s.CommandType.COMMAND,handler:async i=>{var g;const t=i.get(s.IUniverInstanceService),e=i.get(D.DocSelectionManagerService),n=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC),o=e.getDocRanges(),a=(g=o.find(h=>h.isActive))!=null?g:o[0];if(n==null||a==null)return!1;const{segmentId:r}=a,c=n.getUnitId(),l=n.getSelfOrHeaderFooterModel(r).getSnapshot().body;if(l==null)return!1;const{tables:A=[],dataStream:d}=l;if(d===`\r
`)return!0;const u=[];let m=0;for(const h of A){const{startIndex:p,endIndex:f}=h;m!==p&&u.push({startOffset:m,endOffset:p-1,rangeType:s.DOC_RANGE_TYPE.TEXT}),u.push({startOffset:p+3,endOffset:f-5,rangeType:s.DOC_RANGE_TYPE.RECT}),m=f}return m!==l.dataStream.length-2&&u.push({startOffset:m,endOffset:l.dataStream.length-2,rangeType:s.DOC_RANGE_TYPE.TEXT}),e.replaceDocRanges(u,{unitId:c,subUnitId:c},!1),!0}};class _t extends s.RxDisposable{constructor(e){super();B(this,"_previousActiveRange",null);B(this,"_undoMutationParamsCache",[]);B(this,"_redoMutationParamsCache",[]);this._context=e}clearUndoRedoMutationParamsCache(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[]}getUndoRedoMutationParamsCache(){return{undoCache:this._undoMutationParamsCache,redoCache:this._redoMutationParamsCache}}setUndoRedoMutationParamsCache({undoCache:e=[],redoCache:n=[]}){this._undoMutationParamsCache=e,this._redoMutationParamsCache=n}getActiveRange(){return this._previousActiveRange}setActiveRange(e){this._previousActiveRange=e}pushUndoRedoMutationParams(e,n){this._undoMutationParamsCache.push(e),this._redoMutationParamsCache.push(n)}fetchComposedUndoRedoMutationParams(){if(this._undoMutationParamsCache.length===0||this._previousActiveRange==null||this._redoMutationParamsCache.length===0)return null;const{unitId:e}=this._undoMutationParamsCache[0],n={unitId:e,actions:this._undoMutationParamsCache.reverse().reduce((a,r)=>s.JSONX.compose(a,r.actions),null),textRanges:[]};return{redoMutationParams:{unitId:e,actions:this._redoMutationParamsCache.reduce((a,r)=>s.JSONX.compose(a,r.actions),null),textRanges:[]},undoMutationParams:n,previousActiveRange:this._previousActiveRange}}dispose(){this._undoMutationParamsCache=[],this._redoMutationParamsCache=[],this._previousActiveRange=null}}const Gi={id:"doc.command.ime-input",type:s.CommandType.COMMAND,handler:async(i,t)=>{var Q,j,G;const{unitId:e,newText:n,oldTextLen:o,isCompositionEnd:a,isCompositionStart:r}=t,c=i.get(s.ICommandService),l=i.get(_.IRenderManagerService),A=i.get(s.IUniverInstanceService),d=i.get(Te),u=(Q=l.getRenderById(e))==null?void 0:Q.with(_t),m=A.getUnit(e,s.UniverInstanceType.UNIVER_DOC);if(m==null||u==null)return!1;const g=u.getActiveRange();if(g==null)return!1;const{style:h,segmentId:p}=g,f=m.getSelfOrHeaderFooterModel(p).getBody();if(f==null)return!1;Object.assign(g,g);const{startOffset:E,endOffset:C}=g,b=n.length,R=[{startOffset:E+b,endOffset:E+b,collapsed:!0,style:h}],I={id:D.RichTextEditingMutation.id,params:{unitId:e,actions:[],textRanges:R}},O=d.getDefaultStyle(),M=d.getStyleCache(),y=_n((j=f.customRanges)!=null?j:[],E+o,s.SHEET_EDITOR_UNITS.includes(e)),N=Qt(f,r?C:E+o,O,M,s.SHEET_EDITOR_UNITS.includes(e)),x=Nn((G=f.customDecorations)!=null?G:[],E+o),w=new s.TextX,H=s.JSONX.getInstance();if(!g.collapsed&&r){const k=s.BuildTextUtils.selection.delete([g],f,0,null,!1);w.push(...k),I.params.textRanges=[{startOffset:E+b,endOffset:E+b,collapsed:!0}]}else w.push({t:s.TextXActionType.RETAIN,len:E});o>0&&w.push({t:s.TextXActionType.DELETE,len:o}),w.push({t:s.TextXActionType.INSERT,body:{dataStream:n,textRuns:N?[{...N,st:0,ed:n.length}]:[],customRanges:y?[{...y,startIndex:0,endIndex:n.length-1}]:[],customDecorations:x.map(k=>({...k,startIndex:0,endIndex:n.length-1}))},len:n.length});const V=Z(m,p);I.params.actions=H.editOp(w.serialize(),V),I.params.noHistory=!a,I.params.isCompositionEnd=a;const F=c.syncExecuteCommand(I.id,I.params);return u.pushUndoRedoMutationParams(F,I.params),!!F}},ia={id:"doc.command.insert-custom-range",type:s.CommandType.COMMAND,handler:(i,t)=>{if(!t)return!1;const e=i.get(s.ICommandService),{unitId:n,rangeId:o=s.generateRandomId(),textRanges:a,properties:r,text:c,wholeEntity:l}=t,A={unitId:n,textRanges:a,body:{dataStream:c,customRanges:[{startIndex:0,endIndex:c.length-1,rangeId:o,rangeType:s.CustomRangeType.CUSTOM,properties:r,wholeEntity:l}]}};return e.syncExecuteCommand(Un.id,A)}},Nt={type:s.CommandType.COMMAND,id:"doc.command.set-zoom-ratio",handler:async(i,t)=>{var u,m,g;const e=i.get(s.ICommandService),n=i.get(s.IUndoRedoService),o=i.get(s.IUniverInstanceService);let a=(u=o.getCurrentUniverDocInstance())==null?void 0:u.getUnitId();if(!a)return!1;let r=1;if(t&&(a=(m=t.documentId)!=null?m:a,r=(g=t.zoomRatio)!=null?g:r),!o.getUniverDocInstance(a))return!1;const l={zoomRatio:r,unitId:a},A=Xc(i,l);return e.syncExecuteCommand(ge.id,l)?(n.pushUndoRedo({unitID:a,undoMutations:[{id:ge.id,params:A}],redoMutations:[{id:ge.id,params:l}]}),!0):!1}},ji={id:"doc.table.tab-in-table",type:s.CommandType.COMMAND,handler:async(i,t)=>{var h;const{shift:e}=t,n=i.get(D.DocSelectionManagerService),o=n.getDocRanges(),a=i.get(s.ICommandService),c=i.get(s.IUniverInstanceService).getCurrentUniverDocInstance();if(!c)return!1;const l=(h=o.find(p=>p.isActive))!=null?h:o[0],A=c.getUnitId(),d=re(i,A),u=d==null?void 0:d.getSkeleton(),m=u==null?void 0:u.getViewModel().getSelfOrHeaderFooterViewModel(l==null?void 0:l.segmentId);if(m==null||l==null)return!1;let g=null;if(e?g=os(m,l,ii.PREV):g=os(m,l,ii.NEXT),g){const{startOffset:p,endOffset:f}=g,S=[{startOffset:p,endOffset:f}];return n.replaceDocRanges(S),!0}return e===!1?await a.executeCommand(Fi.id,{position:jt.BELLOW}):!0}};var Od=Object.getOwnPropertyDescriptor,Rd=(i,t,e,n)=>{for(var o=n>1?void 0:n?Od(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Xi=(i,t)=>(e,n)=>t(e,n,i);let Ki=class{constructor(i,t,e){B(this,"_docContainer");B(this,"getComponent",i=>{if(this._docContainer=i,!i.getContentRef().current)throw new Error("container is not ready")});B(this,"changeLocale",i=>{this._localeService.setLocale(i)});this._localeService=i,this._injector=t,this._configService=e}getUIConfig(){return{injector:this._injector,config:this._configService.getConfig(un),changeLocale:this.changeLocale,getComponent:this.getComponent}}getContentRef(){return this._docContainer.getContentRef()}UIDidMount(i){if(this._docContainer)return i(this._docContainer)}getDocContainer(){return this._docContainer}};Ki=Rd([Xi(0,s.Inject(s.LocaleService)),Xi(1,s.Inject(s.Injector)),Xi(2,s.IConfigService)],Ki);var Md=Object.getOwnPropertyDescriptor,xd=(i,t,e,n)=>{for(var o=n>1?void 0:n?Md(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Dd=(i,t)=>(e,n)=>t(e,n,i);let vn=class extends s.RxDisposable{constructor(t){super();B(this,"_docContainerController");this._injector=t,this._docContainerController=this._injector.createInstance(Ki)}};vn=xd([Dd(0,s.Inject(s.Injector))],vn);var Bd=Object.getOwnPropertyDescriptor,_d=(i,t,e,n)=>{for(var o=n>1?void 0:n?Bd(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},oa=(i,t)=>(e,n)=>t(e,n,i);let In=class extends s.Disposable{constructor(i,t){super(),this._docAutoFormatService=i,this._renderManagerService=t,this._initListTabAutoFormat(),this._initSpaceAutoFormat(),this._initDefaultEnterFormat(),this._initExitListAutoFormat()}_initListTabAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:je.id,match:i=>{var o;const{selection:t,paragraphs:e,unit:n}=i;if(e.length===1&&t.startOffset===e[0].paragraphStart&&e[0].bullet){const a=(o=n.getBody())==null?void 0:o.paragraphs,r=a==null?void 0:a.filter(c=>{var l;return((l=c.bullet)==null?void 0:l.listId)===e[0].bullet.listId});return(r==null?void 0:r.findIndex(c=>c.startIndex===e[0].startIndex))!==0}else if(e.length>1&&e.some(a=>a.bullet))return!0;return!1},getMutations(i){const t=i.commandParams;return[{id:sn.id,params:{type:t!=null&&t.shift?Et.decrease:Et.increase}}]},priority:100})),this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:je.id,match:i=>{const{selection:t,unit:e}=i,{startNodePosition:n,endNodePosition:o}=t,a=this._renderManagerService.getRenderById(e.getUnitId()),r=a==null?void 0:a.with(D.DocSkeletonManagerService).getSkeleton();return r==null?!1:!!(n&&o&&Io(r,n,o)||n&&!o&&n.path.indexOf("cells")>-1)},getMutations(i){const t=i.commandParams;return[{id:ji.id,params:{shift:!!(t!=null&&t.shift)}}]},priority:99}))}_initSpaceAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:Bt.id,match:i=>{var a;const{selection:t,paragraphs:e,unit:n}=i;if(!t.collapsed||e.length!==1||!t.collapsed)return!1;const o=(a=n.getBody())==null?void 0:a.dataStream.slice(e[0].paragraphStart,t.startOffset-1);return!!(o&&(Object.keys(s.QuickListTypeMap).includes(o)||Object.keys(Oi).includes(o)))},getMutations(i){var a;const{paragraphs:t,unit:e,selection:n}=i,o=(a=e.getBody())==null?void 0:a.dataStream.slice(t[0].paragraphStart,n.startOffset-1);if(o&&Object.keys(s.QuickListTypeMap).includes(o)){const r=s.QuickListTypeMap[o];return[{id:Ei.id,params:{listType:r,paragraph:t[0]}}]}if(o&&Object.keys(Oi).includes(o)){const r=Oi[o];return[{id:_s.id,params:{value:r}}]}return[]}}))}_initExitListAutoFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:st.id,match:i=>{const{paragraphs:t}=i;return!!(t.length===1&&t[0].bullet&&t[0].paragraphStart===t[0].paragraphEnd)},getMutations:i=>{const t=i.paragraphs[0].bullet;return t?t.nestingLevel>0?[{id:sn.id,params:{type:Et.decrease}}]:[{id:nt.id,params:{listType:i.paragraphs[0].bullet.listType}}]:[]}}))}_initDefaultEnterFormat(){this.disposeWithMe(this._docAutoFormatService.registerAutoFormat({id:st.id,match:()=>!0,getMutations(){return[{id:on.id}]},priority:-9999}))}};In=_d([oa(0,s.Inject(T.DocAutoFormatService)),oa(1,_.IRenderManagerService)],In);function Nd(i){return i.rows[0].cells[0].sections[0].columns[0].lines[0]}function Pd(i){const t=i.rows[i.rows.length-1],e=t.cells[t.cells.length-1];return _.getLastLine(e)}function Ud(i,t){const{ed:e}=i,{skeTables:n}=t;let o=null;for(const a of n.values())if(a.st===e+1){o=a;break}return o}function sa(i){const t=i==null?void 0:i.parent;let e=null,n=null;if(i==null||t==null)return{lineBeforeTable:e,lineAfterTable:n};const{st:o,ed:a}=i,r=t.type===_.DocumentSkeletonPageType.CELL?[t]:t.parent.pages;return _.lineIterator(r,c=>{c.st===a+1?n=c:c.ed===o-1&&(e=c)}),{lineBeforeTable:e,lineAfterTable:n}}function aa(i){return i.sections[0].columns[0].lines.length===0}function ra(i){var r,c;const t=i.parent,e=t==null?void 0:t.parent,n=e==null?void 0:e.tableId;if(t==null||e==null)return;const o=t.cells.indexOf(i);let a=e.rows[e.rows.indexOf(t)+1];if(a==null&&n.indexOf("#-#")){const[l,A]=n.split("#-#"),d=(c=(r=e.parent)==null?void 0:r.parent)==null?void 0:c.pages,u=`${l}#-#${Number.parseInt(A)+1}`;if(d)for(const m of d){const{skeTables:g}=m;if(g.has(u)){const h=g.get(u);if(h!=null&&h.rows.length){a=h.rows.find(p=>!p.isRepeatRow);break}}}}if(a!=null){const l=a.cells[o];return aa(l)?ra(l):l}}function ca(i){var a,r;const t=i.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;let n=e.rows[e.rows.indexOf(t)-1];const o=t.cells.indexOf(i);if((n==null||n.isRepeatRow)&&e.tableId.indexOf("#-#")){const[c,l]=e.tableId.split("#-#"),A=(r=(a=e.parent)==null?void 0:a.parent)==null?void 0:r.pages,d=`${c}#-#${Number.parseInt(l)-1}`;if(A)for(const u of A){const{skeTables:m}=u;if(m.has(d)){const g=m.get(d);if(g!=null&&g.rows.length){n=g.rows[g.rows.length-1];break}}}}if(n!=null){const c=n.cells[o];return aa(c)?ca(c):c}}function wd(i,t){const{st:e}=i,{skeTables:n}=t;let o=null;for(const a of n.values())if(a.ed===e-1){o=a;break}return o}function Ld(i){return i.sections[0].columns[0].lines[0]}function Qd(i){const t=_.getLastColumn(i);return t.lines[t.lines.length-1]}var Fd=Object.getOwnPropertyDescriptor,Hd=(i,t,e,n)=>{for(var o=n>1?void 0:n?Fd(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},En=(i,t)=>(e,n)=>t(e,n,i);let Cn=class extends s.Disposable{constructor(t,e,n,o){super();B(this,"_onInputSubscription");this._univerInstanceService=t,this._renderManagerService=e,this._textSelectionManagerService=n,this._commandService=o,this._commandExecutedListener()}dispose(){var t;super.dispose(),(t=this._onInputSubscription)==null||t.unsubscribe()}_commandExecutedListener(){const t=[Ee.id,Ce.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(!t.includes(e.id))return;const n=e.params;switch(e.id){case Ee.id:return this._handleMoveCursor(n.direction);case Ce.id:return this._handleShiftMoveSelection(n.direction);default:throw new Error("Unknown command")}}))}_handleShiftMoveSelection(t){var C,b,R;const e=this._textSelectionManagerService.getActiveTextRange(),n=this._textSelectionManagerService.getTextRanges(),o=this._univerInstanceService.getCurrentUniverDocInstance();if(o==null)return;const a=(C=this._renderManagerService.getRenderById(o.getUnitId()))==null?void 0:C.with(D.DocSkeletonManagerService).getSkeleton(),r=this._getDocObject();if(e==null||a==null||r==null)return;const{startOffset:c,endOffset:l,style:A,collapsed:d,direction:u,segmentId:m,startNodePosition:g,endNodePosition:h,segmentPage:p}=e;if(n.length>1){let I=Number.POSITIVE_INFINITY,O=Number.NEGATIVE_INFINITY;for(const M of n)I=Math.min(I,M.startOffset),O=Math.max(O,M.endOffset);this._textSelectionManagerService.replaceTextRanges([{startOffset:t===s.Direction.LEFT||t===s.Direction.UP?O:I,endOffset:t===s.Direction.LEFT||t===s.Direction.UP?I:O,style:A}],!1);return}const f=d||u===s.RANGE_DIRECTION.FORWARD?c:l;let S=d||u===s.RANGE_DIRECTION.FORWARD?l:c;const E=(b=o.getSelfOrHeaderFooterModel(m).getBody().dataStream.length)!=null?b:Number.POSITIVE_INFINITY;if(t===s.Direction.LEFT||t===s.Direction.RIGHT){const I=a.findNodeByCharIndex(S-1,m,p),O=a.findNodeByCharIndex(S,m,p);S=t===s.Direction.RIGHT?S+O.count:S-((R=I==null?void 0:I.count)!=null?R:0),S=Math.min(E-2,Math.max(0,S)),this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:S,style:A}],!1),this._scrollToFocusNodePosition(o.getUnitId(),S)}else{const I=a.findNodeByCharIndex(S,m,p),O=r.document.getOffsetConfig(),M=d?g:u===s.RANGE_DIRECTION.FORWARD?h:g,y=this._getTopOrBottomPosition(a,I,M,t===s.Direction.DOWN,!0);if(y==null){const x=t===s.Direction.UP?0:E-2;if(x===S)return;this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:x,style:A}],!1);return}const N=new Ie(O,a).getRangePointData(y,y).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{startOffset:f,endOffset:N.endOffset,style:A}],!1),this._scrollToFocusNodePosition(o.getUnitId(),N.endOffset)}}_handleMoveCursor(t){var E,C,b,R;const e=this._textSelectionManagerService.getActiveTextRange(),n=this._textSelectionManagerService.getTextRanges(),o=this._univerInstanceService.getCurrentUniverDocInstance();if(o==null)return!1;const a=(E=this._renderManagerService.getRenderById(o.getUnitId()))==null?void 0:E.with(D.DocSkeletonManagerService).getSkeleton(),r=this._getDocObject();if(e==null||a==null||r==null||n==null)return;const{startOffset:c,endOffset:l,style:A,collapsed:d,segmentId:u,startNodePosition:m,endNodePosition:g,segmentPage:h}=e,p=o.getSelfOrHeaderFooterModel(u).getBody();if(p==null)return;const f=(C=p.dataStream.length)!=null?C:Number.POSITIVE_INFINITY,S=(b=o.getCustomRanges())!=null?b:[];if(t===s.Direction.LEFT||t===s.Direction.RIGHT){let I;if(!e.collapsed||n.length>1){let y=Number.POSITIVE_INFINITY,N=Number.NEGATIVE_INFINITY;for(const x of n)y=Math.min(y,x.startOffset),N=Math.max(N,x.endOffset);I=t===s.Direction.LEFT?y:N}else{const y=a.findNodeByCharIndex(c-1,u,h),N=a.findNodeByCharIndex(c,u,h),x=a.findNodeByCharIndex(c+1,u,h);t===s.Direction.LEFT?I=Math.max(0,c-((R=y==null?void 0:y.count)!=null?R:1)):I=Math.min(f-2,l+N.count+((x==null?void 0:x.streamType)===s.DataStreamTreeTokenType.SECTION_BREAK?1:0))}const O=[s.DataStreamTreeTokenType.TABLE_START,s.DataStreamTreeTokenType.TABLE_END,s.DataStreamTreeTokenType.TABLE_ROW_START,s.DataStreamTreeTokenType.TABLE_ROW_END,s.DataStreamTreeTokenType.TABLE_CELL_START,s.DataStreamTreeTokenType.TABLE_CELL_END,s.DataStreamTreeTokenType.SECTION_BREAK];if(t===s.Direction.LEFT)for(;O.includes(p.dataStream[I]);)I--;else for(;O.includes(p.dataStream[I]);)I++;S.filter(y=>y.wholeEntity&&y.startIndex<I&&y.endIndex>=I).forEach(y=>{t===s.Direction.LEFT?I=Math.min(y.startIndex,I):I=Math.max(y.endIndex+1,I)}),this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,I),endOffset:Math.max(0,I),style:A}],!1),this._scrollToFocusNodePosition(o.getUnitId(),I)}else{const I=a.findNodeByCharIndex(c,u,h),O=a.findNodeByCharIndex(l,u,h),M=r.document.getOffsetConfig(),y=this._getTopOrBottomPosition(a,t===s.Direction.UP||d?I:O,t===s.Direction.UP||d?m:g,t===s.Direction.DOWN);if(y==null){let x;d?x=t===s.Direction.UP?0:f-2:x=t===s.Direction.UP?c:l,this._textSelectionManagerService.replaceTextRanges([{startOffset:Math.max(0,x),endOffset:Math.max(0,x),style:A}],!1);return}const N=new Ie(M,a).getRangePointData(y,y).cursorList[0];this._textSelectionManagerService.replaceTextRanges([{...N,style:A}],!1),this._scrollToFocusNodePosition(o.getUnitId(),N.endOffset)}}_getTopOrBottomPosition(t,e,n,o,a=!1){if(e==null||n==null)return;const r=this._getGlyphLeftOffsetInLine(e),c=this._getNextOrPrevLine(e,o,a);if(c==null)return;const l=this._matchPositionByLeftOffset(t,c,r,n);if(l!=null)return{...l,isBack:!0}}_getGlyphLeftOffsetInLine(t){const e=t.parent;if(e==null)return Number.NEGATIVE_INFINITY;const n=e.left,{left:o}=t;return n+o}_matchPositionByLeftOffset(t,e,n,o){const a={distance:Number.POSITIVE_INFINITY};for(const c of e.divides){const l=c.left;for(const A of c.glyphGroup){if(A.streamType===s.DataStreamTreeTokenType.SECTION_BREAK)continue;const{left:d}=A,u=l+d,m=Math.abs(n-u);m<a.distance&&(a.glyph=A,a.distance=m)}}if(a.glyph==null)return;const{segmentPage:r}=o;return t.findPositionByGlyph(a.glyph,r)}_getNextOrPrevLine(t,e,n=!1){var p,f,S,E,C,b,R,I,O,M,y,N;const o=t.parent,a=o==null?void 0:o.parent,r=a==null?void 0:a.parent,c=r==null?void 0:r.parent,l=c==null?void 0:c.parent;if(o==null||a==null||r==null||c==null||l==null)return;const A=r.lines.indexOf(a);if(A===-1)return;let d;if(l.type===_.DocumentSkeletonPageType.CELL&&n){const x=la(l,e);if(x)return x}if(e===!0){d=r.lines[A+1];const x=Ud(a,l);if(x){const w=Nd(x);w&&(d=w)}}else{d=r.lines[A-1];const x=wd(a,l);if(x){const w=Pd(x);w&&(d=w)}}if(d!=null)return d;const u=c.columns.indexOf(r);if(u===-1)return;if(e===!0)d=(p=c.columns[u+1])==null?void 0:p.lines[0];else{const x=(S=(f=c.columns)==null?void 0:f[u-1])==null?void 0:S.lines;d=x==null?void 0:x[x.length-1]}if(d!=null)return d;const m=l.sections.indexOf(c);if(m===-1)return;if(e===!0)d=(C=(E=l.sections[m-1])==null?void 0:E.columns[0])==null?void 0:C.lines[0];else{const x=(R=(b=l.sections)==null?void 0:b[m-1])==null?void 0:R.columns,w=x==null?void 0:x[x.length-1],H=w==null?void 0:w.lines;d=H==null?void 0:H[H.length-1]}if(d!=null)return d;if(l.type===_.DocumentSkeletonPageType.CELL)return la(l,e);const g=l.parent;if(g==null)return;const h=g.pages.indexOf(l);if(h!==-1){if(e===!0)d=(M=(O=(I=g.pages[h+1])==null?void 0:I.sections[0])==null?void 0:O.columns[0])==null?void 0:M.lines[0];else{const x=(y=g.pages[h-1])==null?void 0:y.sections;if(x==null)return;const w=(N=x[x.length-1])==null?void 0:N.columns,H=w[w.length-1],V=H==null?void 0:H.lines;d=V[V.length-1]}if(d!=null)return d}}_scrollToFocusNodePosition(t,e){var o;const n=(o=this._renderManagerService.getRenderById(t))==null?void 0:o.with(T.DocBackScrollRenderController);n!=null&&n.scrollToRange({startOffset:e,endOffset:e,collapsed:!0})}_getDocObject(){return Ao(this._univerInstanceService,this._renderManagerService)}};Cn=Hd([En(0,s.IUniverInstanceService),En(1,_.IRenderManagerService),En(2,s.Inject(D.DocSelectionManagerService)),En(3,s.ICommandService)],Cn);function la(i,t){var n,o;let e=null;if(t===!0){const a=ra(i);if(a)e=Ld(a);else{const r=(n=i.parent)==null?void 0:n.parent,{lineAfterTable:c}=sa(r);c&&(e=c)}}else{const a=ca(i);if(a)e=Qd(a);else{const r=(o=i.parent)==null?void 0:o.parent,{lineBeforeTable:c}=sa(r);c&&(e=c)}}return e}const kd=({handleRowColChange:i,tableCreateParams:t})=>{const e=v.useDependency(s.LocaleService),[n,o]=U.useState(3),[a,r]=U.useState(5);function c(l,A){o(l),r(A),i(l,A)}return U.useEffect(()=>{o(t.rowCount),r(t.colCount)},[t]),P.jsxs("div",{className:"univer-flex univer-items-center univer-justify-between",children:[P.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[P.jsx("span",{children:e.t("toolbar.table.rowCount")}),P.jsx(J.InputNumber,{className:"univer-w-28",min:1,max:20,precision:0,value:n,onChange:l=>{c(l,a)}})]}),P.jsxs("div",{className:"univer-flex univer-items-center univer-gap-2",children:[P.jsx("span",{children:e.t("toolbar.table.colCount")}),P.jsx(J.InputNumber,{className:"univer-w-28",min:1,max:20,precision:0,value:a,onChange:l=>{c(n,l)}})]})]})};var Vd=Object.getOwnPropertyDescriptor,Wd=(i,t,e,n)=>{for(var o=n>1?void 0:n?Vd(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},da=(i,t)=>(e,n)=>t(e,n,i);let Tn=class extends s.Disposable{constructor(i,t){super(),this._commandService=i,this._componentManager=t,this._initialize()}_initialize(){this._init(),this._registerCommands(),this._initCustomComponents()}_registerCommands(){[rn].forEach(i=>this.disposeWithMe(this._commandService.registerCommand(i)))}_initCustomComponents(){const i=this._componentManager;this.disposeWithMe(i.register(Us,kd))}_init(){}};Tn=Wd([da(0,s.ICommandService),da(1,s.Inject(v.ComponentManager))],Tn);var zd=Object.getOwnPropertyDescriptor,Gd=(i,t,e,n)=>{for(var o=n>1?void 0:n?zd(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},yn=(i,t)=>(e,n)=>t(e,n,i);let Yi=class extends s.Disposable{constructor(i,t,e,n,o){super(),this._context=i,this._docSkeletonManagerService=t,this._commandService=e,this._docEventManagerService=n,this._textSelectionManagerService=o,this._initPointerDownObserver(),this._initHoverCursor()}_initPointerDownObserver(){this._docEventManagerService.clickBullets$.subscribe(i=>{const t=this._textSelectionManagerService.getTextRanges();this._commandService.executeCommand(Ii.id,{index:i.paragraph.startIndex,segmentId:i.segmentId,textRanges:t})})}_initHoverCursor(){this.disposeWithMe(this._docEventManagerService.hoverBullet$.subscribe(i=>{i?this._context.mainComponent.setCursor(_.CURSOR_TYPE.POINTER):this._context.mainComponent.setCursor(_.CURSOR_TYPE.TEXT)}))}_getTransformCoordForDocumentOffset(i,t,e,n){const{documentTransform:o}=i.getOffsetConfig(),a=t.transformVector2SceneCoord(_.Vector2.FromArray([e,n]));if(a)return o.clone().invert().applyPoint(a)}};Yi=Gd([yn(1,s.Inject(D.DocSkeletonManagerService)),yn(2,s.ICommandService),yn(3,s.Inject(T.DocEventManagerService)),yn(4,s.Inject(D.DocSelectionManagerService))],Yi);var jd=Object.getOwnPropertyDescriptor,Xd=(i,t,e,n)=>{for(var o=n>1?void 0:n?jd(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Pt=(i,t)=>(e,n)=>t(e,n,i);let bn=class extends s.RxDisposable{constructor(i,t,e,n,o,a){super(),this._context=i,this._commandService=t,this._docClipboardService=e,this._docSelectionRenderService=n,this._contextService=o,this._editorService=a,this._init()}_init(){this._initLegacyPasteCommand()}_initLegacyPasteCommand(){var i;(i=this._docSelectionRenderService)==null||i.onPaste$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>{var c,l,A;if(!$t(this._contextService))return;t.event.preventDefault();const e=t.event;let n=(c=e.clipboardData)==null?void 0:c.getData(v.HTML_CLIPBOARD_MIME_TYPE);const o=(l=e.clipboardData)==null?void 0:l.getData(v.PLAIN_TEXT_CLIPBOARD_MIME_TYPE),a=[...((A=e.clipboardData)==null?void 0:A.items)||[]].filter(d=>v.imageMimeTypeSet.has(d.type)).map(d=>d.getAsFile()).filter(d=>!!d);this._editorService.getEditor(this._context.unitId)&&(n!=null?n:"").indexOf("</table>")>-1&&(n=""),this._docClipboardService.legacyPaste({html:n,text:o,files:a})})}};bn=Xd([Pt(1,s.ICommandService),Pt(2,xe),Pt(3,s.Inject(T.DocSelectionRenderService)),Pt(4,s.IContextService),Pt(5,ce)],bn);var Kd=Object.getOwnPropertyDescriptor,Yd=(i,t,e,n)=>{for(var o=n>1?void 0:n?Kd(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Aa=(i,t)=>(e,n)=>t(e,n,i);const qd=[s.DEFAULT_EMPTY_DOCUMENT_VALUE,s.DOCS_FORMULA_BAR_EDITOR_UNIT_ID_KEY,s.DOCS_NORMAL_EDITOR_UNIT_ID_KEY,s.DOCS_ZEN_EDITOR_UNIT_ID_KEY];let qi=class extends s.Disposable{constructor(i,t,e){super(),this._context=i,this._contextMenuService=t,this._commandService=e,qd.includes(this._context.unitId)||(this._initPointerDown(),this._initEditChange())}_initPointerDown(){var e,n;const t=((n=(e=this._context)==null?void 0:e.mainComponent)==null?void 0:n.onPointerDown$).subscribeEvent(o=>{o.button===2&&this._contextMenuService.triggerContextMenu(o,v.ContextMenuPosition.MAIN_AREA)});this.disposeWithMe(t)}_initEditChange(){this.disposeWithMe(this._commandService.onCommandExecuted(i=>{i.id===D.RichTextEditingMutation.id&&this._contextMenuService.visible&&this._contextMenuService.hideContextMenu()}))}};qi=Yd([Aa(1,v.IContextMenuService),Aa(2,s.ICommandService)],qi);var Jd=Object.getOwnPropertyDescriptor,Zd=(i,t,e,n)=>{for(var o=n>1?void 0:n?Jd(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},lt=(i,t)=>(e,n)=>t(e,n,i);let On=class extends s.Disposable{constructor(t,e,n,o,a,r,c){super();B(this,"_initialEditors",new Set);this._context=t,this._univerInstanceService=e,this._editorService=n,this._commandService=o,this._docSelectionRenderService=a,this._docSkeletonManagerService=r,this._renderManagerService=c,this._initialize()}_initialize(){this._editorService.getAllEditor().forEach(t=>{const e=t.getEditorId();e===this._context.unitId&&(this._initialEditors.has(e)||(this._initialEditors.add(e),this._resize(e)))}),this._commandExecutedListener(),this._initialBlur(),this._initialFocus()}_resize(t){if(t==null)return;const e=this._editorService.getEditor(t);if((e==null?void 0:e.cancelDefaultResizeListener)===!0)return;const n=this._univerInstanceService.getUniverDocInstance(t);if(!n)return;const o=this._docSkeletonManagerService.getSkeleton();if(e==null||e.render==null||o==null||n==null)return;o.calculate();const{marginTop:a=0,marginBottom:r=0,marginLeft:c=0,marginRight:l=0}=n.getSnapshot().documentStyle,{scene:A,mainComponent:d}=e.render;let{actualHeight:u,actualWidth:m}=o.getActualSize();u+=a+r,m+=c+l;const{width:g,height:h}=e.getBoundingClientRect(),p=Math.max(m,g),f=Math.max(u,h);A.transformByState({width:p,height:f}),d==null||d.resize(p,f)}_initialBlur(){this.disposeWithMe(this._editorService.blur$.subscribe(()=>{this._docSelectionRenderService.blur()})),this.disposeWithMe(this._docSelectionRenderService.onBlur$.subscribe(()=>{const{unitId:t}=this._context,e=this._editorService.getEditor(t),n=this._editorService.getFocusEditor();e==null||e.isSheetEditor()||n&&n.getEditorId()===t||t.includes("range_selector")||t.includes("embedding_formula_editor")||this._editorService.blur()}))}_initialFocus(){const t=["univer-formula-search","univer-formula-help","formula-help-decorator","univer-formula-help-param"];this.disposeWithMe(L.fromEvent(window,"mousedown").subscribe(n=>{const a=n.target.classList[0]||"";s.checkForSubstrings(a,t)&&n.stopPropagation()}));const e=new s.DisposableCollection;this.disposeWithMe(this._univerInstanceService.getCurrentTypeOfUnit$(s.UniverInstanceType.UNIVER_SHEET).subscribe(n=>{if(e.dispose(),!n)return;const o=n.getUnitId(),a=this._renderManagerService.getRenderById(o),r=a==null?void 0:a.engine.getCanvas().getCanvasEle();if(r==null)return;const c=L.fromEvent(r,"mousedown").subscribe(l=>{l.stopPropagation()});e.add(c)})),this.disposeWithMe(()=>e.dispose())}_commandExecutedListener(){const t=[D.RichTextEditingMutation.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{if(t.includes(e.id)){const n=e.params,{unitId:o}=n;if(this._editorService.isSheetEditor(o)||o!==this._context.unitId)return;const a=this._editorService.getEditor(o);a&&!a.params.scrollBar&&this._resize(o)}}))}};On=Zd([lt(1,s.IUniverInstanceService),lt(2,ce),lt(3,s.ICommandService),lt(4,s.Inject(T.DocSelectionRenderService)),lt(5,s.Inject(D.DocSkeletonManagerService)),lt(6,_.IRenderManagerService)],On);var $d=Object.getOwnPropertyDescriptor,eA=(i,t,e,n)=>{for(var o=n>1?void 0:n?$d(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Rn=(i,t)=>(e,n)=>t(e,n,i);let Ji=class extends s.Disposable{constructor(t,e,n,o,a){super();B(this,"_previousIMEContent","");B(this,"_isCompositionStart",!0);B(this,"_onStartSubscription");B(this,"_onUpdateSubscription");B(this,"_onEndSubscription");this._context=t,this._docSelectionRenderService=e,this._docImeInputManagerService=n,this._docSkeletonManagerService=o,this._commandService=a,this._initialize()}dispose(){var t,e,n;(t=this._onStartSubscription)==null||t.unsubscribe(),(e=this._onUpdateSubscription)==null||e.unsubscribe(),(n=this._onEndSubscription)==null||n.unsubscribe()}_initialize(){this._initialOnCompositionstart(),this._initialOnCompositionUpdate(),this._initialOnCompositionend()}_initialOnCompositionstart(){this._onStartSubscription=this._docSelectionRenderService.onCompositionstart$.subscribe(t=>{if(t==null)return;this._resetIME();const{activeRange:e}=t;e!=null&&this._docImeInputManagerService.setActiveRange(s.Tools.deepClone(e))})}_initialOnCompositionUpdate(){this._onUpdateSubscription=this._docSelectionRenderService.onCompositionupdate$.subscribe(t=>{this._updateContent(t,!0)})}_initialOnCompositionend(){this._onEndSubscription=this._docSelectionRenderService.onCompositionend$.subscribe(t=>{this._updateContent(t,!1)})}async _updateContent(t,e){if(t==null)return;const n=this._context.unitId,o=this._docSkeletonManagerService.getSkeleton(),{event:a,activeRange:r}=t;if(o==null||r==null)return;const l=a.data;l===this._previousIMEContent&&e||(await this._commandService.executeCommand(Gi.id,{unitId:n,newText:l,oldTextLen:this._previousIMEContent.length,isCompositionStart:this._isCompositionStart,isCompositionEnd:!e}),e?(this._isCompositionStart&&(this._isCompositionStart=!1),this._previousIMEContent=l):this._resetIME())}_resetIME(){this._previousIMEContent="",this._isCompositionStart=!0,this._docImeInputManagerService.clearUndoRedoMutationParamsCache(),this._docImeInputManagerService.setActiveRange(null)}};Ji=eA([Rn(1,s.Inject(T.DocSelectionRenderService)),Rn(2,s.Inject(_t)),Rn(3,s.Inject(D.DocSkeletonManagerService)),Rn(4,s.ICommandService)],Ji);var tA=Object.getOwnPropertyDescriptor,nA=(i,t,e,n)=>{for(var o=n>1?void 0:n?tA(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Mn=(i,t)=>(e,n)=>t(e,n,i);let Zi=class extends s.Disposable{constructor(t,e,n,o,a){super();B(this,"_onInputSubscription");this._context=t,this._docSelectionRenderService=e,this._docSkeletonManagerService=n,this._commandService=o,this._docMenuStyleService=a,this._init()}dispose(){var t;super.dispose(),(t=this._onInputSubscription)==null||t.unsubscribe()}_init(){this._initialNormalInput()}_initialNormalInput(){this._onInputSubscription=this._docSelectionRenderService.onInput$.subscribe(async t=>{var f,S;if(t==null)return;const{unitId:e}=this._context,{event:n,content:o="",activeRange:a}=t,r=n,c=this._docSkeletonManagerService.getSkeleton();if(r.data==null||c==null||a==null)return;const{segmentId:l}=a,d=this._context.unit.getSelfOrHeaderFooterModel(l).getBody(),u=this._docMenuStyleService.getDefaultStyle(),m=this._docMenuStyleService.getStyleCache(),g=_n((f=d==null?void 0:d.customRanges)!=null?f:[],a.endOffset,s.SHEET_EDITOR_UNITS.includes(e)),h=Qt(d,a.endOffset,u,m,s.SHEET_EDITOR_UNITS.includes(e)),p=Nn((S=d==null?void 0:d.customDecorations)!=null?S:[],a.endOffset);await this._commandService.executeCommand(si.id,{unitId:e,body:{dataStream:o,textRuns:h?[{...h,st:0,ed:o.length}]:[],customRanges:g?[{...g,startIndex:0,endIndex:o.length-1}]:[],customDecorations:p.map(E=>({...E,startIndex:0,endIndex:o.length-1}))},range:a,segmentId:l}),o===" "&&await this._commandService.executeCommand(Bt.id)})}};Zi=nA([Mn(1,s.Inject(T.DocSelectionRenderService)),Mn(2,s.Inject(D.DocSkeletonManagerService)),Mn(3,s.ICommandService),Mn(4,s.Inject(Te))],Zi);class $i extends s.Disposable{constructor(t){super(),this._context=t}calculatePagePosition(){var b,R;const t=ve(this._context),n=(R=(b=this._context.unit.getSettings())==null?void 0:b.zoomRatio)!=null?R:1,{document:o,scene:a,docBackground:r}=t,c=a==null?void 0:a.getParent(),{width:l,height:A,pageMarginLeft:d,pageMarginTop:u}=o;if(c==null||l===Number.POSITIVE_INFINITY||A===Number.POSITIVE_INFINITY)return;const{width:m,height:g}=c;let h=0,p=u,f=0,S=0,E=Number.POSITIVE_INFINITY;m>(l+d*2)*n?(h=m/2-l*n/2,h/=n,f=(m-d*2)/n,E=0):(h=d,f=l+d*2,E=(f-m/n)/2),g>A?S=(g-u*2)/n:S=A+u*2,a.resize(f,S),m<=1&&(h=-1e4,p=-1e4),o.translate(h,p),r.translate(h,p);const C=a.getViewport(ae.VIEW_MAIN);return E!==Number.POSITIVE_INFINITY&&C!=null&&C.scrollToViewportPos({viewportScrollX:E}),this}}var iA=Object.getOwnPropertyDescriptor,oA=(i,t,e,n)=>{for(var o=n>1?void 0:n?iA(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},ua=(i,t)=>(e,n)=>t(e,n,i);let eo=class extends s.Disposable{constructor(i,t,e){super(),this._context=i,this._docPageLayoutService=t,this._textSelectionManagerService=e;const n=this._context.unitId;if(s.isInternalEditorID(n)&&n!==s.DOCS_ZEN_EDITOR_UNIT_ID_KEY)return this;this._initResize()}_initResize(){this.disposeWithMe(s.fromEventSubject(this._context.engine.onTransformChange$).pipe(L.filter(i=>i.type===_.TRANSFORM_CHANGE_OBSERVABLE_TYPE.resize),L.throttleTime(0,L.animationFrameScheduler)).subscribe(()=>{this._docPageLayoutService.calculatePagePosition(),this._textSelectionManagerService.refreshSelection()}))}};eo=oA([ua(1,s.Inject($i)),ua(2,s.Inject(D.DocSelectionManagerService))],eo);var sA=Object.getOwnPropertyDescriptor,aA=(i,t,e,n)=>{for(var o=n>1?void 0:n?sA(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},dt=(i,t)=>(e,n)=>t(e,n,i);let to=class extends s.Disposable{constructor(t,e,n,o,a,r,c){super();B(this,"_loadedMap",new WeakSet);this._context=t,this._commandService=e,this._editorService=n,this._instanceSrv=o,this._docSelectionRenderService=a,this._docSkeletonManagerService=r,this._docSelectionManagerService=c,this._initialize()}_initialize(){this._init(),this._skeletonListener(),this._commandExecutedListener(),this._refreshListener(),this._syncSelection()}_init(){const{unitId:t}=this._context,e=ve(this._context);e==null||e.document==null||this._loadedMap.has(e.document)||(this._initialMain(t),this._loadedMap.add(e.document))}_refreshListener(){this.disposeWithMe(this._docSelectionManagerService.refreshSelection$.subscribe(t=>{if(t==null)return;const{unitId:e,docRanges:n,isEditing:o,options:a}=t;e===this._context.unitId&&(this._docSelectionRenderService.removeAllRanges(),this._docSelectionRenderService.addDocRanges(n,o,a))}))}_syncSelection(){this.disposeWithMe(this._docSelectionRenderService.textSelectionInner$.subscribe(t=>{t!=null&&this._docSelectionManagerService.__replaceTextRangesWithNoRefresh(t,{unitId:this._context.unitId,subUnitId:this._context.unitId})}))}_initialMain(t){const e=ve(this._context),{document:n,scene:o}=e;this.disposeWithMe(n.onPointerEnter$.subscribeEvent(()=>{this._isEditorReadOnly(t)||(n.cursor=_.CURSOR_TYPE.TEXT)})),this.disposeWithMe(n.onPointerLeave$.subscribeEvent(()=>{n.cursor=_.CURSOR_TYPE.DEFAULT,o.resetCursor()})),this.disposeWithMe(n.onPointerDown$.subscribeEvent((a,r)=>{if(this._isEditorReadOnly(t))return;const c=this._instanceSrv.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);(c==null?void 0:c.getUnitId())!==t&&this._instanceSrv.setCurrentUnitForType(t);const l=this._docSkeletonManagerService.getSkeleton(),{offsetX:A,offsetY:d}=a,u=this._getTransformCoordForDocumentOffset(A,d);if(u!=null){const{pageLayoutType:m=_.PageLayoutType.VERTICAL,pageMarginLeft:g,pageMarginTop:h}=n.getOffsetConfig(),{editArea:p}=l.findEditAreaByCoord(u,m,g,h),f=this._docSkeletonManagerService.getViewModel(),S=f.getEditArea();S!==_.DocumentEditArea.BODY&&p!==_.DocumentEditArea.BODY&&p!==S&&f.setEditArea(p)}if(this._docSelectionRenderService.__onPointDown(a),this._editorService.getEditor(t)){this._setEditorFocus(t);const{offsetX:m,offsetY:g}=a;setTimeout(()=>{t===this._editorService.getFocusId()||this._docSelectionRenderService.isOnPointerEvent||(this._setEditorFocus(t),this._docSelectionRenderService.setCursorManually(m,g))},0)}a.button!==2&&r.stopPropagation()})),this.disposeWithMe(n.onDblclick$.subscribeEvent(a=>{this._isEditorReadOnly(t)||this._docSelectionRenderService.__handleDblClick(a)})),this.disposeWithMe(n.onTripleClick$.subscribeEvent(a=>{this._isEditorReadOnly(t)||this._docSelectionRenderService.__handleTripleClick(a)}))}_getTransformCoordForDocumentOffset(t,e){const n=ve(this._context),{document:o,scene:a}=n,{documentTransform:r}=o.getOffsetConfig(),c=a.getViewports()[0];if(c==null)return;const l=c.transformVector2SceneCoord(_.Vector2.FromArray([t,e]));return r.clone().invert().applyPoint(l)}_isEditorReadOnly(t){const e=this._editorService.getEditor(t);return e?e.isReadOnly():!1}_setEditorFocus(t){this._editorService.focus(t)}_commandExecutedListener(){const t=[ge.id];this.disposeWithMe(this._commandService.onCommandExecuted(e=>{var n;if(t.includes(e.id)){const o=e.params,{unitId:a}=o,r=(n=this._docSelectionManagerService.__getCurrentSelection())==null?void 0:n.unitId;if(a!==r)return;this._docSelectionManagerService.refreshSelection()}}))}_skeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(t=>{if(!t)return;const{unitId:e}=this._context;if(!s.isInternalEditorID(e)){this._docSelectionRenderService.focus();const a=this._context.unit.getSnapshot(),r=Wo(a);this._docSelectionManagerService.replaceDocRanges([{startOffset:r,endOffset:r}],{unitId:e,subUnitId:e},!1)}}))}};to=aA([dt(1,s.ICommandService),dt(2,ce),dt(3,s.IUniverInstanceService),dt(4,s.Inject(T.DocSelectionRenderService)),dt(5,s.Inject(D.DocSkeletonManagerService)),dt(6,s.Inject(D.DocSelectionManagerService))],to);var rA=Object.getOwnPropertyDescriptor,cA=(i,t,e,n)=>{for(var o=n>1?void 0:n?rA(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Ke=(i,t)=>(e,n)=>t(e,n,i);let no=class extends s.Disposable{constructor(i,t,e,n,o,a,r,c){super(),this._context=i,this._contextService=t,this._docSkeletonManagerService=e,this._univerInstanceService=n,this._commandService=o,this._textSelectionManagerService=a,this._editorService=r,this._docPageLayoutService=c,this._initSkeletonListener(),this._initCommandExecutedListener(),this._initRenderRefresher(),setTimeout(()=>this.updateViewZoom(1,!0),20),s.isInternalEditorID(this._context.unitId)||this._initZoomEventListener()}_initRenderRefresher(){this._docSkeletonManagerService.currentSkeleton$.subscribe(i=>{if(i==null)return;const{unitId:t,scene:e}=this._context;this._editorService.isEditor(t)||this.disposeWithMe(e.onMouseWheel$.subscribeEvent(n=>{if(!n.ctrlKey||!this._contextService.getContextValue(s.FOCUSING_DOC))return;const o=this._univerInstanceService.getCurrentUniverDocInstance();if(!o)return;const{documentFlavor:a}=o.getSnapshot().documentStyle;if(a===s.DocumentFlavor.MODERN)return;const r=Math.abs(n.deltaX);let c=r<40?.2:r<80?.4:.2;c*=n.deltaY>0?-1:1,e.scaleX<1&&(c/=2);const l=o.zoomRatio;let A=+Number.parseFloat(`${l+c}`).toFixed(1);A=A>=4?4:A<=.1?.1:A,this._commandService.executeCommand(Nt.id,{zoomRatio:A,unitId:o.getUnitId()}),n.preventDefault()}))})}_initSkeletonListener(){this.disposeWithMe(this._docSkeletonManagerService.currentSkeleton$.subscribe(i=>{if(i==null)return;const t=this._univerInstanceService.getCurrentUniverDocInstance();if(!t)return;const e=t.zoomRatio||1;this.updateViewZoom(e,!1)}))}_initCommandExecutedListener(){const i=[ge.id];this.disposeWithMe(this._commandService.onCommandExecuted(t=>{if(i.includes(t.id)&&t.params.unitId===this._context.unitId){const n=this._context.unit.zoomRatio||1;this.updateViewZoom(n)}})),this.disposeWithMe(this._commandService.beforeCommandExecuted(t=>{t.id===Rt.id&&this._commandService.executeCommand(Nt.id,{zoomRatio:1,unitId:this._context.unitId})}))}updateViewZoom(i,t=!0){var n;const e=ve(this._context);e.scene.scale(i,i),this._editorService.isEditor(this._context.unitId)||this._docPageLayoutService.calculatePagePosition(),t&&!this._editorService.isEditor(this._context.unitId)&&this._textSelectionManagerService.refreshSelection(),(n=e.scene.getTransformer())==null||n.clearSelectedObjects()}_initZoomEventListener(){const i=this._context.scene;this.disposeWithMe(i.onMouseWheel$.subscribeEvent(t=>{if(!t.ctrlKey)return;const e=Math.abs(t.deltaX);let n=e<40?.2:e<80?.4:.2;n*=t.deltaY>0?-1:1,i.scaleX<1&&(n/=2);const o=this._context.unit.zoomRatio;let a=+Number.parseFloat(`${o+n}`).toFixed(1);a=a>=4?4:a<=.1?.1:a,this._commandService.executeCommand(Nt.id,{zoomRatio:Math.round(a*10)/10,documentId:this._context.unitId}),t.preventDefault()}))}};no=cA([Ke(1,s.IContextService),Ke(2,s.Inject(D.DocSkeletonManagerService)),Ke(3,s.IUniverInstanceService),Ke(4,s.ICommandService),Ke(5,s.Inject(D.DocSelectionManagerService)),Ke(6,ce),Ke(7,s.Inject($i))],no);const lA=s.createInterceptorKey("PRINTING_COMPONENT_COLLECT"),dA=s.createInterceptorKey("PRINTING_DOM_COLLECT");class ga extends s.Disposable{constructor(){super();B(this,"_printComponentMap",new Map);B(this,"interceptor",new s.InterceptorManager({PRINTING_COMPONENT_COLLECT:lA,PRINTING_DOM_COLLECT:dA}));this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_COMPONENT_COLLECT,{priority:-1,handler:e=>e})),this.disposeWithMe(this.interceptor.intercept(this.interceptor.getInterceptPoints().PRINTING_DOM_COLLECT,{priority:-1,handler:e=>e}))}registerPrintComponent(e,n){this._printComponentMap.set(e,n)}getPrintComponent(e){return this._printComponentMap.get(e)}}var AA=Object.getOwnPropertyDescriptor,uA=(i,t,e,n)=>{for(var o=n>1?void 0:n?AA(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},Ut=(i,t)=>(e,n)=>t(e,n,i);const ha=300;T.DocStateChangeManagerService=class extends s.RxDisposable{constructor(e,n,o,a,r){super();B(this,"_docStateChange$",new L.BehaviorSubject(null));B(this,"docStateChange$",this._docStateChange$.asObservable());B(this,"_historyStateCache",new Map);B(this,"_changeStateCache",new Map);B(this,"_historyTimer",null);B(this,"_changeStateCacheTimer",null);this._undoRedoService=e,this._commandService=n,this._univerInstanceService=o,this._docStateEmitService=a,this._renderManagerService=r,this._initialize(),this._listenDocStateChange()}getStateCache(e){var n,o;return{history:(n=this._historyStateCache.get(e))!=null?n:[],collaboration:(o=this._changeStateCache.get(e))!=null?o:[]}}setStateCache(e,n){this._historyStateCache.set(e,n.history),this._changeStateCache.set(e,n.collaboration)}_setChangeState(e){this._cacheChangeState(e,"history"),this._cacheChangeState(e,"collaboration")}_initialize(){this.disposeWithMe(this._commandService.beforeCommandExecuted(e=>{if(e.id===s.UndoCommandId||e.id===s.RedoCommandId){const n=this._univerInstanceService.getCurrentUniverDocInstance();if(n==null)return;const o=n.getUnitId();this._pushHistory(o),this._emitChangeState(o)}}))}_listenDocStateChange(){this._docStateEmitService.docStateChangeParams$.pipe(L.takeUntil(this.dispose$)).subscribe(e=>{var l;if(e==null)return;const{isCompositionEnd:n,isSync:o,syncer:a,...r}=e,c=(l=this._renderManagerService.getRenderById(o?a:e.unitId))==null?void 0:l.with(_t);if(c!=null){if(n){const A=c.fetchComposedUndoRedoMutationParams();if(A==null)throw new Error("historyParams is null in RichTextEditingMutation");const{undoMutationParams:d,redoMutationParams:u,previousActiveRange:m}=A;r.redoState.actions=u.actions,r.undoState.actions=d.actions,r.undoState.textRanges=[m]}this._setChangeState(r)}})}_cacheChangeState(e,n="history"){const{trigger:o,unitId:a,noHistory:r,debounce:c=!1}=e;if(r||o==null||n==="history"&&(o===s.RedoCommandId||o===s.UndoCommandId))return;const l=n==="history"?this._historyStateCache:this._changeStateCache,A=n==="history"?this._pushHistory.bind(this):this._emitChangeState.bind(this);if(l.has(a)){const d=l.get(a);d==null||d.push(e)}else l.set(a,[e]);c?n==="history"?(this._historyTimer&&clearTimeout(this._historyTimer),this._historyTimer=setTimeout(()=>{A(a)},ha)):(this._changeStateCacheTimer&&clearTimeout(this._changeStateCacheTimer),this._changeStateCacheTimer=setTimeout(()=>{A(a)},ha)):A(a)}_pushHistory(e){const n=this._undoRedoService,o=this._historyStateCache.get(e);if(!Array.isArray(o)||o.length===0)return;const a=o.length,r=o[0].commandId,c=o[0],l=o[a-1],A={unitId:e,actions:o.reduce((u,m)=>s.JSONX.compose(u,m.redoState.actions),null),textRanges:l.redoState.textRanges},d={unitId:e,actions:o.reverse().reduce((u,m)=>s.JSONX.compose(u,m.undoState.actions),null),textRanges:c.undoState.textRanges};n.pushUndoRedo({unitID:e,undoMutations:[{id:r,params:d}],redoMutations:[{id:r,params:A}]}),o.length=0}_emitChangeState(e){const n=this._changeStateCache.get(e);if(!Array.isArray(n)||n.length===0)return;const o=n.length,{commandId:a,trigger:r,segmentId:c,noHistory:l,debounce:A}=n[0],d=n[0],u=n[o-1],m={unitId:e,actions:n.reduce((p,f)=>s.JSONX.compose(p,f.redoState.actions),null),textRanges:u.redoState.textRanges},g={unitId:e,actions:n.reverse().reduce((p,f)=>s.JSONX.compose(p,f.undoState.actions),null),textRanges:d.undoState.textRanges},h={commandId:a,unitId:e,trigger:r,redoState:m,undoState:g,segmentId:c,noHistory:l,debounce:A};n.length=0,this._docStateChange$.next(h)}},T.DocStateChangeManagerService=uA([Ut(0,s.Inject(s.IUndoRedoService)),Ut(1,s.ICommandService),Ut(2,s.IUniverInstanceService),Ut(3,s.Inject(D.DocStateEmitService)),Ut(4,_.IRenderManagerService)],T.DocStateChangeManagerService);var gA=Object.getOwnPropertyDescriptor,hA=(i,t,e,n)=>{for(var o=n>1?void 0:n?gA(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},ma=(i,t)=>(e,n)=>t(e,n,i);const pa="univer-doc-main-canvas";T.DocsRenderService=class extends s.RxDisposable{constructor(t,e){super(),this._instanceSrv=t,this._renderManagerService=e,this._init()}_init(){this._renderManagerService.createRender$.pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._createRenderWithId(t)),this._instanceSrv.getAllUnitsForType(s.UniverInstanceType.UNIVER_DOC).forEach(t=>this._createRenderer(t)),this._instanceSrv.getTypeOfUnitAdded$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._createRenderer(t)),this._instanceSrv.getTypeOfUnitDisposed$(s.UniverInstanceType.UNIVER_DOC).pipe(L.takeUntil(this.dispose$)).subscribe(t=>this._disposeRenderer(t))}_createRenderer(t){var o;const e=t.getUnitId(),n=(o=this._instanceSrv.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC))==null?void 0:o.getUnitId();this._renderManagerService.created$.subscribe(a=>{a.unitId===n&&(a.engine.getCanvas().setId(pa),a.engine.getCanvas().getContext().setId(pa))}),this._renderManagerService.has(e)||this._createRenderWithId(e)}_createRenderWithId(t){this._renderManagerService.createRender(t)}_disposeRenderer(t){const e=t.getUnitId();this._renderManagerService.removeRender(e)}},T.DocsRenderService=hA([ma(0,s.IUniverInstanceService),ma(1,_.IRenderManagerService)],T.DocsRenderService);const mA={id:st.id,preconditions:dl,binding:v.KeyCode.ENTER},pA={id:pt.id,preconditions:ee,binding:v.KeyCode.BACKSPACE},fA={id:ri.id,preconditions:ee,binding:v.KeyCode.DELETE},SA={id:Ee.id,binding:v.KeyCode.ARROW_UP,preconditions:ee,staticParameters:{direction:s.Direction.UP}},vA={id:Ee.id,binding:v.KeyCode.ARROW_DOWN,preconditions:ee,staticParameters:{direction:s.Direction.DOWN}},IA={id:Ee.id,binding:v.KeyCode.ARROW_LEFT,preconditions:ee,staticParameters:{direction:s.Direction.LEFT}},EA={id:Ee.id,binding:v.KeyCode.ARROW_RIGHT,preconditions:ee,staticParameters:{direction:s.Direction.RIGHT}},CA={id:Ce.id,binding:v.KeyCode.ARROW_UP|v.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.UP}},TA={id:Ce.id,binding:v.KeyCode.ARROW_DOWN|v.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.DOWN}},yA={id:Ce.id,binding:v.KeyCode.ARROW_LEFT|v.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.LEFT}},bA={id:Ce.id,binding:v.KeyCode.ARROW_RIGHT|v.MetaKeys.SHIFT,preconditions:ee,staticParameters:{direction:s.Direction.RIGHT}},OA={id:zi.id,binding:v.KeyCode.A|v.MetaKeys.CTRL_COMMAND,preconditions:i=>i.getContextValue(s.FOCUSING_UNIVER_EDITOR)&&(i.getContextValue(s.FOCUSING_DOC)||i.getContextValue(s.EDITOR_ACTIVATED))};var RA=Object.defineProperty,MA=Object.getOwnPropertyDescriptor,xA=(i,t,e)=>t in i?RA(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,DA=(i,t,e,n)=>{for(var o=n>1?void 0:n?MA(t,e):t,a=i.length-1,r;a>=0;a--)(r=i[a])&&(o=r(o)||o);return o},wt=(i,t)=>(e,n)=>t(e,n,i),BA=(i,t,e)=>xA(i,t+"",e);T.UniverDocsUIPlugin=class extends s.Plugin{constructor(t=Ks,e,n,o,a,r){super(),this._config=t,this._injector=e,this._renderManagerSrv=n,this._commandService=o,this._logService=a,this._configService=r;const{menu:c,...l}=s.merge({},Ks,this._config);c&&this._configService.setConfig("menu",c,{merge:!0}),this._configService.setConfig(un,l),this._initDependencies(e),this._initializeShortcut(),this._initCommand()}onReady(){this._initRenderBasics(),this._markDocAsFocused(),s.touchDependencies(this._injector,[[T.DocStateChangeManagerService],[T.DocsRenderService]])}onRendered(){this._initUI(),this._initRenderModules(),s.touchDependencies(this._injector,[[In],[Cn],[rt],[Tn],[T.DocUIController]])}_initCommand(){[pt,ri,De,Be,_e,Ne,ye,Pe,he,We,Ue,tt,we,be,on,si,Ze,qt,ai,Jt,cs,ge,ot,it,nt,Tt,yt,bt,me,Ot,vt,_i,Fi,mn,pn,qs,fn,Sn,gn,hn,at,$n,ji,je,Bt,st,sn,It,Ct,Ii,Ei,Gi,Rt,pe,oi,Ve,mo,Pn,po,Nt,zi,ki,Ee,Ce,So,Un,ia,de,_s,ci,hi,mi,Ri,Mi,xi,Di,Bi,an,Ns,Ps,Ti,yi,bi,Si,ws,Ui].forEach(t=>{this.disposeWithMe(this._commandService.registerCommand(t))}),[St,en,tn].forEach(t=>this.disposeWithMe(this._commandService.registerMultipleCommand(t)))}_initializeShortcut(){[SA,vA,EA,IA,CA,TA,yA,bA,OA,pA,fA,mA,ul].forEach(t=>{this._injector.get(v.IShortcutService).registerShortcut(t)})}_initDependencies(t){s.mergeOverrideWithDependencies([[ga],[bn],[On],[T.DocUIController],[In],[Tn],[Cn],[vn],[rt],[ce,{useClass:T.EditorService}],[xe,{useClass:ui}],[T.DocCanvasPopManagerService],[T.DocsRenderService],[T.DocStateChangeManagerService],[T.DocAutoFormatService],[Te]],this._config.override).forEach(n=>t.add(n))}_markDocAsFocused(){const t=this._injector.get(s.IUniverInstanceService),e=this._injector.get(ce);try{const n=t.getCurrentUnitForType(s.UniverInstanceType.UNIVER_DOC);if(!n)return;const o=n.getUnitId();e.isEditor(o)||t.focusUnit(n.getUnitId())}catch(n){this._logService.warn(n)}}_initUI(){this._injector.get(vn)}_initRenderBasics(){[[D.DocSkeletonManagerService],[T.DocSelectionRenderService],[D.DocInterceptorService],[$i],[_t],[T.DocRenderController],[no]].forEach(t=>{this._renderManagerSrv.registerRenderModule(s.UniverInstanceType.UNIVER_DOC,t)})}_initRenderModules(){[[T.DocEventManagerService],[dn],[An],[T.DocBackScrollRenderController],[to],[Yn],[eo],[qi],[Yi],[bn],[Zi],[Ji],[On]].forEach(t=>{this._renderManagerSrv.registerRenderModule(s.UniverInstanceType.UNIVER_DOC,t)})}},BA(T.UniverDocsUIPlugin,"pluginName",ro),T.UniverDocsUIPlugin=DA([s.DependentOn(_.UniverRenderEnginePlugin),wt(1,s.Inject(s.Injector)),wt(2,_.IRenderManagerService),wt(3,s.ICommandService),wt(4,s.ILogService),wt(5,s.IConfigService)],T.UniverDocsUIPlugin),T.AfterSpaceCommand=Bt,T.AlignCenterCommand=yt,T.AlignJustifyCommand=Ot,T.AlignLeftCommand=Tt,T.AlignOperationCommand=me,T.AlignRightCommand=bt,T.BreakLineCommand=on,T.BulletListCommand=it,T.ChangeListNestingLevelCommand=sn,T.ChangeListNestingLevelType=Et,T.ChangeListTypeCommand=It,T.CheckListCommand=Ct,T.CoverContentCommand=po,T.CreateDocTableCommand=_i,T.CutContentCommand=Ve,T.DOCS_COMPONENT_BACKGROUND_LAYER_INDEX=co,T.DOCS_COMPONENT_DEFAULT_Z_INDEX=Bn,T.DOCS_COMPONENT_HEADER_LAYER_INDEX=lo,T.DOCS_COMPONENT_MAIN_LAYER_INDEX=Lt,T.DOCS_VIEW_KEY=Ae,T.DOC_UI_PLUGIN_NAME=ro,T.DOC_VERTICAL_PADDING=wi,T.DefaultDocContainerConfig=ao,T.DefaultToolbarConfig=so,T.DeleteCommand=Ze,T.DeleteCustomBlockCommand=qt,T.DeleteLeftCommand=pt,T.DeleteRightCommand=ri,T.DocCopyCommand=St,T.DocCreateTableOperation=rn,T.DocCutCommand=en,T.DocIMEInputManagerService=_t,T.DocPasteCommand=tn,T.DocPrintInterceptorService=ga,T.DocSelectAllCommand=zi,T.DocTableDeleteColumnsCommand=hn,T.DocTableDeleteRowsCommand=gn,T.DocTableDeleteTableCommand=at,T.DocTableInsertColumnCommand=qs,T.DocTableInsertColumnLeftCommand=fn,T.DocTableInsertColumnRightCommand=Sn,T.DocTableInsertRowAboveCommand=mn,T.DocTableInsertRowBellowCommand=pn,T.DocTableInsertRowCommand=Fi,T.DocTableTabCommand=ji,T.DocsUIMenuSchema=ta,T.Editor=bo,T.EditorInsertTextCommandId=rs,T.EnterCommand=st,T.HorizontalLineCommand=vt,T.IDocClipboardService=xe,T.IEditorService=ce,T.IMEInputCommand=Gi,T.InnerPasteCommand=oi,T.InsertCommand=si,T.InsertCustomRangeCommand=ia,T.ListOperationCommand=nt,T.MergeTwoParagraphCommand=Jt,T.MoveCursorOperation=Ee,T.MoveSelectionOperation=Ce,T.NORMAL_TEXT_SELECTION_PLUGIN_NAME=Ea,T.NodePositionConvertToCursor=Ie,T.NodePositionConvertToRectRange=Vn,T.OrderListCommand=ot,T.PastePluginLark=us,T.PastePluginUniver=hs,T.PastePluginWord=ms,T.QuickListCommand=Ei,T.RectRange=zn,T.ReplaceContentCommand=mo,T.ReplaceSelectionCommand=Un,T.ReplaceSnapshotCommand=Pn,T.ReplaceTextRunsCommand=So,T.ResetInlineFormatTextBackgroundColorCommand=tt,T.RichTextEditor=Xa,T.SetDocZoomRatioCommand=Nt,T.SetDocZoomRatioOperation=ge,T.SetInlineFormatBoldCommand=De,T.SetInlineFormatCommand=be,T.SetInlineFormatFontFamilyCommand=We,T.SetInlineFormatFontSizeCommand=he,T.SetInlineFormatItalicCommand=Be,T.SetInlineFormatStrikethroughCommand=Ne,T.SetInlineFormatSubscriptCommand=ye,T.SetInlineFormatSuperscriptCommand=Pe,T.SetInlineFormatTextBackgroundColorCommand=we,T.SetInlineFormatTextColorCommand=Ue,T.SetInlineFormatUnderlineCommand=_e,T.SetParagraphNamedStyleCommand=de,T.SwitchDocModeCommand=Rt,T.TEXT_RANGE_LAYER_INDEX=Ht,T.TabCommand=je,T.TextRange=He,T.ToggleCheckListCommand=Ii,T.UpdateCommand=ai,T.VIEWPORT_KEY=ae,T.addCustomDecorationBySelectionFactory=Ta,T.addCustomDecorationFactory=uo,T.calcDocRangePositions=ln,T.convertBodyToHtml=fs,T.convertPositionsToRectRanges=Vt,T.deleteCustomDecorationFactory=ya,T.docDrawingPositionToTransform=Oa,T.genTableSource=ni,T.generateParagraphs=fi,T.getAnchorBounding=ut,T.getCanvasOffsetByEngine=To,T.getCommandSkeleton=re,T.getCursorWhenDelete=Zt,T.getCustomBlockIdsInSelections=ss,T.getCutActionsFromDocRanges=as,T.getDocObject=Ao,T.getDocObjectById=Ca,T.getEmptyTableCell=Xt,T.getEmptyTableRow=Kt,T.getLineBounding=kt,T.getOneTextSelectionRange=Qn,T.getRichTextEditPath=Z,T.getTableColumn=Yt,T.hasParagraphInTable=ba,T.isInSameTableCell=Hn,T.isValidRectRange=vo,T.neoGetDocObject=ve,T.transformToDocDrawingPosition=Ra,T.useKeyboardEvent=go,T.useResize=ho,T.whenDocAndEditorFocused=ee,Object.defineProperty(T,Symbol.toStringTag,{value:"Module"})});
